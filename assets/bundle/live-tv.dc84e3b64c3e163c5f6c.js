(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[362],{59811:(e,t,n)=>{"use strict";n.r(t),n.d(t,{LiveTV:()=>R,default:()=>N});var i=n(29943),l=n(25584),s=n(24970),a=n(1925),o=n(33759),r=n(78706);function*d(){let e=new Date;for(yield(0,s.gz)((0,a.P)({currentTime:e}));;){const t=(0,o.v8)(e,10),n=(0,r.a5)(t,new Date);n<=0?e=new Date:(e=yield(0,s.gw)(n,t),yield(0,s.gz)((0,a.P)({currentTime:e})))}}var u=n(15875),c=n(82189),g=n(64687),f=n(91757),y=n(53398),m=n(1194),v=n(7759),w=n(74975);function p(e){const t=(0,w.Z)(e),n=(0,v.Z)(e),i=2*(0,r.NN)(n,t);return i<0||i>240?240:i}const D=(0,g.gV)("/app/src/modules/liveTV/sagas/listItemsInView.ts");function*h({payload:{startIndex:e,stopIndex:t}}){const n=yield(0,s.Ys)((n=>(0,c.D)(n,{startIndex:e,stopIndex:t})));D.log("loading timelines of channels");let i=null;for(;;){const e=yield(0,s.Ys)(w.Z),t=(0,r.tA)(e,i||new Date);if(D.log(`will load timelines | start: ${e} | diff: ${t}`),null===i||t>=2){const t=yield(0,s.Ys)(p);D.log("requesting timelines",{channelIDs:n,duration:t,start:e}),yield(0,s.gz)(u.K.request({channelIDs:n,duration:t,start:e})),i=e}else D.log(`difference from ${e} and ${i} is ${t} and is less than 2 hour`);D.log("waiting view hour start update"),yield(0,s.qn)((0,f.getType)(m.a))}}function*T(){yield(0,s.Fm)((0,f.getType)(y.F),h)}var _=n(74457),L=n(15477),H=n(59828);function*I(){for(;;){yield(0,s.qn)((0,f.getType)(m.a));const e=yield(0,s.Ys)(v.Z),t=yield(0,s.Ys)(L.$),n=(0,H.C8)((0,o.mH)(t[t.length-1],30)),i=e&&n!==e;if(!e||i){const e=t[t.length-1];if(e){const t=(0,o.mH)(e,30);yield(0,s.gz)((0,_.T)({viewHourEnd:t}))}}}}var A=n(3842);const V=(0,g.gV)("/app/src/modules/liveTV/sagas/viewHours.ts");function*x(){let e=(0,A.G)(new Date,30);for(V.log("set initial view hour start as",e),yield(0,s.gz)((0,m.a)({viewHourStart:e}));;){const t=(0,o.mH)(e,30),n=(0,r.a5)(t,new Date);n<=0?(V.log("something is not right, diffToNextUpdate is <= 0"),e=(0,A.G)(new Date,30)):(V.log(`wait ${n}ms to next update`,{nextUpdate:t}),e=yield(0,s.gw)(n,t),V.log("update view hour start as",e),yield(0,s.gz)((0,m.a)({viewHourStart:e})))}}function*E(){yield(0,s.rM)(d),yield(0,s.rM)(T),yield(0,s.rM)(x),yield(0,s.rM)(I)}var $=n(67294),z=n(80965),M=n(1877);const R=()=>{(0,i.Z)([{id:"liveTV",reducerMap:{liveTV:l.p},sagas:[E]}]);const e=(0,$.useRef)(null),t=(0,$.useRef)(null),n=(0,$.useRef)(null),s=(0,$.useMemo)((()=>({categoryListRef:e,channelListRef:t,channelInnerListRef:n})),[e,t,n]);return $.createElement(z.t.Provider,{value:s},$.createElement(M.A,null))},N=(0,$.memo)(R)}}]);