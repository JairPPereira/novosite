/*! For license information please see 247.e331c6af6e8d427e971e.js.LICENSE.txt */
(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[247],{13894:(e,t,r)=>{"use strict";r.d(t,{Z:()=>a});var i=r(14665);function n(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function a(e,t,r){return(a=n()?Reflect.construct:function(e,t,r){var n=[null];n.push.apply(n,t);var a=new(Function.bind.apply(e,n));return r&&(0,i.Z)(a,r.prototype),a}).apply(null,arguments)}},94226:(e,t,r)=>{"use strict";r.d(t,{bV:()=>n,i8:()=>l});var i=(e,t,r)=>new Promise(((i,n)=>{var a=e=>{try{o(r.next(e))}catch(e){n(e)}},s=e=>{try{o(r.throw(e))}catch(e){n(e)}},o=e=>e.done?i(e.value):Promise.resolve(e.value).then(a,s);o((r=r.apply(e,t)).next())})),n="dashjs",a="forced-subtitle";function s(e){const{avia:t}=e,{MimeType:r,PlaybackAdapterBase:i}=t;return i.canPlay(e,[r.DASH,r.ISM])}function o(e,t){return i(this,null,(function*(){var r;const{avia:s,resource:o,system:l,textTrackSettings:d}=e,{DrmType:c,ErrorCode:u,ErrorMessage:h,Header:p,PlayerHookType:m,MimeType:g,PlaybackAdapterBase:A,TextTrackMode:y,Util:f,waitForEvent:v}=s;if(!l.global.dashjs)try{yield f.loadScript({url:(null==(r=t.dependencies)?void 0:r.dashjs)||"//cdnjs.cloudflare.com/ajax/libs/dashjs/4.5.0/dash.all.min.js"},e.playerOptions)}catch(e){throw new s.PlayerError(u.DASH_SDK_MISSING,"Could not load dash.js SDK",e)}if(f.getResourceMimeType(o)===g.ISM&&!l.global.dashjs.MssHandler)try{yield f.loadScript({url:"//cdnjs.cloudflare.com/ajax/libs/dashjs/4.5.0/dash.mss.min.js"},e.playerOptions)}catch(e){throw new s.PlayerError(u.DASH_SDK_MISSING,"Could not load dash.js MSS script",e)}const T=l.global.dashjs,E=(e,t)=>JSON.stringify(e)===JSON.stringify(t);return new class extends A{constructor(e,t={}){super(e,t,!1),this.onStreamInitialized=e=>{const t=this.player.getBitrateInfoListFor("video");this.qualities=t.map((e=>({index:e.qualityIndex,bitrate:e.bitrate,width:e.width,height:e.height,codec:null,enabled:!1}))),this.updateQualities(this.qualities);const r=this.player.getQualityFor("video");this.quality=this.qualities.find((e=>e.index===r))},this.onTextTracksAdded=e=>{var t;const{tracks:r}=e,i=r.filter((e=>!e.roles.includes(a))).map((e=>{var t;return{id:(null==(t=e.id)?void 0:t.toString())||e.index.toString(),kind:e.kind,language:e.lang,label:e.label||e.lang,default:e.defaultTrack}}));this.textTracks=i,this.delegate.textTracksChange(i),this.listenToTextTracks(!0),this.setTextTrack(f.findDefaultTrack(i,(null==(t=this.textTrack)?void 0:t.language)||d.language)),Array.from(this.context.video.textTracks).forEach((e=>{if(!f.isTextTrack(e.kind))return;const t=parseInt(e.label),i=r.find((e=>e.id===t));(null==i?void 0:i.roles.includes(a))&&(e.forced=!0)}))},this.onPeriodSwitchCompleted=()=>{this.enableText()},this.onQualityChangeRendered=e=>{if("audio"===e.mediaType){const e=this.toAudioTrackInterfaceArray(this.player.getTracksFor("audio")),t=this.toAudioTrackInterfaceArray([this.player.getCurrentTrackFor("audio")])[0];if(!e||e.length<=1)return;E(e,this.audioTracks)||(this.audioTracks=e,this.delegate.audioTracksChange(e)),E(t,this.audioTrack)||(this.audioTrack=t,this.delegate.audioTrackChange(t))}else"video"===e.mediaType&&this.delegate.qualityChange(this.qualities[e.newQuality])},this.onKeySystemAccessComplete=e=>{e.data&&this.delegate.drmKeySystemCreated(e.data.mksa.keySystem)},this.onError=e=>{this.error(this.processError(e.error))},this.onMetricAdded=e=>{if("HttpList"!==e.metric)return;const t=f.getHeader(p.MULTI_CDN,e.value._responseHeaders);null!=t&&this.delegate.cdnChange(t.trim())},this.onEmsg=e=>{const t=e.event,r=t.calculatedPresentationTime;this.delegate.metadataCuepoint({id:e.type,info:t.eventStream.value,data:t.messageData,startTime:r,endTime:r+t.duration,source:t})};const{location:r}=o,i=this.player=T.MediaPlayer().create();this.logger.log(s.LogLevel.INFO,`dash.js version: ${this.player.getVersion()}`);const{events:n}=T.MediaPlayer;i.on(n.STREAM_INITIALIZED,this.onStreamInitialized),i.on(n.TEXT_TRACKS_ADDED,this.onTextTracksAdded),i.on(n.QUALITY_CHANGE_RENDERED,this.onQualityChangeRendered),i.on(n.PERIOD_SWITCH_COMPLETED,this.onPeriodSwitchCompleted),i.on(n.METRIC_ADDED,this.onMetricAdded),i.on(T.Protection.events.KEY_SYSTEM_ACCESS_COMPLETE,this.onKeySystemAccessComplete);const{drm:l}=r;i.setProtectionData(this.getProtectionData(l)),i.extend("RequestModifier",(()=>({modifyRequest:e=>{if(this.delegate.hasHook(m.REQUEST))return this.delegate.applyHook(m.REQUEST,e)}})),!0),i.initialize(e.video,null,!1),this.configurePlayer(e,t)}destroy(){return this.player.reset(),this.player=null,super.destroy()}getId(){return n}load(){return super.load().then((e=>i(this,null,(function*(){try{const{resource:t,playerOptions:r,textTrackSettings:i}=this.context,{mediaUrl:n,textTrackUrl:a}=t.location,{events:s}=T.MediaPlayer;this.player.setInitialMediaSettingsFor("audio",{lang:r.audioLanguage}),this.player.setInitialMediaSettingsFor("text",{lang:i.language});const o=t.playback.startTime;this.player.attachSource(n,f.isValidPlayheadTime(o)?o:0);const{data:l}=yield v(this.player,s.MANIFEST_LOADED,s.ERROR),d=this.gatherId3OwnerIds(l);null==d||d.forEach((e=>this.player.on(e,this.onEmsg))),yield v(this.player,s.PLAYBACK_METADATA_LOADED,s.ERROR),a&&(this.textTrackSurface=this.createTextTrackSurface());const c=this.player.getCurrentTrackFor("video");return this.player.on(s.ERROR,this.onError),this.suppressErrors=!1,e.fragment.mimeType=c?c.mimeType:"",e}catch(e){throw this.processError(e)}}))))}setAudioTrack(e){if(!e||this.context.avia.Util.isEmpty(e))return void this.logger.log(this.context.avia.LogLevel.INFO,"DashjsAdapter: Audio track is null, will not set.");const t=this.player.getTracksFor("audio").find((t=>String(t.id)===String(e.id)));this.player.setCurrentTrack(t)}setTextTrack(e){if(!e)return;this.textTrack=e,this.delegate.textTrackChange(e);const t=d.enabled?parseInt(e.id):-1;this.player.setTextTrack(t)}setTextTrackMode(e){this.enableText(),this.delegate.textTrackDisplayModeChange(e),super.setTextTrackMode(e)}setAutoQualitySwitching(e){this.player.updateSettings({streaming:{abr:{autoSwitchBitrate:{video:e,audio:e}}}})}setQuality(e){this.player.setQualityFor("video",e.index)}setMinBitrate(e){super.setMinBitrate(e),isNaN(e)&&(e=-1),this.player.updateSettings({streaming:{abr:{minBitrate:{video:e}}}}),this.updateQualities(this.qualities)}setMaxBitrate(e){super.setMaxBitrate(e),isNaN(e)&&(e=-1),this.player.updateSettings({streaming:{abr:{maxBitrate:{video:e}}}}),this.updateQualities(this.qualities)}updateQualities(e){const t=this.context.resource.playback.abr.capQualityToScreenSize;this.qualities.forEach((e=>{e.enabled=f.validateQuality(e,this.minBitrate,this.maxBitrate,t&&this.video)})),super.updateQualities(this.qualities)}getProtectionData(e){const t={},{playready:r,widevine:i}=e,{PLAYREADY:n,WIDEVINE:a}=c,s=(e,r)=>{f.isEmpty(e)||(t[r]={priority:null!=e.priority?e.priority:-1,serverURL:e.url,httpRequestHeaders:e.header,audioRobustness:e.audioRobustness,videoRobustness:e.videoRobustness})};return s(i,a),s(r,n),t}configurePlayer(e,t){var r;const{performanceSettings:i}=e,{playback:n}=o,{abr:a,adapter:s}=n,l={debug:{logLevel:t.debug?T.Debug.LOG_LEVEL_DEBUG:T.Debug.LOG_LEVEL_NONE},streaming:{lastMediaSettingsCachingInfo:{enabled:!1,ttl:0},abr:{limitBitrateByPortal:a.capQualityToScreenSize,initialBitrate:{video:a.startBitrate},minBitrate:{video:a.minBitrate},maxBitrate:{video:a.maxBitrate}},buffer:{bufferToKeep:i.backBufferLength,fastSwitchEnabled:!0},cmcd:{enabled:o.cmcd.enabled,sid:o.cmcd.sessionId,cid:o.cmcd.contentId},delay:{liveDelayFragmentCount:n.liveEdgeSyncFragmentCount},gaps:{jumpGaps:!0}}},{forwardBufferLength:d,topQualityForwardBufferLength:c}=i;Number.isFinite(d)&&(l.streaming.buffer.stableBufferTime=d),Number.isFinite(c)&&(l.streaming.buffer.bufferTimeAtTopQuality=c,l.streaming.buffer.bufferTimeAtTopQualityLongForm=c),this.player.updateSettings(f.merge(l,null==(r=null==s?void 0:s.options)?void 0:r.settings)),this.player.enableForcedTextStreaming(!0)}gatherId3OwnerIds(e){const t=o.playback.id3OwnerIds||[];return t.includes(s.WILDCARD)?e.Period_asArray.reduce(((e,t)=>{const r=t.AdaptationSet_asArray.reduce(((e,t)=>{const r=t.InbandEventStream_asArray;return(null==r?void 0:r.length)?e.concat(r.map((e=>e.schemeIdUri))):e}),e);return e.concat(r)}),[]):t}processError(e){const{code:t,message:r}=e;switch(t){case T.MediaPlayer.errors.DOWNLOAD_ERROR_ID_CONTENT_CODE:case T.MediaPlayer.errors.DOWNLOAD_ERROR_ID_INITIALIZATION_CODE:case T.MediaPlayer.errors.DOWNLOAD_ERROR_ID_MANIFEST_CODE:return this.createError(u.DASHJS_NETWORK_ERROR,`${h.FATAL_PLAYBACK_NETWORK_ERROR} : ${r}`,e);case T.MediaPlayer.errors.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE:return this.createError(u.DASHJS_PARSE_ERROR,`${h.FATAL_PLAYBACK_MEDIA_ERROR} : ${r}`,e);case T.MediaPlayer.errors.MEDIASOURCE_TYPE_UNSUPPORTED_CODE:return this.createError(u.DASHJS_SRC_NOT_SUPPORTED,`${h.FATAL_PLAYBACK_MEDIA_ERROR} : ${r}`,e);case T.MediaPlayer.errors.MEDIA_KEYERR_CODE:case T.MediaPlayer.errors.MEDIA_KEYERR_UNKNOWN_CODE:case T.MediaPlayer.errors.MEDIA_KEYERR_CLIENT_CODE:case T.MediaPlayer.errors.MEDIA_KEYERR_SERVICE_CODE:case T.MediaPlayer.errors.MEDIA_KEYERR_OUTPUT_CODE:case T.MediaPlayer.errors.MEDIA_KEYERR_HARDWARECHANGE_CODE:case T.MediaPlayer.errors.MEDIA_KEYERR_DOMAIN_CODE:case T.MediaPlayer.errors.CAPABILITY_MEDIAKEYS_ERROR_CODE:return this.createError(u.DASHJS_DRM_ERROR,`${h.FATAL_PLAYBACK_MEDIA_ERROR} : ${r}`,e);default:return this.createError(u.UNSPECIFIED_DASHJS_ERROR,r,e)}}enableText(){var e;const{player:t,textTrack:r}=this,i=null==(e=t.getCurrentTrackFor("audio"))?void 0:e.lang,n=t.getTracksFor("text").findIndex((e=>e.lang===i&&e.roles.includes(a))),s=d.enabled&&r?parseInt(r.id):n;t.setTextTrack(s),this.context.textTrackSettings.native||Array.from(this.context.video.textTracks).forEach((e=>{e.mode=e.mode===y.SHOWING?y.HIDDEN:y.DISABLED}))}toAudioTrackInterfaceArray(e){return e.map((e=>{const{index:t,type:r,id:i,lang:n,codec:a,roles:s,labels:o}=e;return{index:t,id:(null==i?void 0:i.toString())||t.toString(),type:(null==s?void 0:s[0])||r,language:n,codec:a,label:(null==o?void 0:o[0])||n}}))}}(e,t)}))}function l(e={}){return{id:n,factory:d,options:e}}function d(e,t){const{avia:r,player:i}=e;return i.registerAdapter({id:n,role:[r.AdapterRole.PLAYBACK],options:t,factory:o,isSupported:s}),{getId:()=>n,destroy(){}}}},6063:(e,t,r)=>{"use strict";r.d(t,{Rk:()=>s,$6:()=>h});var i=Object.getPrototypeOf,n=Reflect.get,a=(e,t,r)=>new Promise(((i,n)=>{var a=e=>{try{o(r.next(e))}catch(e){n(e)}},s=e=>{try{o(r.throw(e))}catch(e){n(e)}},o=e=>e.done?i(e.value):Promise.resolve(e.value).then(a,s);o((r=r.apply(e,t)).next())})),s="hlsjs",o="avia-load-error";function l(e){var t,r;const{avia:i,resource:n,system:a}=e,{Browser:s,MimeType:o,Os:l,PlaybackAdapterBase:d,Util:c}=i,u=a.browser===s.SAFARI,h=c.getResourceMimeType(n),p=[o.HLS,o.HLS_ALT],m=p.includes(h),g=!c.isEmpty(null==(r=null==(t=n.location.drm)?void 0:t.fairplay)?void 0:r.appCertUrl);if(m&&g&&u)return!1;const A=a.os===l.ANDROID,y=a.osVersionInfo;if(m&&!g&&A&&y.majorVersion<5)return!1;const f=a.os===l.IOS;return!(m&&f&&!u)&&d.canPlay(e,p)}function d(e,t){return a(this,null,(function*(){var r;const{avia:l,resource:d,system:c}=e,{AudioTrackType:u,ErrorCode:h,PlayerHookType:p,PlayerError:m,PlaybackAdapterBase:g,Util:A}=l;if(!c.global.Hls)try{yield A.loadScript({url:(null==(r=t.dependencies)?void 0:r.hlsjs)||"//cdnjs.cloudflare.com/ajax/libs/hls.js/1.2.3/hls.min.js"},e.playerOptions)}catch(e){throw new m(h.HLS_SDK_MISSING,"Could not load hls.js SDK",e)}const y=c.global.Hls,{Browser:f,ErrorMessage:v,Header:T,LogLevel:E,PerformanceMode:b,RequestCredentials:k,TextTrackMode:S,waitForEvent:P}=l;return new class extends g{constructor(e,t={}){super(e,t,!1),this.isLiveStream=!1,this.totalDuration=0,this.framerate=NaN,this.bandwidth=NaN,this.qualityInterval=NaN,this.withCredentials=!1,this.normalizeQuality=(e,t)=>({index:t,bitrate:e.bitrate,width:e.width,height:e.height,codec:e.attrs?e.attrs.CODECS:void 0,enabled:A.validateQuality(e,this.minBitrate,this.maxBitrate,this.player.capLevelToPlayerSize&&this.video)}),this.onLevelLoaded=(e,t)=>{const{details:r}=t;this.isLiveStream=r.live,this.segmentDuration=r.averagetargetduration,this.totalDuration=r.totalduration},this.onLevelSwitched=(e,t)=>{const{level:r}=t,i=Math.min(r,this.player.maxAutoLevel);this.quality=this.qualities.find((e=>e.index===i)),this.delegate.qualityChange(this.quality)},this.onFragLoaded=(e,t)=>{const r=t.frag.stats;this.bandwidth=r.bwEstimate},this.onSubtitleTracksUpdated=(e,t)=>{const r=t.subtitleTracks.map(((e,t)=>{var r;return{id:null==(r=e.id)?void 0:r.toString(),language:e.lang,kind:e.type.toLowerCase(),label:e.name||e.lang,default:e.default}}));this.textTracks=r,r.find((e=>e.default))||this.selectSubtitles(A.findDefaultTrack(r,this.context.textTrackSettings.language)),this.delegate.textTracksChange(this.textTracks)},this.onSubtitleTrackSwitch=(e,t)=>{const r=t.id.toString(),i=this.textTracks.find((e=>e.id===r));-1!==t.id&&i&&this.textTrack!==i&&this.selectSubtitles(i)},this.onAudioTracksUpdated=(e,t)=>{this.audioTracks=this.player.audioTracks.map(((e,t)=>{var r;return{index:t,id:null==(r=e.id)?void 0:r.toString(),type:"public.accessibility.describes-video"===e.attrs.CHARACTERISTICS?u.DESCRIPTION:u.MAIN,language:e.lang,codec:e.audioCodec,label:e.name||e.lang}})),this.audioTrack=this.audioTracks[this.player.audioTrack],this.delegate.audioTracksChange(this.audioTracks)},this.onAudioTrackSwitched=(e,t)=>{this.delegate.audioTrackChange(this.audioTracks[t.id])},this.onLoadError=(e,t)=>{const{fatal:r}=t;r?this.player.emit(o,o,t):this.error(this.processError(t))},this.onError=(e,t)=>{this.error(this.processError(t))},this.logger.log(E.INFO,`hls.js version: ${y.version}`);const{performanceSettings:r,textTrackSettings:i}=e,{playback:n}=d,a=y.DefaultConfig,s=c.browser===f.PLAYSTATION_4_MSE?1/0:r.backBufferLength,l=A.merge({debug:t.debug,autoStartLoad:!1,liveSyncDurationCount:n.liveEdgeSyncFragmentCount,maxBufferLength:r.forwardBufferLength||a.maxBufferLength,backBufferLength:s,maxMaxBufferLength:r.topQualityForwardBufferLength||a.maxMaxBufferLength,manifestLoadingMaxRetry:2,manifestLoadingRetryDelay:1e3,levelLoadingRetryDelay:500,fragLoadingRetryDelay:500,cmcd:d.cmcd.enabled?d.cmcd:null,loader:this.createLoader(this)},t.config);r.mode===b.LOW&&Object.assign(l,{maxBufferSize:2e7,liveSyncDurationCount:6,liveMaxLatencyDurationCount:12,stretchShortVideoTrack:!0,maxBufferHole:2.5,maxStarvationDelay:10,highBufferWatchdogPeriod:5,maxFragLookUpTolerance:2.5,nudgeOffset:.25,nudgeMaxRetry:5});const h=l.xhrSetup;l.xhrSetup=(e,t)=>{e.withCredentials=this.withCredentials,null==h||h(e,t)};const p=this.player=new y(l);p.capLevelToPlayerSize=n.abr.capQualityToScreenSize,p.subtitleDisplay=i.native;const{Events:m}=y;p.on(m.LEVEL_LOADED,this.onLevelLoaded),p.on(m.LEVEL_SWITCHED,this.onLevelSwitched),p.on(m.FRAG_LOADED,this.onFragLoaded),p.on(m.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated),p.on(m.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch),p.on(m.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated),p.on(m.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched)}getId(){return s}destroy(){c.global.clearInterval(this.qualityInterval);const e=P(this.player,y.Events.MEDIA_DETACHING);return this.player.destroy(),e.then((()=>(this.player=null,super.destroy())))}createLoader(e){const t=y.DefaultConfig.loader;return class r extends t{load(t,s,o){return a(this,null,(function*(){if(e.delegate.hasHook(p.REQUEST)){const{url:r,headers:i={}}=t,n=r.includes("akamaihd")&&r.includes("csmil")?k.INCLUDE:k.SAME_ORIGIN,a=e.context.resource.location.drm.aes;!A.isEmpty(a)&&r.includes(a.provider)&&a.header&&Object.assign(i,a.header);const s=yield e.delegate.applyHook(p.REQUEST,A.createRequest(r,i,n));Object.assign(t,s),e.withCredentials=s.credentials===k.INCLUDE}const l=o.onSuccess;var d;o.onSuccess=(t,r,i,n)=>a(this,null,(function*(){if(e.delegate.hasHook(p.RESPONSE)&&(t=yield e.delegate.applyHook(p.RESPONSE,t)),t.url.includes(".ts")){const t=A.getHeader(T.MULTI_CDN,n.getAllResponseHeaders());null!=t&&e.delegate.cdnChange(t)}l(t,r,i,n)})),(d=r.prototype,this,"load",n(i(d),"load",this)).call(this,t,s,o)}))}}}load(){return super.load().then((e=>a(this,null,(function*(){try{this.player.on(y.Events.ERROR,this.onLoadError),this.player.loadSource(d.location.mediaUrl);const t=yield P(this.player,y.Events.MANIFEST_LOADED,o);this.initQualityInfo(),this.initNativeTextTracks(t),this.player.attachMedia(this.video),yield P(this.player,y.Events.MEDIA_ATTACHED,o);const r=d.playback.startTime;this.player.startLoad(A.isValidPlayheadTime(r)?r:-1),this.setBitrateRestrictionAtStartup();const i=yield P(this.player,y.Events.FRAG_LOADING,o);return this.player.off(y.Events.ERROR,this.onLoadError),this.player.on(y.Events.ERROR,this.onError),this.suppressErrors=!1,e.fragment.mimeType=A.getMimeType(i.frag.url),e}catch(e){throw this.processError(e)}}))))}suspend(){this.player.stopLoad()}resume(){this.player.startLoad()}setTextTrack(e){e&&(this.textTrackSurface?super.setTextTrack(e):this.player.subtitleTrack=parseInt(e.id))}setTextTrackMode(e){this.textTrackSurface?super.setTextTrackMode(e):(this.enabledSubtitles(e),this.delegate.textTrackDisplayModeChange(e))}setMinBitrate(e){super.setMinBitrate(e),this.player.config.minAutoBitrate=e-1}setMaxBitrate(e){super.setMaxBitrate(e);const t=isNaN(e);this.player.capLevelToPlayerSize=!!t&&d.playback.abr.capQualityToScreenSize,this.player.autoLevelCapping=t?-1:A.getMaxBitrateIndex(this.player.levels,e)}setAutoQualitySwitching(e){this.player.loadLevel=e?-1:this.player.nextLoadLevel}setQuality(e){this.player.loadLevel=e.index}setAudioTrack(e){e?this.player.audioTrack=e.index:this.logger.log(E.INFO,"hls.js: Audio track is null, will not set.")}getIsLiveStream(){return this.isLiveStream}getMetrics(){return{droppedVideoFrames:NaN,framerate:this.framerate,bandwidth:this.bandwidth}}getSeekable(){const e=this.video.duration;return{start:e-this.totalDuration,end:e}}initQualityInfo(){this.qualityInterval=c.global.setInterval((()=>{const{minAutoLevel:e,maxAutoLevel:t}=this.player,r=this.qualities.filter((e=>e.enabled)),i=r[0],n=r[r.length-1];e===(null==i?void 0:i.index)&&t===(null==n?void 0:n.index)||this.updateQualityInfo()}),250),this.updateQualityInfo()}updateQualityInfo(){this.qualities=this.player.levels.map(this.normalizeQuality),this.updateQualities(this.qualities)}initNativeTextTracks(e){var t;const r=null==(t=e.subtitles)?void 0:t.length,{textTrackUrl:i}=this.context.resource.location;if(r)return i&&this.logger.warn("Detected subtitles in the manifest. Ignoring resource's textTrackUrl"),void(e.captions&&this.logger.warn("Detected subtitles in the manifest. Ignoring manifest captions"));this.textTrackSurface=this.createTextTrackSurface()}selectSubtitles(e){this.textTrack=e,this.delegate.textTrackChange(e),this.enabledSubtitles(this.context.textTrackSettings.mode)}enabledSubtitles(e){e!==S.DISABLED?(this.listenToTextTracks(!0),this.setTextTrack(this.textTrack)):(this.listenToTextTracks(!1),this.player.subtitleTrack=-1)}setBitrateRestrictionAtStartup(){const e=d.playback.abr;isNaN(e.minBitrate)||this.setMinBitrate(e.minBitrate-1),isNaN(e.maxBitrate)||this.setMaxBitrate(e.maxBitrate),isNaN(e.startBitrate)||(this.player.config.startLevel=A.getMaxBitrateIndex(this.player.levels,e.startBitrate))}processError(e){let t=h.UNSPECIFIED_HLSJS_ERROR;switch(e.type){case y.ErrorTypes.NETWORK_ERROR:return this.processNetworkErrors(e);case y.ErrorTypes.MEDIA_ERROR:return this.processMediaErrors(e);case y.ErrorTypes.MUX_ERROR:t=h.HLSJS_MUX_ERROR;default:const r=this.getErrorMessage(`${e.details}`,e.fatal);return this.createError(t,r,e,e.fatal)}}processNetworkErrors(e){const t=y.ErrorDetails,r=e.fatal?v.FATAL_PLAYBACK_NETWORK_ERROR:v.NONFATAL_PLAYBACK_NETWORK_ERROR;switch(e.details){case t.LEVEL_LOAD_ERROR:case t.FRAG_LOAD_ERROR:return this.createError(h.HLSJS_NETWORK_ERROR,r,e,e.fatal);case t.MANIFEST_PARSING_ERROR:return this.createError(h.HLSJS_PARSE_ERROR,`${r} : ${e.details}`,e,e.fatal);default:return this.createError(h.HLSJS_NETWORK_ERROR,`${r} : ${e.details}`,e,e.fatal)}}processMediaErrors(e){const t=y.ErrorDetails,r=e.fatal?v.FATAL_PLAYBACK_MEDIA_ERROR:v.NONFATAL_PLAYBACK_MEDIA_ERROR;switch(e.details){case t.MANIFEST_INCOMPATIBLE_CODECS_ERROR:return this.createError(h.HLSJS_SRC_NOT_SUPPORTED,`${r} : ${e.details}`,e,e.fatal);default:return this.createError(h.HLSJS_MEDIA_ERROR,`${r} : ${e.details}`,e,e.fatal)}}}(e,t)}))}function c(e,t){const{avia:r,player:i}=e;return i.registerAdapter({id:s,role:[r.AdapterRole.PLAYBACK],options:t,factory:d,isSupported:l}),{getId:()=>s,destroy(){}}}function u(e,t={}){const r=[c(e,(e=>{var r;const i=null==(r=t.adapter)?void 0:r[e],n=t.dependencies||{};return Object.assign({debug:t.debug},i,{dependencies:n})})(s))];return{getId:()=>"hls",destroy(){r.map((e=>{var t;return null==(t=e.destroy)?void 0:t.call(e)}))}}}function h(e={}){return{id:"hls",factory:u,options:e}}},35120:(e,t,r)=>{"use strict";r.d(t,{pt:()=>ir,in:()=>S,rg:()=>ar});var i,n,a=Object.create,s=Object.defineProperty,o=Object.defineProperties,l=Object.getOwnPropertyDescriptor,d=Object.getOwnPropertyDescriptors,c=Object.getOwnPropertyNames,u=Object.getOwnPropertySymbols,h=Object.getPrototypeOf,p=Object.prototype.hasOwnProperty,m=Object.prototype.propertyIsEnumerable,g=(e,t,r)=>t in e?s(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,A=(e,t)=>{for(var r in t||(t={}))p.call(t,r)&&g(e,r,t[r]);if(u)for(var r of u(t))m.call(t,r)&&g(e,r,t[r]);return e},y=(e,t)=>o(e,d(t)),f=(e,t)=>{for(var r in t)s(e,r,{get:t[r],enumerable:!0})},v=(e,t,r)=>(r=null!=e?a(h(e)):{},((e,t,r,i)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let r of c(t))p.call(e,r)||undefined===r||s(e,r,{get:()=>t[r],enumerable:!(i=l(t,r))||i.enumerable});return e})(!t&&e&&e.__esModule?r:s(r,"default",{value:e,enumerable:!0}),e)),T=(e,t,r,i)=>{for(var n,a=i>1?void 0:i?l(t,r):t,o=e.length-1;o>=0;o--)(n=e[o])&&(a=(i?n(t,r,a):n(a))||a);return i&&a&&s(t,r,a),a},E=(e,t,r)=>new Promise(((i,n)=>{var a=e=>{try{o(r.next(e))}catch(e){n(e)}},s=e=>{try{o(r.throw(e))}catch(e){n(e)}},o=e=>e.done?i(e.value):Promise.resolve(e.value).then(a,s);o((r=r.apply(e,t)).next())})),b=(i={"../node_modules/screenfull/dist/screenfull.js"(e,t){var r,i,n,a,s;r="undefined"!=typeof window&&void 0!==window.document?window.document:{},i=void 0!==t&&t.exports,n=function(){for(var e,t=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],i=0,n=t.length,a={};i<n;i++)if((e=t[i])&&e[1]in r){for(i=0;i<e.length;i++)a[t[0][i]]=e[i];return a}return!1}(),a={change:n.fullscreenchange,error:n.fullscreenerror},s={request:function(e,t){return new Promise(function(i,a){var s=function(){this.off("change",s),i()}.bind(this);this.on("change",s);var o=(e=e||r.documentElement)[n.requestFullscreen](t);o instanceof Promise&&o.then(s).catch(a)}.bind(this))},exit:function(){return new Promise(function(e,t){if(this.isFullscreen){var i=function(){this.off("change",i),e()}.bind(this);this.on("change",i);var a=r[n.exitFullscreen]();a instanceof Promise&&a.then(i).catch(t)}else e()}.bind(this))},toggle:function(e,t){return this.isFullscreen?this.exit():this.request(e,t)},onchange:function(e){this.on("change",e)},onerror:function(e){this.on("error",e)},on:function(e,t){var i=a[e];i&&r.addEventListener(i,t,!1)},off:function(e,t){var i=a[e];i&&r.removeEventListener(i,t,!1)},raw:n},n?(Object.defineProperties(s,{isFullscreen:{get:function(){return Boolean(r[n.fullscreenElement])}},element:{enumerable:!0,get:function(){return r[n.fullscreenElement]}},isEnabled:{enumerable:!0,get:function(){return Boolean(r[n.fullscreenEnabled])}}}),i?t.exports=s:window.screenfull=s):i?t.exports={isEnabled:!1}:window.screenfull={isEnabled:!1}}},function(){return n||(0,i[c(i)[0]])((n={exports:{}}).exports,n),n.exports}),k=(e=>(e.LOG_EVENT="logevent",e.TIME_EVENT="logtimeevent",e.TIME_END_EVENT="logtimeendevent",e))(k||{}),S=(e=>(e.OFF="off",e.ERROR="error",e.WARN="warn",e.INFO="info",e.DEBUG="debug",e))(S||{}),P={};f(P,{camelToDash:()=>D,formatTime:()=>j,getNumLines:()=>F,hmsToSec:()=>G,msToHms:()=>W,padStart:()=>K,secToHms:()=>q,template:()=>H,uid8:()=>V,uuid:()=>U,xmlToJson:()=>B,zeroFill:()=>z});var C={};function x(e){return null==e||Array.isArray(e)&&0===e.length||L(e)&&0===Object.keys(e).length||w(e)&&""===e}function M(e){return"function"==typeof e}function w(e){return"string"==typeof e}function R(e){return void 0===e}function I(e){return"number"==typeof e}function N(e){return"boolean"==typeof e}function L(e){return"object"==typeof e}f(C,{isBoolean:()=>N,isEmpty:()=>x,isFunction:()=>M,isNumber:()=>I,isObject:()=>L,isString:()=>w,isUndefined:()=>R});var _=/([a-z\d])([A-Z])/g,O=/\W+/g;function D(e){return e.replace(O,"-").replace(_,"$1-$2").toLowerCase()}function V(){const e=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)};return e()+e()}function U(){const e=URL.createObjectURL(new Blob),t=e.toString();return URL.revokeObjectURL(e),t.slice(t.lastIndexOf("/")+1)}function B(e){let t={};if(1===e.nodeType&&e.attributes.length>0)for(let r=0,i=e.attributes.length;r<i;r++){const i=e.attributes.item(r);t[i.nodeName]=i.nodeValue}else 3===e.nodeType&&(t=e.nodeValue);if("p"===e.nodeName&&(t.text="",e.childNodes.forEach((e=>{if("metadata"===e.nodeName)return;const r=(new XMLSerializer).serializeToString(e);1===e.nodeType&&(t.text+="br"===e.tagName?"\n":r),3===e.nodeType&&(t.text+=r)}))),e.hasChildNodes())for(let r=0,i=e.childNodes.length;r<i;r++){const i=e.childNodes.item(r),n=i.nodeName;if(R(t[n]))t[n]=B(i);else{if(R(t[n].push)){const e=t[n];t[n]=[],t[n].push(e)}t[n].push(B(i))}}return t}function F(e){return e&&(e.match(/\n/g)||[]).length+1}function H(e,t,r="{{",i="}}"){if(!e)return e;const n=new RegExp(`${r}((?:(?!(${r}|${i})).)+)${i}`,"g");return e.replace(n,((e,r)=>R(null==t?void 0:t[r])?e:t[r]))}function K(e,t,r=" "){t|=0;const i=e.length;return i>t?e:((t-=i)>r.length&&(r+=r.repeat(t/r.length)),r.slice(0,t)+e)}function q(e,t=61){if(null==e||isNaN(e))return"00:00";let r=z((e|=0)%60);return r=z((e=e/60|0)%60)+":"+r,(e=e/60|0)>0&&(r=z(e)+":"+r),t>=3600&&5===r.length&&(r="00:"+r),r}function W(e){return j(new Date(e),"HH:mm:ss:sss",{offset:0})}function z(e,t=2){return K(String(e),t,"0")}function G(e,t=30){if(!e)return NaN;const r=e.split(":");let i=0;if(4===r.length)i=parseInt(r.pop())/t;else if(3===r.length&&(r[2]=r[2].replace(",","."),-1!==r[2].indexOf("."))){const e=r[2].split(".");(null!=e?e.length:void 0)>1&&(r[2]=e[0],i=parseInt(e[1])/1e3)}let n=parseInt(r.pop());for(;r.length>0;)n+=Math.pow(60,r.length)*parseInt(r.shift());return n+i}function j(e,t="h:mm:ss A",r={timezone:"",offset:-(new Date).getTimezoneOffset()/60}){if(null!=r.offset&&0!==r.offset&&(e=new Date(e.getTime()+Math.round(60*r.offset*60*1e3))),isNaN(e.getTime()))return"";const i=e.getUTCHours(),n=e.getUTCMinutes(),a=e.getUTCSeconds(),s=e.getUTCMilliseconds(),o=i%12||12,l=i<12?"am":"pm",d={hh:z(o),h:o,HH:z(i),H:i,mm:z(n),m:n,sss:z(s,3),ss:z(a),s:a,a:l,A:l.toUpperCase(),z:r.timezone};for(const e in d)t=t.replace(e,d[e]);return t}var $=class{constructor(e,t,r){this.timeStamp=Date.now(),this.detail=r,this.target=t,this.type=e}},Y=class{constructor(e,t){this.target=t||this,this.opts=e||{},this.eventMap={};const r=this.opts;for(const e in r)if(M(r[e])&&/^on[A-Z]/.test(e)){const t=e.charAt(2).toLowerCase()+e.substring(3);this.on(t,r[e]),delete this.opts[e]}}destroy(){let e;if(this.opts){for(e in this.opts)delete this.opts[e];this.opts=null}if(this.offAll(null),this.eventMap){for(e in this.eventMap)delete this.eventMap[e];this.eventMap=null}}on(e,t){if(!this.eventMap||!e||!M(t))return;const r=this.eventMap[e]||(this.eventMap[e]=new class{constructor(){this.head=null,this.tail=null}get empty(){return null==this.head}forEach(e){let t=this.head;for(;t;)e(t.value),t=t.next}add(e){const t=new class{constructor(e,t){this.value=e,this.next=t}}(e);null==this.head?this.head=t:null==this.tail?this.head.next=this.tail=t:this.tail.next=this.tail=t}has(e){let t=this.head;for(;t;){if(t.value===e)return!0;t=t.next}return!1}delete(e){let t=null,r=this.head;for(;r;){if(r.value===e)return t&&(t.next=r.next),r===this.head?this.head=r.next:r===this.tail&&(this.tail=t),!0;t=r,r=r.next}return!1}clear(){let e,t=this.head;for(;t;)e=t.next,t.value=t.next=null,t=e;this.head=this.tail=null}});r.has(t)||r.add(t)}once(e,t){if(!this.eventMap||!e||!M(t))return;const r=i=>{this.off(e,r),t(i)};this.on(e,r)}off(e,t){!t&&this.offAll(e),t&&this.remove(e,t)}offAll(e){if(!this.eventMap)return;const t=this.eventMap;if(e)this.remove(e,null);else for(const e in t)this.remove(e,null)}hasListenerFor(e){return!(!this.eventMap||!this.eventMap[e]||this.eventMap[e].empty)}emit(e,t){const r=new $(e,this,t);this.dispatchEvt(r)}dispatchEvt(e){this.eventMap&&this.eventMap[e.type]&&this.eventMap[e.type].forEach((t=>t(e)))}remove(e,t=null){this.eventMap&&this.eventMap[e]&&(t?this.eventMap[e].delete(t):this.eventMap[e].clear())}},Q={off:0,error:100,warn:200,info:300,debug:400},X=class extends Y{constructor(e){super(e),this.useConsole=!1,this.pStartTime={},this.useConsole=L(console),this.id=e.id||V(),this.tzero=Date.now(),this.logLevel=x(this.opts.logLevel)?"off":this.opts.logLevel}static error(e){console&&console.error(e)}static warn(e){console&&console.warn(e)}static log(e){console&&console.log(e)}static deprecated(e){X.deprecatedCounts[e]>=X.maxDeprecatedWarnings||(X.warn(e),X.deprecatedCounts[e]=(X.deprecatedCounts[e]||0)+1)}get logLevel(){return this.pLogLevel}set logLevel(e){this.pLogLevel=e}assert(e,t){e||this.error(`Assertion failed! - "${t||""}"`)}log(e,...t){for(let r=0,i=t.length;r<i;r++)this.emit("logevent",this.assembleEvent(t[r],e));this.shouldLog(e)&&(t.unshift(this.getStamp()),console.log(...t))}dir(e,t,r){const i=r||"Unnamed Object";this.emit("logevent",this.assembleEvent(t,e,i)),this.shouldLog(e)&&(console.log(this.getStamp()+`Object: ${i}`),console.dir(t))}error(e){this.emit("logevent",this.assembleEvent(e,"error")),this.shouldLog("error")&&console.error(this.getStamp()+e)}warn(e){this.emit("logevent",this.assembleEvent(e,"warn")),this.shouldLog("warn")&&console.warn(this.getStamp()+e)}time(e,t=performance.now()){this.pStartTime[e]?this.warn(`Timer ${e} already exists`):(this.pStartTime[e]=t,this.emit("logtimeevent",this.assembleEvent({startTime:t},"info",e)))}timeEnd(e){if(!this.pStartTime[e])return void this.warn(`Timer ${e} does not exist`);const t=this.pStartTime[e];delete this.pStartTime[e];const r=performance.now()-t;this.emit("logtimeendevent",this.assembleEvent({startTime:t,duration:r},"info",e)),this.shouldLog("info")&&console.log(`${this.getStamp()} Timer: ${e} ${Math.round(r)}ms`)}assembleEvent(e,t,r=null){return{id:this.id,item:e,level:t,label:r}}shouldLog(e){return this.useConsole&&Q[this.pLogLevel]>=Q[e]}getStamp(){return`[${this.id+"]  "+W(Date.now()-this.tzero)} > `}},J=X;J.maxDeprecatedWarnings=1,J.deprecatedCounts={};var Z=(e=>(e.CREATE_PLAYER="createplayer",e.REMOVE_PLAYER="removeplayer",e))(Z||{}),ee=(e=>(e.PLAYER_CREATION="player-creation",e.RESOURCE_ATTACHMENT="resource-attachment",e.AD_ADAPTER_CREATION="ad-adapter-creation",e.AD_RESOURCE_CREATION="ad-resource-creation",e.PLAYBACK_ADAPTER_CREATION="playback-adapter-creation",e.RESOURCE_LOAD="resource-load",e.RESOURCE_PLAYBACK="resource-playback",e.FIRST_FRAME="first-frame",e))(ee||{}),te=class extends Error{constructor(e,t){super(e),this.cause=t}},re=(e=>(e.AD="Ad",e.RESOURCE="Resource",e.PLAYBACK="Playback",e.VIDEO_START="Video start",e.HOOK="Hook",e.API="API",e.EVENT="Event",e))(re||{}),ie=(e=>(e.INVALID_RESOURCE_FORMAT="1000",e.RESOURCE_UNAVAILABLE="1100",e.GEO_LOCATION_BLOCKED="1101",e.DOMAIN_BLOCKED="1102",e.IP_BLOCKED="1103",e.SATELLITE_PROVIDER_BLOCKED="1104",e.EXPIRED="1105",e.SELECTOR_CALL_ERROR="1106",e.IMA_SDK_MISSING="1200",e.DAI_SDK_MISSING="1201",e.DASH_SDK_MISSING="1202",e.HLS_SDK_MISSING="1203",e.SHAKA_SDK_MISSING="1204",e.TWITCH_SDK_MISSING="1205",e.FW_SDK_MISSING="1206",e.HLSJS_PARSE_ERROR="2101",e.DASHJS_PARSE_ERROR="2102",e.SHAKA_PARSE_ERROR="2103",e.TWITCH_PARSE_ERROR="2104",e.WEBMAF_START_ERROR="2105",e.USER_GESTURE_REQUIRED="2300",e.HTML5_NETWORK_ERROR="3001",e.HLSJS_NETWORK_ERROR="3002",e.DASHJS_NETWORK_ERROR="3003",e.WEBMAF_NETWORK_ERROR="3004",e.SHAKA_NETWORK_ERROR="3005",e.TWITCH_NETWORK_ERROR="3006",e.MEDIA_ABORTED="3100",e.HTML5_SRC_NOT_SUPPORTED="3101",e.HLSJS_SRC_NOT_SUPPORTED="3102",e.DASHJS_SRC_NOT_SUPPORTED="3103",e.SHAKA_SRC_NOT_SUPPORTED="3105",e.TWITCH_SRC_NOT_SUPPORTED="3106",e.HTML5_MEDIA_ERROR="3200",e.HLSJS_MEDIA_ERROR="3201",e.HLSJS_MUX_ERROR="3202",e.DASHJS_MEDIA_ERROR="3203",e.SHAKA_MEDIA_ERROR="3205",e.TWITCH_MEDIA_ERROR="3206",e.FAIRPLAY_APP_CERT_ERROR="3300",e.FAIRPLAY_LIC_ERROR="3301",e.DASHJS_DRM_ERROR="3302",e.SHAKA_DRM_ERROR="3304",e.UNSPECIFIED_VIDEO_PLAYBACK_ERROR="3400",e.UNSPECIFIED_HLSJS_ERROR="3401",e.UNSPECIFIED_DASHJS_ERROR="3402",e.UNSPECIFIED_SHAKA_ERROR="3404",e.UNSPECIFIED_TWITCH_ERROR="3405",e.AD_STALLED="4000",e.IMA_INIT_FAILURE="4100",e.IMA_AD_ERROR="4101",e.DAI_DATA_ERROR="4200",e.DAI_NETWORK_ERROR="4201",e.AD_BLOCKING_DETECTED="4300",e.AD_ADAPTER_ERROR="4400",e.ADAPTER_NOT_FOUND="5000",e.HOOK_ERROR="6000",e.EVENT_HOOK="6001",e.AD_BREAK_HOOK="6002",e.AD_HOOK="6003",e.ATTACH_RESOURCE_HOOK="6004",e.REQUEST_HOOK="6005",e.RESPONSE_HOOK="6006",e.CREATE_PLAYER_HOOK="6007",e.REMOVE_PLAYER_HOOK="6008",e.INVALID_ARGUMENT="9000",e.UNEXPECTED_CONDITION="9999",e))(ie||{}),ne=(e=>(e.EVENT="event",e.AD_BREAK="adbreak",e.AD="ad",e.ATTACH_RESOURCE="attachresource",e.REQUEST="request",e.RESPONSE="response",e))(ne||{}),ae=(e=>(e.ABR_UNAVAILABLE="Single bitrate stream detected, adaptive bitrate system is unavailable",e.ABR_MANUAL_SWITCHING_REACHED_LOWER_BOUNDS="You have reached the lowest available quality for this presentation.",e.ABR_MANUAL_SWITCHING_REACHED_UPPER_BOUNDS="You have reached the highest available quality for this presentation at this screen size",e.ABR_MIN_BITRATE_RESTRICTION_UNAVAILABLE="Min bitrate restrictions are not offered with this streaming library",e.AD_STALLED="Stalled ad detected",e.ADAPTER_UNAVAILABLE="Unable to play the requested resource - mediaUrl not recognized",e.ADAPTER_LIB_UNAVAILABLE="Unable to play the requested resource - External library is not loading",e.ADAPTER_NOT_FOUND="Unable to find an adapter for the requested resource",e.API_INVALID_ARG="API method called with missing or invalid param",e.CAP_LEVEL_MAXBITRATE="Max bitrate setting will be ignored since capQualityToPlayerSize is enabled",e.CONTENT_PLAYBACK_SETTING_IGNORED="This API is only available after the CONTENT_START event has been dispatched. This setting will be ignored.",e.DAI_MISSING_ASSET_URL="Unexpected condition = valid assetUrl not found in DAI stream data",e.DAI_SDK_UNAVAILABLE="A DAI SDK is required for playback, but is not found",e.ENVIRONMENT_NOT_SUPPORTED='Unable to locate a global "window" object or suitable alternative',e.FAIRPLAY_LICENSE_ERROR="Issue with fairplay DRM and the provided license acquisition url",e.FAIRPLAY_APP_CERT_ERROR="Issue creating a fairplay keysession with the provided application certificate",e.FAIRPLAY_NO_CONTENT_ID="A valid content or asset id was not detected when creating fairplay drm session",e.FAIRPLAY_WEBKIT_ERROR="Issue with webkit and keysession creations while using fairplay drm.",e.FATAL_PLAYBACK_MEDIA_ERROR="Fatal media error, no option for recovery",e.NONFATAL_PLAYBACK_MEDIA_ERROR="Nonfatal media error",e.FATAL_PLAYBACK_NETWORK_ERROR="Fatal network error, no option for recovery",e.NONFATAL_PLAYBACK_NETWORK_ERROR="Nonfatal network error",e.IMA_SDK_MISSING="IMA SDK not found.",e.INVALID_RESOURCE="Resource configuration appears to be invalid",e.MANUAL_ABR_SWITCHING_UNAVAILABLE="Native HTML5 Video does not allow manual bitrate switching",e.PAUSING_LINEAR_LIVE_STREAM_NOT_ALLOWED="StreamType.LIVE is detected. Redirecting to the stop method since a DVR window is not detected.",e.PLUGIN_LOAD_ERROR="Unable to load plugin from url",e.RESOURCE_MISSING="Resource missing",e.RESOURCE_NOT_SUPPORTED="Resource is not recognized or is currently unsupported",e.RETRY_PLAYBACK_MEDIA_ERROR="Media error detected",e.RETRY_PLAYBACK_NETWORK_ERROR="Network error detected",e.UNEXPECTED_CONDITION="An unexpected condition was encountered",e.UNSPECIFIED_ERROR="Unspecified error",e.VIDEO_PLAYBACK_UNAVAILABLE="Unable to locate a video element or suitable alternative",e.WEBKIT_KEY_ADDED_SUCCESS="Webkit key added successfully",e.WEBKIT_MEDIA_KEYS_NOT_SUPPORTED="WebKitMediaKeys are not supported for this type of media on this user agent",e))(ae||{}),se=class extends te{constructor(e,t,r,i=!0,n){super(t,r),this.code=e,this.fatal=i,this.category=n,this.name="PlayerError"}static eventToError(e,t="Event"){if(e instanceof Error||!e.detail&&!e.error)return e;const r=e.detail;if(r instanceof Error)return r;const i=e.error||r.error;return i instanceof Error?i:i.code&&i.message?new se(i.code,i.message,i.cause||e,!0,t):new se("9999","An unexpected condition was encountered",e,!0,t)}},oe=class extends se{constructor(e,t,r){super(oe.getErrorCode(e),t,r,!0,"Hook"),this.type=e,this.name="HookError"}static getErrorCode(e){switch(e){case"createplayer":return"6007";case"removeplayer":return"6008";case"ad":return"6003";case"adbreak":return"6002";case"attachresource":return"6004";case"event":return"6001";case"request":return"6005";case"response":return"6006";default:return"6000"}}},le=class{constructor(e){this.hookMap={},this.hookConfig=null,this.hookConfig=e}destroy(){this.hookMap=null,this.hookConfig=null}hasHook(e){const t=this.hookMap[e];return(null==t?void 0:t.length)>0}validateHookType(e){if(!(e in this.hookConfig))throw new te(`Invalid hook type: ${e}`)}registerHook(e,t){this.validateHookType(e),this.hookMap[e]||(this.hookMap[e]=[]),!1===this.hookConfig[e].multiple&&this.hookMap[e].length||this.hookMap[e].includes(t)||this.hookMap[e].push(t)}removeHook(e,t){this.validateHookType(e),this.hookMap[e]&&(this.hookMap[e]=this.hookMap[e].filter((e=>e!==t)))}applyHook(e,t){return E(this,null,(function*(){var r;const i=null==(r=this.hookMap)?void 0:r[e];if(!i||0===i.length)return t;let n=!1;const a=()=>n=!0,s=(t,r=0)=>E(this,null,(function*(){if(r>=i.length)return t;const o=i[r];if("function"!=typeof o)throw new oe(e,"Hook must be a valid function");const l={type:e,value:t,cancel:a};try{yield o(l)}catch(t){throw new oe(e,t.toString(),t)}return n?null:s(l.value,++r)}));return s(t)}))}applyHookSync(e,t){var r;const i=null==(r=this.hookMap)?void 0:r[e];if(!i||0===i.length)return t;let n=!1;const a=()=>n=!0,s=(t,r=0)=>{if(r>=i.length)return t;const o=i[r];if("function"!=typeof o)throw new oe(e,"Hook must be a valid function");const l={type:e,value:t,cancel:a};try{o(l)}catch(t){throw new oe(e,t.toString(),t)}return n?null:s(l.value,++r)};return s(t)}},de={event:{multiple:!0},adbreak:{multiple:!1},ad:{multiple:!1},attachresource:{multiple:!0},request:{multiple:!0},response:{multiple:!0}},ce={};f(ce,{AccessibilityAction:()=>Qt,ActiveState:()=>Xt,AdBreakType:()=>Zt,AdTechnology:()=>er,AdapterRole:()=>Jt,ApiMetric:()=>tr,AudioTrackType:()=>rr,Autoplay:()=>ir,AviaHookType:()=>Z,Browser:()=>_e,CoreEvent:()=>$,Device:()=>Oe,DrmType:()=>Dr,Emitter:()=>Y,ErrorCategory:()=>re,ErrorCode:()=>ie,ErrorMessage:()=>ae,FileExtensionToMimeType:()=>Qe,HTML5:()=>dr,Header:()=>nr,HookError:()=>oe,HookType:()=>lr,InvalidArgumentError:()=>kr,KeyboardScope:()=>cr,LocalizationId:()=>ur,LocalizedLanguage:()=>hr,LogLevel:()=>S,Logger:()=>J,LoggerEvent:()=>k,Measurement:()=>ee,Metric:()=>$t,MetricType:()=>pr,MimeType:()=>Ue,Os:()=>De,PerformanceMode:()=>mr,Platform:()=>Ve,PlaybackAdapterBase:()=>jt,PlaybackState:()=>gr,PlayerError:()=>se,PlayerEvent:()=>ar,PlayerHookType:()=>ne,PluginPriority:()=>Ar,QualityCategory:()=>Ne,QualityLabel:()=>yr,QualityMode:()=>fr,QueryString:()=>rt,RequestCredentials:()=>it,RequestMethod:()=>vr,ResponseType:()=>nt,StreamType:()=>Tr,TextTrackEvent:()=>he,TextTrackKind:()=>pe,TextTrackMode:()=>Ht,Timer:()=>Hr,UiMetric:()=>Er,Util:()=>Or,VideoFormat:()=>br,WILDCARD:()=>Kt,buildInfo:()=>Yt,cmcd:()=>Vr,eventsToPromise:()=>ve,queue:()=>fe,renderThumbnail:()=>Sr,request:()=>dt,waitFor:()=>me,waitForEvent:()=>Ae,waitForTime:()=>ye,waitUntil:()=>ge});var ue=class{constructor(){}};ue.blankVideoUrl="https://vidtech.cbsinteractive.com/h5/blanks/uvp_blank.mp4",ue.blankDataUrl="data:video/mp4;base64,AAAAHGZ0eXBpc29tAAACAGlzb21pc28ybXA0MQAAAAhmcmVlAAAC721kYXQhEAUgpBv/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA3pwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcCEQBSCkG//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADengAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAAAsJtb292AAAAbG12aGQAAAAAAAAAAAAAAAAAAAPoAAAALwABAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAB7HRyYWsAAABcdGtoZAAAAAMAAAAAAAAAAAAAAAIAAAAAAAAALwAAAAAAAAAAAAAAAQEAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAACRlZHRzAAAAHGVsc3QAAAAAAAAAAQAAAC8AAAAAAAEAAAAAAWRtZGlhAAAAIG1kaGQAAAAAAAAAAAAAAAAAAKxEAAAIAFXEAAAAAAAtaGRscgAAAAAAAAAAc291bgAAAAAAAAAAAAAAAFNvdW5kSGFuZGxlcgAAAAEPbWluZgAAABBzbWhkAAAAAAAAAAAAAAAkZGluZgAAABxkcmVmAAAAAAAAAAEAAAAMdXJsIAAAAAEAAADTc3RibAAAAGdzdHNkAAAAAAAAAAEAAABXbXA0YQAAAAAAAAABAAAAAAAAAAAAAgAQAAAAAKxEAAAAAAAzZXNkcwAAAAADgICAIgACAASAgIAUQBUAAAAAAfQAAAHz+QWAgIACEhAGgICAAQIAAAAYc3R0cwAAAAAAAAABAAAAAgAABAAAAAAcc3RzYwAAAAAAAAABAAAAAQAAAAIAAAABAAAAHHN0c3oAAAAAAAAAAAAAAAIAAAFzAAABdAAAABRzdGNvAAAAAAAAAAEAAAAsAAAAYnVkdGEAAABabWV0YQAAAAAAAAAhaGRscgAAAAAAAAAAbWRpcmFwcGwAAAAAAAAAAAAAAAAtaWxzdAAAACWpdG9vAAAAHWRhdGEAAAABAAAAAExhdmY1Ni40MC4xMDE=",ue.messages=ae;var he=(e=>(e.CUE_CHANGE="cuechange",e.ADD_TRACK="addtrack",e.CHANGE="change",e))(he||{}),pe=(e=>(e.CAPTIONS="captions",e.SUBTITLES="subtitles",e.DESCRIPTIONS="descriptions",e.CHAPTERS="chapters",e.METADATA="metadata",e.FORCED="forced",e))(pe||{});function me(e){return new Promise((t=>setTimeout(t,e)))}function ge(e,t=100){return new Promise(((r,i)=>{const n=setInterval((()=>{e()&&(clearInterval(n),r())}),t)}))}function Ae(e,t,r="error",i=NaN){return"number"==typeof r&&(i=r),new Promise(((n,a)=>{let s;const o=[],l=()=>o.forEach((e=>e())),d=(t,r)=>{const i=e.on?"on":"addEventListener",n=e.off?"off":"removeEventListener",a=(e,r)=>{clearTimeout(s),l(),t(r||e)};e[i](r,a),o.push((()=>e[n](r,a)))};d(n,t),"string"==typeof r&&d((e=>a(se.eventToError(e))),r),i>-1&&(s=setTimeout((()=>{l(),a(new Error("timeout"))}),i))}))}function ye(e,t,r){return r||(r=e instanceof HTMLVideoElement?"currentTime":"contentTime"),ge((()=>e[r]>=t))}function fe(e){let t,r=!1;return{run(i){return E(this,null,(function*(){let n=i;for(let i=0;i<e.length&&(t=e[i](n),n=yield t,!r);i++);return t=null,n}))},get running(){return null!=t},cancel(){return E(this,null,(function*(){return r=!0,yield t}))}}}function ve(e,t,r=NaN){return new Promise(((i,n)=>{let a;const s=[],o=()=>s.forEach((e=>e())),l=e=>({target:t,events:r})=>{const i=t,n=i.on?"on":"addEventListener",l=i.off?"off":"removeEventListener",d=(t,r)=>{clearTimeout(a),o(),e(r||t)};r.forEach((e=>{i[n](e,d),s.push((()=>i[l](e,d)))}))};e.forEach(l(i)),t.forEach(l(n)),r>-1&&(a=setTimeout((()=>{o(),n(new Error("timeout"))}),r))}))}var Te={};function Ee(e,t){return Math.round(e*Math.pow(10,t))/Math.pow(10,t)}function be(e,t,r){return Math.max(t,Math.min(r,e))}function ke(e,t,r){return I(e)&&e>=t&&e<=r}function Se(e,t,r,i=0,n=1){return(e-t)*(n-i)/(r-t)+i}f(Te,{clampValue:()=>be,inRange:()=>ke,mapToRange:()=>Se,roundTo:()=>Ee});var Pe={};function Ce(e){return Object.keys(e).reduce(((t,r,i)=>(t[i]=e[r],t)),[])}function xe(e){return Object.keys(e).reduce(((t,r,i)=>(t[i]=[r,e[r]],t)),[])}function Me(e){return e.reduce(((e,[t,r])=>(e[t]=r,e)),{})}function we(e,t=!1){const r=Array.isArray(e)?e.map((e=>we(e,t))):Object.assign({},e);return t?Object.freeze(r):r}function Re(e){return Array.isArray(e)&&e.forEach((e=>Re(e))),Object.freeze(e)}function Ie(...e){const t=(e,r)=>null==e?r:(null==r||Object.getOwnPropertyNames(r).forEach((i=>{const n=r[i],a=e[i],s=typeof n;"undefined"!==s&&(Array.isArray(n)?e[i]=n.slice():null==a&&"object"===s&&null!=n?e[i]=t({},n):null!=a&&L(a)?"object"===s&&(e[i]=t(a,n)):e[i]=n)})),e),[r,...i]=e;return i.reduce(((e,r)=>t(e,r)),r)}f(Pe,{clone:()=>we,entries:()=>xe,freeze:()=>Re,fromEntries:()=>Me,merge:()=>Ie,values:()=>Ce});var Ne=(e=>(e.SD="SD",e.HD="HD",e.UHD="UHD",e.UHD_4K="UHD 4K",e.UHD_8K="UHD 8K",e))(Ne||{}),Le=v(b(),1),_e=(e=>(e.ANDROID="Android",e.CHROME="Chrome",e.CHROME_IOS="Chrome-iOS",e.FIREFOX="Firefox",e.FIREFOX_IOS="Firefox-iOS",e.EDGE="Edge",e.MSIE="MSIE",e.SAFARI="Safari",e.OPERA="Opera",e.OPERA_MOBILE="Opera-Mobile",e.SILK="Silk",e.PLAYSTATION_4_WEBMAF="PlayStation 4 (WebMAF)",e.PLAYSTATION_4_MSE="PlayStation 4 (Media Source API)",e.PLAYSTATION_5="PlayStation 5 (Media Source API)",e.UNKNOWN="Unknown",e))(_e||{}),Oe=(e=>(e.DESKTOP="Desktop",e.ANDROID_PHONE="Android Phone",e.WINDOWS_PHONE="Windows Phone",e.IPHONE="iPhone",e.IPOD="iPod",e.IPAD="iPad",e.KINDLE="Kindle",e.TABLET="Tablet",e.MOBILE="Mobile",e.EMBEDDED="Embedded",e.LG_SMART_TV="LG Smart Tv",e.VIZIO_SMART_TV="Vizio Smart Tv",e.SAMSUNG_SMART_TV="Samsung Smart Tv",e.COMCAST_X1="Comcast X1",e.XBOX_ONE="Xbox One",e.CHROMECAST="Chromecast",e.PLAYSTATION_4="PlayStation 4",e.PLAYSTATION_5="PlayStation 5",e.SKY_Q="Sky Q",e.UNKNOWN="UNKNOWN",e))(Oe||{}),De=(e=>(e.OSX="OS X",e.WINDOWS="Windows",e.WINDOWS7="Windows 7",e.WINDOWS8="Windows 8",e.WINDOWS10="Windows 10",e.WINDOWS_VISTA="Windows Vista",e.WINDOWS_PHONE="Windows Phone",e.IOS="iOS",e.ANDROID="Android",e.CHROMIUM="Chromium",e.WEBOS="Web0S",e.SMARTCAST="SmartCast",e.TIZEN="Tizen",e.ORBIS="Orbis OS",e.PROSPERO="Prospero OS",e.UNKNOWN="Unknown",e))(De||{}),Ve=(e=>(e.MAC="Macintosh",e.WINDOWS="Windows",e.LINUX="Linux",e.UNKNOWN="Unknown",e))(Ve||{}),Ue=(e=>(e.MP4_VIDEO="video/mp4",e.MP4_AUDIO="audio/mp4",e.HLS="application/vnd.apple.mpegurl",e.HLS_ALT="application/x-mpegURL",e.DASH="application/dash+xml",e.WEBM_VIDEO="video/webm",e.WEBM_AUDIO="audio/webm",e.TS_VIDEO="video/mp2t",e.VTT="text/vtt",e.TTML="application/ttml+xml",e.ISM="application/vnd.ms-sstr+xml",e))(Ue||{}),Be={HLS:"application/vnd.apple.mpegurl",AVC:"video/mp4; codecs=avc1.4D401E,mp4a.40.2",HEVC:"video/mp4; codecs=hev1.1.2.L93.B0",WEBM_VP8:"video/webm; codecs=vp8, opus, vorbis",WEBM_VP9:"video/webm; codecs=vp9, opus, vorbis"},Fe=function(e){if(!e)return{global:e};const t=(e,t,r)=>{const i=e.test(t),n="Android"===r.os?"Android":"Safari";return i&&"Unknown"!==r.os?n:null},r=e=>{const t={majorVersion:null,minorVersion:null,versionString:e||null};if(e){const r=e.split("."),i=parseInt(r[0],10),n=parseInt(r[1],10);!isNaN(i)&&(t.majorVersion=i),!isNaN(n)&&(t.minorVersion=n)}return t},i=navigator.userAgent,n=(e=>{const t=e.toLowerCase(),r={os:"Unknown",platform:"Unknown",osVersion:"",device:"UNKNOWN"};if(t.indexOf("fxios")>=0)return r.os="iOS",r.platform="Macintosh",t.indexOf("iphone")>=0?r.device="iPhone":r.device="iPad",r;if(t.indexOf("crkey")>=0)return r.platform="Linux",r.device="Chromecast",r;const i=/\s(\([^)]+\))/.exec(e);if(i&&i.length&&i.length>1){const t=i[1].replace(/_/gi,"."),n=[(e,t)=>((e,t)=>{const r=new RegExp("Linux","i"),i=navigator.userAgentData,n=navigator.platform||(null==i?void 0:i.platform),a=/Linux armv/.test(n);if(r.test(e)||e.indexOf("Android")>=0){if(t.platform="Linux",t.device="UNKNOWN",e.indexOf("Chromium")>=0){const r=/Chromium\/([\d+\.]*)\s/.exec(e);t.os="Chromium",t.osVersion=r&&r[1]||""}else if(e.indexOf("Android")>=0){const r=/ Android ([^\s]+);/.exec(e);t.os="Android",t.osVersion=r&&r[1]||"",t.device="Android Phone"}else if(e.indexOf("Web0S")>=0)t.os="Web0S",t.osVersion="n/a",t.device="LG Smart Tv";else if(e.indexOf("SmartCast")>=0)t.os="SmartCast",t.osVersion="n/a",t.device="Vizio Smart Tv";else if(e.indexOf("Tizen")>=0){const r=/Tizen ([^\s]+)(;|\))/.exec(e);t.os="Tizen",t.osVersion=r&&r[1]||"",t.device="Samsung Smart Tv"}else"undefined"!=typeof $badger||/ Xfinity/.test(e)||/ WPE/.test(e)?(t.os="Linux",t.osVersion="n/a",t.device="Comcast X1"):e.indexOf("Sky")>=0?(t.os="Linux",t.osVersion="n/a",t.device="Sky Q"):a&&(t.os="Linux",t.osVersion="n/a",t.device="Embedded");return!0}return!1})(e,t),(e,t)=>((e,t)=>{if(e.indexOf("Macintosh")>=0){t.platform="Macintosh",navigator.userAgent.match(/(iPad)/)||navigator.maxTouchPoints>1?(t.device="iPad",t.os="iOS"):e.indexOf("OS X")>=0&&(t.device="Desktop",t.os="OS X");const r=/Mac OS X ([\d.]+)/.exec(e);return t.osVersion=r&&r[1]?r[1]:null,!0}if(-1!==e.indexOf("like Mac OS X")){t.platform="Macintosh",t.os="iOS",t.device="UNKNOWN";const r=/\sOS\s([^\s]*)\s/.exec(e);r&&r[1]&&(t.osVersion=r[1]);const i=[/\(iPhone;/,/\(iPad;/,/\(iPod;/],n=["iPhone","iPad","iPod"];let a=i.length;for(;a--;)if(i[a].test(e))return t.device=n[a],!0;return!0}return!1})(e,t),(e,t)=>((e,t)=>{let r=/Windows NT ([^\s]+)[;\)]/,i=/(Windows Phone |Windows Phone OS )([^\s]+);/.exec(e);if(i&&i[2])return t.platform="Windows",t.os="Windows Phone",t.osVersion=i[2],t.device="Windows Phone",!0;{const i=r.exec(e);if(t.device="Desktop",i&&i[1]){t.platform="Windows",t.os="Windows";const r=i[1];if(/Xbox; Xbox One/.test(e)&&(t.device="Xbox One"),10===parseInt(r))t.os="Windows 10",t.osVersion=r;else switch(r){case"6.0":t.os="Windows Vista";break;case"6.1":t.os="Windows 7",t.osVersion="7";break;case"6.2":t.os="Windows 8",t.osVersion="8"}return!0}}return!1})(e,t)];let a=n.length;for(;a--&&!(0,n[a])(0===a?e:t,r););}return r})(i),a=((e,r)=>{const i={Chrome:/Chrome\/(\S+)/,"Chrome-iOS":/CriOS\/(\S+)/,"Firefox-iOS":/FxiOS\/(\S+)/,Edge:/ Edge?\/([^\s]+)/,Firefox:/Firefox\/(\S+)/,Opera:/Opera|OPR\/(\S+)/,Safari:/Version\/(\S+).*Safari/,MSIE:/MSIE ([^\s]+)[);] Windows/,Android:/Android/,Silk:/Silk\/(\S+)/,"PlayStation 4 (WebMAF)":/Playstation 4 (WebMAF) (\S+)/,"PlayStation 4 (Media Source API)":/WebMAF\/v3/,"PlayStation 5 (Media Source API)":/PlayStation 5/,Unknown:null},n=i["Chrome-iOS"].test(e),a=(e,t,r)=>{const i=t&&t.exec(r),n={browser:e,browserVersion:"0",browserMajorVersion:0};if(i&&i.length&&i.length>1)if(n.browserVersion=i[1]||"",n.browserVersion.indexOf(".")){const e=n.browserVersion.split(".");if(Array.isArray(e)&&e.length){const t=parseInt(e[0]);!isNaN(t)&&(n.browserMajorVersion=t)}}else{const e=parseInt(n.browserVersion);!isNaN(e)&&(n.browserMajorVersion=e)}return n};if((i.Chrome.test(e)||n)&&!i.Opera.test(e)&&!i.Edge.test(e)){const t=n?"Chrome-iOS":"Chrome";return a(t,i[t],e)}const s=((e,t,r)=>{const i=/Trident.[^\s]+;.*rv:([^\s]+)[);]/;return t.test(r)?{browser:"MSIE",re:t}:e.test(r)?{browser:"Edge",re:e}:i.test(r)?{browser:"MSIE",re:i}:{browser:"Unknown",re:null}})(i.Edge,i.MSIE,e);if("Unknown"!==s.browser)return a(s.browser,s.re,e);for(const n in i)switch(n){case"Firefox":case"Firefox-iOS":case"Silk":case"Android":if(i[n].test(e))return"Silk"===n&&(r.device="Kindle"),a(n,i[n],e);break;case"PlayStation 4 (WebMAF)":case"PlayStation 4 (Media Source API)":case"PlayStation 5 (Media Source API)":const s=i["PlayStation 5 (Media Source API)"].test(e);let o;return o=s?"PlayStation 5 (Media Source API)":i["PlayStation 4 (Media Source API)"].test(e)?"PlayStation 4 (Media Source API)":"PlayStation 4 (WebMAF)",r.device=s?"PlayStation 5":"PlayStation 4",r.platform=s?"PlayStation 5":"PlayStation 4",r.os=s?"Prospero OS":"Orbis OS",a(o,i[o],e);case"Safari":if(t(i[n],e,r))return a(n,i[n],e);break;case"Opera":let l=i[n].exec(e);if(l)return a(l.indexOf("Opera Mini/")>=0||l.indexOf("Opera Mobi")>=0?"Opera-Mobile":"Opera",i[n],e)}return a("Unknown",i.Unknown,e)})(i,n),{os:s,platform:o,osVersion:l,device:d}=n,{browser:c,browserVersion:u}=a;let h=null,p=null;l&&w(l)&&(h=r(l)),u&&w(u)&&(p=r(u));const m=(()=>{switch(d){case"LG Smart Tv":case"Vizio Smart Tv":case"Samsung Smart Tv":case"Comcast X1":case"Sky Q":return!0;default:return!1}})(),g="Desktop"===d,A=(()=>{switch(d){case"PlayStation 4":case"PlayStation 5":case"Xbox One":return!0;default:return!1}})(),y=!!(null==e?void 0:e.WebKitMediaSource),f=!(!(null==e?void 0:e.MediaSource)&&!y),v=t=>{let r=!1;if(!e)return!1;if(y?r=e.WebKitMediaSource.isTypeSupported(t):f&&(r=e.MediaSource.isTypeSupported(t)),!r){const e=document.createElement("video");L(e)&&M(e.canPlayType)&&("probably"!==e.canPlayType(t)&&"maybe"!==e.canPlayType(t)||(r=!0))}return r},T=v(Be.WEBM_VP8),E=v(Be.WEBM_VP9),b=m||A;return{appNamespace:null,document:null==e?void 0:e.document,global:e,browser:c,browserVersionInfo:p,device:d,os:s,osVersionInfo:h,platform:o,isAndroid:"Android Phone"===d||"Android"===s,isChromecast:"Chromecast"===d,isDesktop:g,isEmbedded:"Embedded"===d,isIos:"iOS"===s,isMobile:!g,isTizen:"Samsung Smart Tv"===d,isTv:m,isConsole:A,isWebkit:y,isWebMaf:!!(null==e?void 0:e.WM_videoPlayer),isWebOs:"Web0S"===s,isXboxOne:"Xbox One"===d,hasFullscreenApi:Le.default.isEnabled,hasMediaSource:f,hasEncryptedMediaSource:!!e&&!!(e.MediaKeys||e.WebKitMediaKeys||e.MSMediaKeys),supportsVp8:T,supportsVp9:E,supportsWebM:T||E,supportsMediaDecodeConfigurations:!!(null==navigator?void 0:navigator.mediaCapabilities),supportsNativeHls:v(Be.HLS),supportsRequestMediaKeySystemAccess:!!(null==e?void 0:e.MediaKeySystemAccess),supportsUnrestrictedAutoplay:b}}("object"==typeof window?window:null),He=4320,Ke=2160,qe=1440,We=720;function ze(e,t){if(t<=e[0].bitrate)return 0;const r=e.length-1;for(let i=1;i<r;i++){const{bitrate:r}=e[i];if(t===r)return i;if(t<r)return i-1}return r}function Ge(e,t,r,i){let n=!0;if(null!=t&&n&&(n=e.bitrate>=t),null!=r&&n&&(n=e.bitrate<=r),i){const{clientWidth:t,clientHeight:r}=i;n&&(n=e.width<=t),n&&(n=e.height<=r)}return n}function je(e,t,r,i){return e.some((e=>e.enabled&&Ge(e,t,r,i)))}var $e={};f($e,{getResourceMetadata:()=>et,getResourceMimeType:()=>Ze});var Ye={};f(Ye,{getFileExtension:()=>Xe,getMimeType:()=>Je});var Qe={VTT:"text/vtt",XML:"application/ttml+xml",M3U8:"application/vnd.apple.mpegurl",MPD:"application/dash+xml",TS:"video/mp2t",MP4:"video/mp4",MPV:"video/mp4",MPA:"audio/mp4",WEBM:"video/webm",ISM:"application/vnd.ms-sstr+xml"};function Xe(e){return e.replace(/\?.*/,"").replace(/#.*/,"").split(".").pop()}function Je(e){if(!e)return"";const t=Xe(e).toUpperCase();return Qe[t]}function Ze(e){var t;return((null==(t=e.overrides)?void 0:t.mimeType)||"").split(";").shift()||Je(e.location.mediaUrl)}function et(e){return{manifest:{mimeType:Ze(e)},fragment:{mimeType:""}}}var tt={};f(tt,{clearAllCues:()=>wt,clearCue:()=>Mt,createSidecarTextTrack:()=>_t,dedupeCues:()=>It,findDefaultTrack:()=>Dt,findLanguageTracks:()=>Ot,isTextTrack:()=>Nt,normalizeCue:()=>Rt,smpteToVtt:()=>Lt});var rt=class{static encode(e){return x(e)?"":xe(e).map((([e,t])=>e+"="+encodeURIComponent(t))).join("&")}static decode(e){const t={};return null==e||e.replace(/^[^?]*\?/,"").replace(new RegExp("([^?=&]+)(=([^&]*))?","g"),((e,r,i,n)=>{let a;try{a=R(n)?n:decodeURIComponent(n)}catch(e){a=n}t[decodeURIComponent(r)]=a})),t}static parseValue(e){if(R(e))return!0;let t=e.toLowerCase();return"true"===t||"false"===t?"true"===t:"undefined"!==e?"null"===t?null:(t=parseFloat(e),isNaN(t)?e:t):void 0}static parse(e){const t=rt.decode(e);for(const e in t)t[e]=rt.parseValue(t[e]);return t}static append(e,t){const r=e.includes("?")?"&":"?";return e+r+rt.encode(t)}},it=(e=>(e.INCLUDE="include",e.SAME_ORIGIN="same-origin",e.OMIT="omit",e))(it||{}),nt=(e=>(e.ARRAY_BUFFER="arraybuffer",e.TEXT="text",e.JSON="json",e.DOCUMENT="document",e.DEFAULT="",e))(nt||{}),at=class{static get TIMEOUT(){return 5e3}},st=class extends Y{constructor(e){super(e),this.retryCount=0,this.limit=0,this.retryIntervals=null;const t=this.opts.errorRecovery;t&&!isNaN(t.retryAttempts)&&t.retryAttempts>0&&(this.limit=t.retryAttempts),t&&t.retryIntervals&&Array.isArray(t.retryIntervals)&&(this.retryIntervals=t.retryIntervals)}shouldRetry(){return this.limit&&!this.atLimit}incrementAttempts(){this.retryCount++}get retryLimit(){return this.limit}get atLimit(){return this.retryCount===this.limit}get retryInterval(){return this.retryIntervals&&this.retryIntervals[this.retryCount-1]||300*this.retryCount}},ot=class extends st{constructor(e){super(class{constructor(){}static create(e){return{url:e.url||"",method:e.method||"GET",timeout:e.timeout||at.TIMEOUT,headers:e.headers||{},data:this.getBody(e.data,e.encodeList,e.sendJson),withCredentials:!0===e.withCredentials,responseType:e.responseType||"text",onComplete:e.onComplete||null,errorRecovery:e.errorRecovery||null}}static getBody(e,t,r=!1){if(!e)return null;if("string"==typeof e)return e;if(!Object.keys(e).length)return null;(!Array.isArray(t)||!t.length)&&(t=[]);for(const r in e)e[r]=this.getValue(r,e[r],t);if(r)return JSON.stringify(e);let i,n="";for(const t in e)i=e[t],null!=i&&void 0!==i&&""!==i&&(n+=`${t}=${i}&`);return n=n.substr(0,n.length-1),n}static getValue(e,t,r){return r.indexOf(e)>=0?encodeURIComponent(t):t}}.create(e)),this.requestOptions=this.opts,this.opts.url&&this.createXhr()}static load(e){return new Promise(((t,r)=>{const i=e;i.credentials&&(i.withCredentials="include"===i.credentials),i.body&&(i.data=i.body),i.onComplete=({detail:e})=>{!e||e.error?r(e):t(e)},new ot(i)}))}createXhr(){this.request(this.requestOptions).then((e=>{const{response:t}=e,r=e.getResponseHeader("content-type");let i=t;if("text"===this.requestOptions.responseType&&r)if(r.includes("application/smil")||r.includes("application/xml")){const e=new DOMParser;i=e.parseFromString(i,"application/xml")}else(null==r?void 0:r.includes("application/json"))&&(i=JSON.parse(i));204!==e.status&&null==i?this.emitCompleteWithError("Unable to parse response."):setTimeout((()=>{this.emitComplete({contentType:r,data:i})}),1)})).catch((e=>{if(this.shouldRetry())this.incrementAttempts(),setTimeout((()=>{this.createXhr()}),this.retryInterval);else{const t=e.response||ot.statusMessages[0];this.emitCompleteWithError(t)}}))}request(e){return new Promise(((t,r)=>{e.query&&(e.url=rt.append(e.url,e.query));const i=new XMLHttpRequest;if(i.open(e.method,e.url),i.onload=()=>{!1!==e.checkStatus&&i.status>399&&r(i),t(i)},i.onerror=e=>{r(i)},i.withCredentials=e.withCredentials,null!=e.responseType)try{i.responseType=e.responseType}catch(e){}return null!=e.headers&&xe(e.headers).forEach((([e,t])=>{null!=e&&null!=t&&i.setRequestHeader(e,t)})),i.send(e.data)}))}emitComplete(e){this.emit(ot.event.COMPLETE,{response:e.data,contentType:e.contentType,error:!1})}emitCompleteWithError(e){const t=w(e)?e:null,r=t?null:e;this.emit(ot.event.COMPLETE,{status:r&&r.status,error:!0,url:this.requestOptions.url||"not available",message:t||this.getMsg((null==r?void 0:r.status)||0,(null==r?void 0:r.data)||null)})}getMsg(e,t){let r=ot.statusMessages[""+e];return r||(r=w(t)?t:"Unspecified error"),"XhrDataRequest error: "+r}},lt=ot;function dt(e){return e.query&&(e.url=rt.append(e.url,e.query)),lt.load(e).then((e=>e.response))}lt.event={COMPLETE:"complete"},lt.statusMessages={0:"Request failed; blocked or timed out",500:"Server error encountered.",404:"Resource not found.",403:"Access denied."};var ct={};function ut(e){const t=atob(e),r=t.length,i=new Uint8Array(new ArrayBuffer(r));for(let e=0;e<r;e++)i[e]=t.charCodeAt(e);return i}function ht(e){const t=String.fromCharCode.apply(null,e);return btoa(t)}function pt(e,t){if(e&&e.length&&M(t))for(let r=0,i=e.length;r<i;r++)t(e[r],r,e)}function mt(e,t){if(e&&e.length&&M(t))for(let r=e.length-1;r>-1;r--)t(e[r],r,e)}function gt(e){return String.fromCharCode.apply(null,new Uint8Array(e))}function At(e){const t=new Uint16Array(e.buffer);return String.fromCharCode.apply(null,t)}function yt(e){const t=new ArrayBuffer(2*e.length),r=new Uint16Array(t);for(let t=0,i=e.length;t<i;t++)r[t]=e.charCodeAt(t);return r}f(ct,{arrayToString:()=>At,base64DecodeUint8Array:()=>ut,base64EncodeUint8Array:()=>ht,bufferToString:()=>gt,forEach:()=>pt,forEachReverse:()=>mt,stringToArray:()=>yt});var ft=(e=>(e.MANIFEST="m",e.AUDIO="a",e.VIDEO="v",e.MUXED="av",e.INIT="i",e.CAPTION="c",e.TIMED_TEXT="tt",e.KEY="k",e.OTHER="o",e))(ft||{}),vt=e=>100*Math.round(e/100),Tt={br:vt,d:e=>Math.round(e),bl:vt,dl:vt,mtp:vt,nor:e=>encodeURIComponent(e),rtp:vt};function Et(e){return function(e,t){const r=[];return e?(Object.keys(e).sort().forEach((t=>{let i=e[t];if(!(e=>null!=e&&""!==e&&!1!==e)(i))return;if("v"===t&&1===i)return;if("pr"===t&&1===i)return;const n=Tt[t];n&&(i=n(i));const a=((e,t)=>{const r=typeof e;return"symbol"===r?`${t}=${e.description}`:"ot"===t||"sf"===t||"st"===t?`${t}=${e}`:"boolean"===r?t:"number"===r?`${t}=${e}`:`${t}=${JSON.stringify(e)}`})(i,t);r.push(a)})),r):r}(e).join(",")}function bt(e){return decodeURIComponent(e.replace(/^CMCD=/,"")).split(",").reduce(((e,t)=>{const[r,i]=t.split("=");return i?i.includes('"')?e[r]=JSON.parse(i):e[r]="ot"===r||"sf"===r||"st"===r?i:parseFloat(i):e[r]=!0,e}),{})}function kt(e){return e?`CMCD=${encodeURIComponent(Et(e))}`:""}function St(e,t){const r=kt(t);if(!r)return e;const i=e.includes("?")?"&":"?";return`${e}${i}${r}`}var Pt={};function Ct(e=""){const t=e.match(/^([a-zA-Z]{2,3})(?:[_-]+([a-zA-Z]{3})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{4})(?=$|[_-]+))?(?:[_-]+([a-zA-Z]{2}|[0-9]{3})(?=$|[_-]+))?/)||[];return{tag:e,language:t[1]||"",extended:t[2]||"",script:t[3]||"",region:t[4]||"",toString(){return this.tag}}}function xt(e,t){if(e===t)return!0;const r=this.parseLanguageTag(e),i=this.parseLanguageTag(t);if(r.language.slice(0,2).toLowerCase()===i.language.slice(0,2).toLowerCase()){const e=r.region.toUpperCase(),t=i.region.toUpperCase();return e===t||!!e&&!t||!e&&!!t}return!1}function Mt(e,t){try{const r=VTTCue||TextTrackCue;e.addCue(new r(t-.1,t+.1," "))}catch(e){}}function wt(e){const t=t=>{t&&Array.from(t).forEach((t=>{try{e.removeCue(t)}catch(e){}}))};t(e.cues),t(e.activeCues)}function Rt(e){var t;e.startTime||(null==(t=e.data)?void 0:t.startTime)&&(e.startTime=e.data.startTime,e.endTime=e.data.endTime);const{data:r}=e;return(null==r?void 0:r.buffer)&&(e.text="undefined"!=typeof TextDecoder?(new TextDecoder).decode(r):gt(r.buffer)),e}function It(e){const t={},r=[];return e.activeCues?(Array.from(e.activeCues).forEach((i=>{try{if(!i)return;const{text:n,startTime:a,endTime:s}=i;if(!n)return;const o=t[n];if(o){if(o.startTime===a&&o.endTime===s)return void e.removeCue(i)}else t[n]=i;r.push(i)}catch(e){}})),r):r}function Nt(e){return"captions"===e||"subtitles"===e}function Lt(e,t){return E(this,null,(function*(){const r=(yield dt({url:e,responseType:"document"})).querySelectorAll("tt body div p");if(!r.length)throw new Error(`No cues found in ${e}`);const i="Safari"===Fe.browser?"middle":"center",n="Safari"===Fe.browser?-1:0,a=void 0!==Fe.global.VTTCue,s=a?Fe.global.VTTCue:Fe.global.TextTrackCue;r.forEach(((e,r,o)=>{if(x(e.textContent))return;const l=e.textContent.replace(/(.*)<span.*tts:fontStyle="italic">(.*)<\/span>(.*)/g,"$1<i>$2</i>$3").replace(/(.*)<span.*tts:fontWeight="bold">(.*)<\/span>(.*)/g,"$1<b>$2</b>$3").replace(/(.*)<span.*tts:textDecoration="under">(.*)<\/span>(.*)/g,"$1<u>$2</u>$3"),d=F(l);e._lineCountPrev=e._lineCountPrev||0,e._lineCountNext=e._lineCountNext||0;let c=r+1,u=o[c];const h=e.getAttribute("begin");for(;(null==u?void 0:u.getAttribute("begin"))===h;)u._lineCountPrev=d+e._lineCountNext,e._lineCountNext+=F(u.textContent),u=o[++c];const p=new s(G(h),G(e.getAttribute("end")),l);if(p.align=e.getAttribute("tts:textAlign"),a){const t=e.querySelector("metadata");if(t){p.snapToLines=!0;const e=parseInt(t.getAttribute("cccol")),r=parseInt(t.getAttribute("ccrow")),a=Math.round(e/35*100);p.position=a;try{p.align=a<45?"start":a>55?"end":i}catch(e){p.align="center"}p.positionAlign=a<45?"line-left":a>55?"line-right":"center",p.line=r-17+n}}try{t.addCue(p)}catch(e){}}))}))}function _t(e,t,r="en",i="English"){var n;let a=null==(n=e.location)?void 0:n.textTrackUrl;if(!a)return Promise.reject("Invalid text track url");const s=a.indexOf(".vtt")>=0,{cmcd:o}=e;if(o.enabled&&(a=St(a,{ot:"c",su:!0,sid:o.sessionId,cid:o.contentId,pr:t.playbackRate,v:1})),s){const e=document.createElement("track");return e.kind="captions",e.label=i,e.srclang=r,e.id="sidecar-vtt",e.src=a,t.appendChild(e),Promise.resolve(e.track)}{const e=t.addTextTrack("captions",i,r);return Lt(a,e).then((()=>e))}}function Ot(e,t,r=!1){const i=e=>new RegExp(`^${e}`,"i"),n=i(t);let a=e.filter((e=>n.test(e.language)));if(!r){const r=i(Ct(t).language);a=a.concat(e.filter((e=>r.test(e.language))))}return a}function Dt(e,t){return Ot(e,t)[0]||e.find((e=>e.default))||e[0]}f(Pt,{compareLanguageTags:()=>xt,parseLanguageTag:()=>Ct});var Vt={};function Ut(e){return I(e)&&Number.isFinite(e)&&e>=0}function Bt(){return new class{constructor(){this.muted=!1,this.volume=NaN,this.currentTime=NaN,this.duration=NaN}}}f(Vt,{createSimpleVideoInterface:()=>Bt,isValidPlayheadTime:()=>Ut});var Ft=(e=>(e.ABORT="abort",e.CAN_PLAY="canplay",e.CAN_PLAY_THROUGH="canplaythrough",e.DURATION_CHANGE="durationchange",e.ENDED="ended",e.ERROR="error",e.LOADED_METADATA="loadedmetadata",e.LOAD_START="loadstart",e.PAUSE="pause",e.PLAY="play",e.PLAYING="playing",e.PROGRESS="progress",e.RATE_CHANGE="ratechange",e.SEEKED="seeked",e.SEEKING="seeking",e.STALLED="stalled",e.TIME_UPDATE="timeupdate",e.VOLUME_CHANGE="volumechange",e))(Ft||{}),Ht=(e=>(e.SHOWING="showing",e.HIDDEN="hidden",e.DISABLED="disabled",e))(Ht||{}),Kt="*",qt=class{constructor(e,t){var r;this.id3Map=[],this.daiId3=/^google_/,this.maxId3DedupeLength=qt.MAX_ID3_DEDUPE_LENGTH,this.onTextTrackAdded=({track:e})=>{this.isValidTrack(e)&&(e.mode="hidden",e.addEventListener("cuechange",this.onCueChange))},this.onCueChange=e=>{const t=e.target,r=t&&t.activeCues;r&&r.length&&pt(r,(e=>this.processId3(e)))},this.onSeeking=()=>{this.clearId3()},this.onMetadataCuepoint=t,this.video=e.video,this.id3OwnerIds=["com.cbsi.live.sg"].concat(e.resource.playback.id3OwnerIds||[]);const i=null==(r=e.playerOptions.overrides)?void 0:r.maxId3DedupeLength;null!=i&&(this.maxId3DedupeLength=i),this.addEvents(),this.logger=e.logger,this.logger.log("info","MetadataSurface created"),pt(this.video.textTracks,(e=>this.onTextTrackAdded({track:e})))}destroy(){this.onMetadataCuepoint=null,this.id3Map=null,this.removeEvents(),pt(this.video.textTracks,(e=>this.cleanupTrack(e)))}addEvents(){this.video.textTracks.addEventListener("addtrack",this.onTextTrackAdded),this.video.addEventListener("seeking",this.onSeeking)}removeEvents(){this.video.textTracks.removeEventListener("addtrack",this.onTextTrackAdded),this.video.removeEventListener("seeking",this.onSeeking),pt(this.video.textTracks,(e=>e.removeEventListener("cuechange",this.onCueChange)))}clearId3(){this.id3Map=[]}cleanupTrack(e){function t(t){try{t&&e.removeCue(t)}catch(e){}}"metadata"===e.kind&&(mt(e.cues,t),mt(e.activeCues,t))}processId3(e){if(x(e.value))return;const{value:t,startTime:r,endTime:i}=e,{key:n,info:a="",data:s}=t,o={key:n,info:a,data:s,startTime:r,endTime:i,source:e};if("TXXX"===n&&this.daiId3.test(s)?(x(a)&&(o.info=s),o.id="google_dai"):o.id=this.id3OwnerIds.find((e=>e===Kt||a.includes(e))),!o.id)return;let l;try{l=s instanceof ArrayBuffer?gt(s):s}catch(e){l=""}"PRIV"===n&&this.id3OwnerIds[0]===a&&(o.data=l),o.text=l,this.id3Map.some((e=>e.info===o.info&&e.startTime===o.startTime&&e.text===o.text))||(this.id3Map.length>this.maxId3DedupeLength&&this.id3Map.pop(),this.id3Map.unshift(o),this.onMetadataCuepoint(o))}isMetadataTrack(e){return"metadata"===e}isExpired(e){return e.expired}isValidTrack(e){return!!e&&!!this.isMetadataTrack(e.kind)&&!this.isExpired(e)}},Wt=qt;Wt.MAX_ID3_DEDUPE_LENGTH=32;var zt={};function Gt(e,t){let r;const i=()=>{clearTimeout(r),r=null},n=(...n)=>{i(),r=setTimeout(e,t,...n)};return n.cancel=i,n.flush=e,n.pending=()=>null!=r,n}f(zt,{debounce:()=>Gt});var jt=class{constructor(e,t={},r=!0){var i;this.metadataLoaded=!1,this.suppressErrors=!1,this.segmentDuration=6,this.pauseTime=NaN,this.eventsEnabled=!1,this.liveStreamInfo={isPlayingLive:!1,liveEdgeOffset:NaN,dvrWindowSize:NaN,relativeTime:NaN,relativeDuration:NaN,absoluteStart:NaN,absoluteTime:NaN,absoluteDuration:NaN},this.lastKnownTimes={absolute:NaN,relative:NaN,end:NaN},this.audioTrack=null,this.audioTracks=[],this.quality=null,this.qualities=null,this.textTrack=null,this.textTracks=[],this.minBitrate=0,this.maxBitrate=1/0,this.onVideoEvent=e=>{if(!this.eventsEnabled)return;const{delegate:t}=this;if("loadedmetadata"===e.type&&(this.metadataLoaded=!0),this.metadataLoaded||"durationchange"===e.type)switch(e.type){case"timeupdate":t.timeUpdate();break;case"playing":t.playing();break;case"pause":this.metadataLoaded&&t.paused();break;case"seeking":t.seeking();break;case"seeked":t.seeked();break;case"ended":t.ended();break;case"durationchange":t.durationChange();break;case"volumechange":t.volumeChange(this.video.volume,this.video.muted);break;case"error":this.suppressErrors||this.error(this.createVideoElementError())}},this.onTextEvent=(e,t)=>{if(!this.eventsEnabled)return;const{delegate:r}=this;switch(e){case"textCuepoint":r.textCuepoints(t.activeCues,t.forced);break;case"textTrackModeChange":r.textTrackDisplayModeChange(t.mode);break;case"textTrackAdded":this.textTracks.push({id:this.textTracks.length.toString(),kind:t.kind,language:t.language,label:t.label||t.language}),r.textTracksChange(this.textTracks);break;case"textTrackAvailable":r.textTracksChange(this.textTracks);break;case"textTrackChange":const e=this.textTracks.find((e=>t.language===e.language&&t.kind===e.kind&&(t.label===e.label||t.language===e.label)));this.textTrack=e,r.textTrackChange(e)}},this.context=e,this.options=t,this.video=e.video,this.delegate=this.context.getDelegate(),this.logger=e.logger,this.metadataSurface=this.createMetadataSurface();const n=null==(i=this.context.resource.playback)?void 0:i.abr;n&&(n.maxBitrate&&(this.maxBitrate=n.maxBitrate),n.minBitrate&&(this.minBitrate=n.minBitrate)),r&&(this.textTrackSurface=this.createTextTrackSurface()),Ce(Ft).forEach((e=>this.video.addEventListener(e,this.onVideoEvent))),this.onCueChange=this.onCueChange.bind(this)}static canPlay(e,t){const{avia:r,resource:i}=e,n=r.getSystemInfo(),a=Ze(i),s=t.includes(a);return n.hasMediaSource&&s}destroy(){var e,t;return Ce(Ft).forEach((e=>this.video.removeEventListener(e,this.onVideoEvent))),this.listenToTextTracks(!1,!0),null==(e=this.metadataSurface)||e.destroy(),this.metadataSurface=null,null==(t=this.textTrackSurface)||t.destroy(),this.textTrackSurface=null,this.context=null,this.options=null,this.delegate=null,this.logger=null,this.video=null,Promise.resolve()}getIsLiveStream(){return this.video.duration===1/0}setAutoQualitySwitching(e){throw new Error("setAutoQualitySwitching Method not implemented.")}setQuality(e){throw new Error("setQuality Method not implemented.")}setMinBitrate(e){this.minBitrate=e}setMaxBitrate(e){this.maxBitrate=e}setTextTrack(e){if(!this.textTrackSurface)return;const t=Array.from(this.video.textTracks).find((t=>e.language===t.language&&e.kind===t.kind&&e.label===t.label));this.textTrackSurface.textTrack=t}setTextTrackMode(e){this.textTrackSurface&&(this.textTrackSurface.textTrackMode=e)}setAudioTrack(e){throw new Error("setAudioTrack Method not implemented.")}getId(){throw new Error("getId Method not implemented.")}getCurrentTime(){return this.video.currentTime}getDuration(){return this.video.duration}getBufferLength(){const{buffered:e,currentTime:t}=this.video;return e.length>0?e.end(e.length-1)-t:0}getLiveStreamInfo(){const e=this.liveStreamInfo,{start:t,end:r}=this.getSeekable(),i=this.video.currentTime,n=r-t,a=this.getLiveEdgeOffset();e.relativeTime=Math.max(i-t,0),e.relativeDuration=n,e.absoluteDuration=Date.now(),e.dvrWindowSize=Math.floor(n),e.liveEdgeOffset=a,e.isPlayingLive=Math.ceil(i-t+a)>=n-a,r!==this.lastKnownTimes.end&&(this.lastKnownTimes.end=r,e.absoluteStart=e.absoluteDuration-1e3*n,this.lastKnownTimes.absolute=Math.round(e.absoluteStart+1e3*e.relativeTime),this.lastKnownTimes.relative=i);const s=Math.round(1e3*(i-this.lastKnownTimes.relative));return e.absoluteTime=this.lastKnownTimes.absolute+s,e}load(){return this.enableSurfaceEvents(!0),this.suppressErrors=!0,Promise.resolve(et(this.context.resource))}play(){if(!isNaN(this.pauseTime)){if(this.pauseTime<this.liveStreamInfo.absoluteStart){const e=this.getSeekable().start+this.getLiveEdgeOffset();this.logger.log("info",`Playhead outside of DVR window bounds. Moving to ${e}`),this.seek(e)}this.pauseTime=NaN}return Promise.resolve(this.video.play())}pause(){var e;this.getIsLiveStream()&&!0===(null==(e=this.context.resource.overrides)?void 0:e.clearOutOfBoundsDvrBuffer)&&(this.pauseTime=this.liveStreamInfo.absoluteTime),this.video.pause()}suspend(){}resume(){}seek(e){const{start:t,end:r}=this.getSeekable(),i=Se(e,0,r-t,t,r);return Ut(i)?(this.video.currentTime=i,Ae(this.video,"seeked")):Promise.resolve()}resize(){}clearText(){var e;null==(e=this.textTrackSurface)||e.clearCue()}getMetrics(){const{video:e}=this,t={bandwidth:NaN,framerate:NaN,droppedVideoFrames:Number.NaN,totalVideoFrames:Number.NaN};"getVideoPlaybackQuality"in e?Object.assign(t,e.getVideoPlaybackQuality()):"webkitDroppedFrameCount"in e&&"webkitDecodedFrameCount"in e&&(t.droppedVideoFrames=e.webkitDroppedFrameCount,t.totalVideoFrames=e.webkitDroppedFrameCount+e.webkitDecodedFrameCount);const r=e.webkitDecodedFrameCount||e.mozPresentedFrames;return r&&(t.framerate=r/e.currentTime),t}getLiveEdgeOffset(){const e=this.getSegmentDuration(),t=this.context.resource.playback.liveEdgeSyncFragmentCount;return Math.max(e,e*t)}createMetadataSurface(){return new Wt(this.context,this.delegate.metadataCuepoint)}createTextTrackSurface(){return new class{constructor(e,t){this.pTextTracks=null,this.currentTextTrack=null,this.currentTextTrackMode="disabled",this.existingTrack=[],this.addedTracks=[],this.onVideoTextTrackAdded=e=>{e.track.expired=!1,this.onTextTrackAdded(e)},this.onTextTrackAdded=e=>{const t=e.track,r="subtitles"===t.kind&&!t.language&&!t.label;"metadata"===t.kind||r||this.addDebounced()},this.onTextTrackChange=e=>{this.processDebounced()},this.onCueChange=e=>{const t=e.target,r="forced"===t.kind;if(!this.config.textTrackSettings.enabled&&!r)return;const i=It(t);this.emit("textCuepoint",{activeCues:i,forced:r})},this.addTracks=()=>{if(pt(this.pTextTracks,(e=>{const t=this.isExpired(e)||this.isDuplicateTrack(e);e.mode=t?"disabled":"hidden",t||this.addTrack(e)})),!this.currentTextTrack){if(this.textTrack=Dt(this.textTracks,this.config.textTrackSettings.language),!this.textTrack)return;this.textTrack.mode=this.config.textTrackSettings.mode,this.emit("textTrackAvailable")}this.processTracks()},this.processTracks=()=>{const{enabled:e,native:t,enabledMode:r}=this.config.textTrackSettings,i=this.textTracks;if(pt(this.pTextTracks,(e=>{this.isExpired(e)&&"disabled"!==e.mode&&(e.mode="disabled")})),!t){if(e){const e=i.find((e=>"showing"===e.mode));e&&(e.mode=r)}else{const e=i.find((e=>"disabled"!==e.mode));e&&(e.mode="disabled")}return}const n=i.find((e=>"showing"===e.mode));if(e){if(n===this.currentTextTrack)return;n?this.textTrack=n:this.textTrackMode="disabled"}else{if(!n)return;n!==this.currentTextTrack&&(this.textTrack=n),this.textTrackMode="showing"}},this.config=e,this.video=e.video,this.pTextTracks=this.video.textTracks,this.currentTextTrackMode=e.textTrackSettings.mode,this.pForcedLanguage=e.textTrackSettings.language,this.emit=t||(()=>{}),this.processDebounced=Gt(this.processTracks,100),this.addDebounced=Gt(this.addTracks,25),this.addEvents(),this.logger=e.logger,this.logger.log("info","TextTrackSurface created"),this.config.resource.location.textTrackUrl&&_t(this.config.resource,this.video)}destroy(){this.processDebounced.cancel(),this.addDebounced.cancel(),this.emit=null,this.removeEvents(),pt(this.pTextTracks,(e=>this.cleanupTrack(e))),pt(this.video.querySelectorAll("track"),(e=>this.video.removeChild(e)))}clearCue(){Mt(this.currentTextTrack,this.video.currentTime)}cleanupTrack(e){if(this.isTextTrack(e.kind)){mt(e.cues,t),mt(e.activeCues,t),e.expired=!0,e.textTrack1=!0,e.textTrack2=!0,e.isTTML=!0,e.isEmbedded=!1;try{e.mode="disabled"}catch(e){}}function t(t){try{t&&e.removeCue(t)}catch(e){}}}set textTrackMode(e){this.currentTextTrack?this.setTrackMode(e):this.logger.log("warn","No text track detected")}set textTrack(e){this.isValidTrack(e)&&e!==this.currentTextTrack&&(this.currentTextTrack&&"disabled"!==this.currentTextTrack.mode&&(this.currentTextTrack.mode="disabled"),this.currentTextTrack=e,this.setTrackMode(this.currentTextTrackMode).then((()=>{this.logger.log("info",`${e.language} is being set as the current text track`),this.emit("textTrackChange",e)})))}get textTrack(){return this.currentTextTrack}get textTracks(){return Array.from(this.pTextTracks).filter((e=>this.isValidTrack(e)))}set forcedLanguage(e){this.pForcedLanguage=e,this.updateForcedNarrative()}get forcedLanguage(){return this.pForcedLanguage}setTrackMode(e){return new Promise(((t,r)=>{const i=e!==this.currentTextTrackMode,n=()=>{this.currentTextTrack.mode=e,this.updateForcedNarrative(),i&&setTimeout((()=>this.emit("textTrackModeChange",{mode:e})),0);let r="disabled";"hidden"===e&&(r="enabled for event driven external custom rendering"),"showing"===e&&(r="enabled for native rendering by the user agent"),this.logger.log("info",`The ${this.currentTextTrack.kind} track for language code ${this.currentTextTrack.language} is being ${r} `),t()};this.currentTextTrackMode=e,"showing"===e&&"disabled"===this.currentTextTrack.mode?(this.currentTextTrack.mode="hidden",setTimeout(n,10)):n()}))}updateForcedNarrative(){const e=Array.from(this.pTextTracks).filter((e=>"forced"===e.kind));if(e.forEach((e=>e.mode="disabled")),"disabled"!==this.currentTextTrackMode)return;const t=e.find((e=>e.language===this.pForcedLanguage));t&&(t.addEventListener("cuechange",this.onCueChange),t.mode=this.config.textTrackSettings.enabledMode)}addTrack(e){this.addedTracks.includes(e)||(this.addedTracks.push(e),this.isValidTrack(e)&&(e.addEventListener("cuechange",this.onCueChange),this.logger.log("info",`A ${e.kind} text track was added for ${e.language}`),this.emit("textTrackAdded",e)))}addEvents(){this.pTextTracks.addEventListener("addtrack",this.onTextTrackAdded),this.pTextTracks.addEventListener("change",this.onTextTrackChange),this.video.addEventListener("addtrack",this.onVideoTextTrackAdded)}removeEvents(){this.pTextTracks.removeEventListener("addtrack",this.onTextTrackAdded),this.pTextTracks.removeEventListener("change",this.onTextTrackChange),this.video.removeEventListener("addtrack",this.onVideoTextTrackAdded),pt(this.pTextTracks,(e=>e.removeEventListener("cuechange",this.onCueChange)))}isDuplicateTrack(e){if(this.existingTrack.includes(e))return!1;const t=this.existingTrack.some((t=>e.language===t.language&&e.label===t.label&&e.kind===t.kind));return t||this.existingTrack.push(e),t}isTextTrack(e){return"captions"===e||"subtitles"===e}isExpired(e){return e.expired}isValidTrack(e){return!!e&&!!this.isTextTrack(e.kind)&&!this.isExpired(e)}}(this.context,this.onTextEvent)}enableSurfaceEvents(e){this.eventsEnabled=!0}addEvents(e,t){const r=M(e.on)?"on":"addEventListener";xe(t).forEach((t=>e[r](t[0],t[1])))}removeEvents(e,t){const r=M(e.off)?"off":"removeEventListener";xe(t).forEach((t=>{var i,n;null==(n=(i=t[1]).cancel)||n.call(i),e[r](t[0],t[1])}))}createVideoElementError(){const e=this.video.error;let t=Object.keys(MediaError)[e.code-1]||ue.messages.UNSPECIFIED_ERROR,r="3400";switch(e.code){case MediaError.MEDIA_ERR_ABORTED:t=e.toString(),r="3100";break;case MediaError.MEDIA_ERR_NETWORK:r="3001";break;case MediaError.MEDIA_ERR_DECODE:r="3200";break;case MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED:r="3101";break;default:r="3400"}return{code:r,message:t,data:e,fatal:!0}}getSegmentDuration(){return this.segmentDuration}getSeekable(){const e={start:0,end:0},t=this.video.seekable,r=t.length-1;return r>=0&&(e.start=t.start(r),e.end=t.end(r)),e}getErrorMessage(e,t,r="n/a"){return`${e} fatal: ${t} retry: ${r}`}createError(e,t,r,i=!0){return new se(e,t,r,i)}throwError(e,t,r,i=!0){this.error(this.createError(e,t,r,i))}error(e){this.delegate.error(e)}createSidecarTextTrack(){var e;const{resource:t,video:r}=this.context;(null==(e=t.location)?void 0:e.textTrackUrl)&&_t(t,r)}updateQualities(e){e.sort(((e,t)=>e.bitrate-t.bitrate));const t=this.context.resource.playback.abr.capQualityToScreenSize;je(e,this.minBitrate,this.maxBitrate,t&&this.video)||this.logger.warn("Invalid qualities array. None of the values meet the current size/bitrate constraints."),this.delegate.qualitiesChange(e)}listenToTextTracks(e,t=!1){const r=e?"addEventListener":"removeEventListener";Array.from(this.context.video.textTracks).forEach((e=>{Nt(e.kind)&&(e[r]("cuechange",this.onCueChange),t&&wt(e))}))}onCueChange(e,t){const r=e.target,i=It(r),n=!0===e.target.forced;null!=t||(t="forced"===r.kind||e.forced||n),this.delegate.textCuepoints(i,t)}},$t=class{constructor(e,t,r){this.key=e,this.value=t,this.type=r,this.timeStamp=Date.now()}},Yt=Object.freeze({env:"__ENV__",playerVersion:"2.8.0",playerName:"@cbsinteractive/avia-js",buildTime:"2022-10-18T21:21:49.454Z"}),Qt=(e=>(e.ENTER_FULLSCREEN="enterFullScreen",e.INCREASE_VOLUME="increaseVolume",e.DECREASE_VOLUME="decreaseVolume",e.SEEK_BACK="seekBack",e.SEEK_FORWARD="seekForward",e.TOGGLE_PLAY="togglePlay",e.TOGGLE_TT="toggleTextTrack",e.TOGGLE_MUTE="toggleMute",e.PLAYLIST_NEXT="playListNext",e.PLAYLIST_PREV="playListPrev",e.STOP="stop",e))(Qt||{}),Xt=(e=>(e.ACTIVE="active",e.INACTIVE="inactive",e.IDLE="idle",e))(Xt||{}),Jt=(e=>(e.AD="ad",e.PLAYBACK="playback",e))(Jt||{}),Zt=(e=>(e.PRE="PRE",e.MID="MID",e.POST="POST",e))(Zt||{}),er=(e=>(e.SSAI="ssai",e.CSAI="csai",e))(er||{}),tr=(e=>(e.PLAY="play",e.PAUSE="pause",e.SEEK="seek",e.GO_LIVE="go_live",e))(tr||{}),rr=(e=>(e.MAIN="main",e.DESCRIPTION="description",e))(rr||{}),ir=(e=>(e.NONE="none",e.ATTEMPT_MUTED="attemptMuted",e.ATTEMPT_UNMUTED="attemptUnmuted",e.ATTEMPT_UNMUTED_THEN_MUTED="attemptUnmutedThenMuted",e))(ir||{}),nr=(e=>(e.MULTI_CDN="x-cdn",e))(nr||{}),ar=(e=>(e.HOTKEY_ACTION="hotkeyaction",e.READY="ready",e.AD_SKIPPABLE_STATE_CHANGE="adskippablestatechange",e.AD_CUEPOINTS_AVAILABLE="adcuepointsavailable",e.AD_BREAK_START="adbreakstart",e.AD_BREAK_METADATA="adbreakmetadata",e.AD_BREAK_COMPLETE="adbreakcomplete",e.AD_START="adstart",e.AD_COMPLETE="adcomplete",e.AD_FIRST_QUARTILE="adfirstquartile",e.AD_MIDPOINT="admidpoint",e.AD_THIRD_QUARTILE="adthirdquartile",e.AD_SEGMENT_START="adsegmentstart",e.AD_SEGMENT_END="adsegmentend",e.AD_SEGMENT_REENTERED="adsegmentreentered",e.AD_SKIPPED="adskipped",e.AD_PROGRESS="adprogress",e.AD_PAUSED="adpaused",e.AD_PLAYING="adplaying",e.AD_STALLED="adstalled",e.AD_BREAK_DISCARDED="adbreakdiscarded",e.AD_CLICK="ad-click",e.AUDIO_TRACK_INFO_CHANGE="audiotrackinfochange",e.AUDIO_TRACK_CHANGE="audiotrackchange",e.AUDIO_TRACKS_CHANGE="audiotrackschange",e.QUALITY_CHANGE="qualitychange",e.QUALITIES_CHANGE="qualitieschange",e.QUALITY_INFO_CHANGE="qualityinfochange",e.CDN_CHANGE="cdnchange",e.CONTENT_START="contentstart",e.CONTENT_DURATION_AVAILABLE="contentdurationavailable",e.CONTENT_SEGMENT_START="contentsegmentstart",e.CONTENT_PLAYING="contentplaying",e.CONTENT_PROGRESS="contentprogress",e.CONTENT_PAUSED="contentpaused",e.CONTENT_SEGMENT_END="contentsegmentend",e.CONTENT_COMPLETE="contentcomplete",e.CONTENT_IS_PLAYING_LIVE="contentisplayinglive",e.STREAM_TYPE_CHANGE="streamtypechange",e.STREAM_METADATA="streammetadata",e.STREAM_ID_AVAILABLE="streamidavailable",e.DRM_KEY_SYSTEM_CREATED="drmkeysystemcreated",e.ERROR="error",e.PLAYBACK_STARTED="playbackstarted",e.PLAYBACK_SUSPENDED="playbacksuspended",e.PLAYBACK_RESUMED="playbackresumed",e.RESOURCE_START="resourcestart",e.RESOURCE_END="resourceend",e.RESOURCE_BUFFERING="resourcebuffering",e.SEEK_COMPLETE="seekcomplete",e.SEEK_START="seekstart",e.SEEK_REDIRECT_START="seekredirectstart",e.SEEK_REDIRECT_COMPLETE="seekredirectcomplete",e.METADATA_CUEPOINT="metadatacuepoint",e.TEXT_CUEPOINT="textcuepoint",e.TEXT_TRACK_CHANGE="texttrackchange",e.TEXT_TRACKS_CHANGE="texttrackschange",e.TEXT_TRACK_INFO_CHANGE="texttrackinfochange",e.TEXT_TRACK_ENABLED_CHANGE="texttrackenabledchange",e.TEXT_TRACK_AVAILABLE="texttrackavailable",e.THUMBNAIL_TRACK_AVAILABLE="thumbnailtrackavailable",e.LIVE_PRESENTATION_STOPPED="livepresentationstopped",e.PRESENTATION_SIZE_CHANGE="presentationsizechange",e.FULLSCREEN_CHANGE="fullscreenchange",e.LOG_EVENT="logevent",e.PLUGIN_EVENT="pluginevent",e.LANGUAGE_CHANGE="languagechange",e.AUTOPLAY_BLOCKED="autoplayblocked",e.VOLUME_CHANGE="volumechange",e.MUTE_CHANGE="mutechange",e.ACTIVE_STATE_CHANGE="activestatechange",e.PLAYBACK_STATE_CHANGE="playbackstatechange",e.METRIC="metric",e.VIDEO_ELEMENT_ADDED="videoelementadded",e.VIDEO_ELEMENT_REMOVED="videoelementremoved",e))(ar||{}),sr=["audiotrackinfochange","texttrackinfochange"],or=class{static warn(e){J.deprecated(e)}static checkEventName(e){sr.includes(e)&&or.warn(`The ${e} event has been deprecated. This check will be removed July 1st, 2023`)}static hookType(){or.warn("The HookType enum is deprecated in favor of PlayerHookType and will be removed after July 1st, 2023")}static qualityInfo(){or.warn("player.qualityInfo method is deprecated. Please use player.qualities instead. Access to this property will be completely removed July 1st, 2023")}static textTrackInfo(){or.warn("player.textTrackInfo method is deprecated. Please use player.textTracks instead. Access to this property will be completely removed July 1st, 2023")}static audioTrackInfo(){or.warn("player.audioTrackInfo method is deprecated. Please use player.audioTracks instead. Access to this property will be completely removed July 1st, 2023")}static language(){or.warn("player.language setter is deprecated. Please use player.selectAudioLanguage, player.selectTextLanguage, or player.selectLocalizationLanguage instead. Access to this property will be completely removed July 1st, 2023")}},lr=class{static get EVENT(){return or.hookType(),"event"}static get AD_BREAK(){return or.hookType(),"adbreak"}static get AD(){return or.hookType(),"ad"}static get ATTACH_RESOURCE(){return or.hookType(),"attachresource"}static get REQUEST(){return or.hookType(),"request"}static get RESPONSE(){return or.hookType(),"response"}},dr="html5",cr=(e=>(e.NONE="none",e.DOCUMENT="document",e.PLAYER="player",e))(cr||{}),ur=(e=>(e.MEDIA_PLAYER="media-player",e.LEARN_MORE="learn-more",e))(ur||{}),hr=(e=>(e.EN="English",e.ES="Español",e.FR="Français",e.PT="Português",e.DE="Deutsche",e.PL="Polski",e.JA="日本人",e.KO="한국어",e.ZH="简体中文",e.IT="Italiano",e.RU="Русский",e))(hr||{}),pr=(e=>(e.API="api",e.UI="ui",e.MARK="mark",e.MEASURE="measure",e))(pr||{}),mr=(e=>(e.AUTO="auto",e.DESKTOP="desktop",e.MOBILE="mobile",e.TV="tv",e.LOW="low",e))(mr||{}),gr=(e=>(e.IDLE="idle",e.STOPPED="stopped",e.PLAYING="playing",e.PAUSED="paused",e.WAITING="waiting",e))(gr||{}),Ar=(e=>(e.LOW="low",e.HIGH="high",e))(Ar||{}),yr=(e=>(e[e.DEFINITION=0]="DEFINITION",e[e.HEIGHT=1]="HEIGHT",e[e.BITRATE=2]="BITRATE",e[e.CUSTOM=3]="CUSTOM",e))(yr||{}),fr=(e=>(e.AUTO="auto",e.MANUAL="manual",e.UNAVAILABLE="unavailable",e))(fr||{}),vr=(e=>(e.GET="GET",e.POST="POST",e.DELETE="DELETE",e.OPTIONS="OPTIONS",e.PUT="PUT",e))(vr||{}),Tr=(e=>(e.VOD="VOD",e.LIVE="LIVE",e.DVR="DVR",e))(Tr||{}),Er=(e=>(e.SEEK_BY="seek_by",e))(Er||{}),br=(e=>(e.HLS="hls",e.DASH="dash",e.MP4="mp4",e.UNKNOWN="unknown",e))(br||{}),kr=class extends se{constructor(e){super("9000",e,null,!1,"API"),this.name="InvalidArgumentError"}};function Sr(e,t){(null==e?void 0:e.style)&&(null==t?void 0:t.style)&&Object.assign(t.style,e.style)}var Pr=class{constructor(e,t){this.url=e,this.cues=t}getCueAt(e){return this.cues.find((t=>t.startTime<=e&&t.endTime>=e))}renderCueAt(e,t){Sr(this.getCueAt(e),t)}static create(e){const t=document.createElement("a");t.href=e;const r=t.protocol+"//"+t.hostname,i=r+t.pathname.split("/").slice(0,-1).join("/")+"/";return dt({url:e}).then((t=>{const n=class{static parseCaption(e,t=0,r={}){const i=e.trim().split("\n"),n=/([0-9:.]+)\s*-->\s*([0-9:.]+)([^\n]*)/,a=/\s*([A-Za-z]+)\s*:\s*([\w\-%]+)/g;try{n.test(i[0])||(t=parseInt(i.shift()));const e=i[0].match(n).slice(1),s=e[2],o=G(e[0]),l=G(e[1]),d=i.slice(1).join("\n");return null!=s&&s.replace(a,((e,t,i)=>r[t]=i)),A({id:t,startTime:o,endTime:l,text:d},r)}catch(e){return null}}static parse(e){const t=(e=e.replace(/\r/g,"")).split("\n\n"),r=/^(WEBVTT|NOTE|STYLE)/;return t.reduce(((e,t)=>{if(!r.test(t)&&t){const r=this.parseCaption(t,e.length);r&&e.push(r)}return e}),[])}}.parse(t);return n.forEach((e=>{const[t,n]=e.text.split("#");let a=t;/^(https?:)?\/\//.test(a)||(a=/^\//.test(a)?r+a:i+a);const s=n.split("="),o=s[0],l=s[1].split(","),d={backgroundImage:`url(${a})`},c={url:a};pt(o,((e,t)=>{const r=l[t];switch(e){case"w":c.width=parseInt(r),d.width=`${r}px`;break;case"h":c.height=parseInt(r),d.height=`${r}px`;break;case"x":c.x=parseInt(r),d.backgroundPositionX=`-${r}px`;break;case"y":c.y=parseInt(r),d.backgroundPositionY=`-${r}px`}})),e.style=d,e.data=c})),new Pr(e,n)}))}},Cr={};f(Cr,{applyRequestToXhr:()=>Rr,createRequest:()=>wr,getHeader:()=>Ir,loadScript:()=>Nr,loadSdk:()=>Lr,makeUrl:()=>_r});var xr=class extends st{constructor(e){const t=Object.assign({timeout:at.TIMEOUT},e||{});t.timeout||(t.timeout=at.TIMEOUT),super(t),this.timeoutHandles={},this.map={};const r=this.hasListenerFor(xr.event.COMPLETE);if(this.opts.url&&r)this.loadScript(this.opts.url);else{if(!this.opts.urls||!r)throw new Error(`Script load error: Missing url or listener. url: ${this.opts.url||this.opts.urls}, hasListener: ${r}`);this.loadScripts(this.opts.urls)}}static load(e){return new Promise(((t,r)=>{e.onComplete=({detail:e})=>e.error||e.timedOut?r(e):t(e),new xr(e)}))}destroy(){if(this.timeoutHandles){for(const e in this.timeoutHandles)clearTimeout(this.timeoutHandles[e]);this.timeoutHandles=null,super.destroy()}}loadScript(e,t){const r=document.createElement("script"),i="https:"===window.location.protocol?e.replace("http:","https:"):e;this.map[i]={hLoad:()=>this.hLoadOrError(i),hError:()=>this.hLoadOrError(i,!0,!1),scriptEl:r};const n=this.map[i];t&&this.on(xr.event.COMPLETE,t),r.async=!0,r.addEventListener("load",n.hLoad),r.addEventListener("error",n.hError),this.timeoutHandles[i]=setTimeout((()=>this.hLoadOrError(i,!0,!0)),this.opts.timeout),document.head.appendChild(r),r.src=i}loadScripts(e,t){t&&this.on(xr.event.COMPLETE,t);for(let t=0,r=e.length;t<r;t++)this.loadScript(e[t])}hLoadOrError(e,t,r){clearTimeout(this.timeoutHandles[e]),delete this.timeoutHandles[e];const i=this.map[e];i.scriptEl.removeEventListener("load",i.hLoad),i.scriptEl.removeEventListener("error",i.hError);for(const e in i)delete i[e];delete this.map[e],t&&this.shouldRetry()?(this.incrementAttempts(),setTimeout((()=>{this.loadScript(e)}),this.retryInterval)):this.emit(xr.event.COMPLETE,{url:e,error:t,timedOut:!0===r})}},Mr=xr;function wr(e,t={},r="same-origin"){return{url:e,headers:t,credentials:r}}function Rr(e,t){xe(e.headers).forEach((([e,r])=>{t.setRequestHeader(e,r)})),t.withCredentials="include"===e.credentials}function Ir(e,t){var r;if(!e||!t)return null;const i=new RegExp(`${e}:([^\\n\\r]+)`,"i");return null==(r=t.match(i))?void 0:r[1].trim()}function Nr(e,t){const{overrides:r,networkTimeout:i}=t||{};return Mr.load({url:_r(e.url),timeout:(null==r?void 0:r.streamingLibLoaderTimeout)||i,errorRecovery:Ie({},null==t?void 0:t.networkErrorRecovery,e.errorRecovery)})}function Lr(e,t,r){return E(this,null,(function*(){if("string"==typeof t){try{e()||(yield Nr({url:t},r))}catch(e){}return e()}return t}))}function _r(e){/^\.\.\//.test(e)&&(e=new URL(e,window.location.toString()).toString());const t=e.replace(/^(https?:?)?(\/\/)?/,"");return(Fe.isWebOs?"https:":window.location.protocol)+"//"+t}Mr.event={COMPLETE:"complete"};var Or=A(y(A(A(A(A(y(A(A(y(A(A(A(A(y(A({},ct),{eventsToPromise:ve,getMaxBitrateIndex:ze,getMinBitrateIndex:function(e,t){const r=e.length-1;if(t>=e[r].bitrate)return r;for(let i=r-1;i>0;i--){const{bitrate:r}=e[i];if(t===r)return i;if(t>r)return i+1}return 0}}),Ye),zt),Pt),Cr),{normalizeQuality:function(e,t){return{index:t,bitrate:e.bitrate,height:e.height,width:e.width,codec:e.codec||e.codecs,enabled:e.enabled||!0}}}),Te),Pe),{request:dt}),$e),P),tt),C),{validateQualities:je,validateQuality:Ge}),Vt),Dr=(e=>(e.WIDEVINE="com.widevine.alpha",e.PLAYREADY="com.microsoft.playready",e.CLEAR_KEY="org.w3.clearkey",e.FAIRPLAY_1_0="com.apple.fps.1_0",e))(Dr||{}),Vr={};f(Vr,{CMCD_VERSION:()=>1,CmcdObjectType:()=>ft,CmcdStreamType:()=>Br,CmcdStreamingFormat:()=>Ur,appendCmcdToUrl:()=>St,decode:()=>bt,encode:()=>Et,toQuery:()=>kt});var Ur=(e=>(e.DASH="d",e.HLS="h",e.SMOOTH="s",e.OTHER="o",e))(Ur||{}),Br=(e=>(e.VOD="v",e.LIVE="l",e))(Br||{}),Fr=class extends Y{constructor(e=250){super({}),this.timer=NaN,this.pCount=0,this.pInterval=e}destroy(){this.stop(),super.destroy()}start(){this.running||(this.timer=setInterval((()=>{this.pCount++,this.emit(Fr.TIC_EVENT,{count:this.pCount})}),this.pInterval))}stop(){clearInterval(this.timer),this.timer=NaN,this.pCount=0}get running(){return!isNaN(this.timer)}get interval(){return this.pInterval}get count(){return this.pCount}},Hr=Fr;Hr.TICK="tic",Hr.TIC_EVENT=Fr.TICK;var Kr=class{constructor(){}},qr=class{constructor(e){qr.serviceContainerMap[e]?J.error(Kr.ERROR_KEY_EXISTS.replace("$ACTOR_NAME$","ServiceContainer")):(this.multiCoreKey=e,this.serviceMap={})}static getInstance(e){return e?(null==this.serviceContainerMap[e]&&(this.serviceContainerMap[e]=new qr(e)),this.serviceContainerMap[e]):null}static removeServiceContainer(e){this.serviceContainerMap[e]&&this.serviceContainerMap[e].destroy(),delete this.serviceContainerMap[e]}destroy(){for(const e in this.serviceMap)this.removeService(e);this.serviceMap=null}registerService(e){this.serviceMap[e.name]=e,e.onRegister(this.multiCoreKey)}retrieveService(e){return this.serviceMap[e]||null}hasService(e){return null!=this.serviceMap[e]}removeService(e){this.serviceMap[e]&&this.serviceMap[e].destroy(),delete this.serviceMap[e]}},Wr=qr;Wr.serviceContainerMap={};var zr=class{constructor(e,t){this.setNotifyMethod(e),this.setNotifyContext(t)}destroy(){this.context=null,this.notify=null}setNotifyMethod(e){this.notify=e}setNotifyContext(e){this.context=e}getNotifyMethod(){return this.notify}getNotifyContext(){return this.context}notifyObserver(e){this.getNotifyMethod().call(this.getNotifyContext(),e)}compareNotifyContext(e){return e===this.context}},Gr=class{constructor(e){null==Gr.viewMap[e]?(this.multiCoreKey=e,this.mediatorMap={},this.observerMap={},Gr.viewMap[this.multiCoreKey]=this,this.initializeView()):J.error(Kr.ERROR_KEY_EXISTS.replace("$ACTOR_NAME$","View"))}static getInstance(e){return e?(this.viewMap[e]||(this.viewMap[e]=new Gr(e)),this.viewMap[e]):null}static removeView(e){this.viewMap[e]&&this.viewMap[e].destroy(),delete this.viewMap[e]}destroy(){for(const e in this.mediatorMap)this.removeMediator(this.mediatorMap[e].name);this.mediatorMap=null,this.observerMap=null}registerObserver(e,t){null!=this.observerMap[e]?this.observerMap[e].push(t):this.observerMap[e]=[t]}notifyObservers(e){let t,r;if(null!=this.observerMap[e.name]){const i=this.observerMap[e.name],n=[];let a;for(t=0,r=i.length;t<r;t++)a=i[t],n.push(a);for(t=0,r=n.length;t<r;t++)a=n[t],a.notifyObserver(e)}}removeObserver(e,t){if(!this.observerMap)return;const r=this.observerMap[e];let i=r.length;for(;i--;)if(!0===r[i].compareNotifyContext(t)){r.splice(i,1);break}0===r.length&&delete this.observerMap[e]}registerMediator(e){const t=e.name;let r,i,n;if(this.mediatorMap[t])return;e.initializeNotifier(this.multiCoreKey),this.mediatorMap[t]=e;const a=e.listNotificationInterests();if(a.length>0)for(n=new zr(e.handleNotification,e),r=0,i=a.length;r<i;r++)this.registerObserver(a[r],n);e.onRegister()}retrieveMediator(e){return this.mediatorMap[e]}removeMediator(e){const t=this.mediatorMap[e];if(t){const r=t.listNotificationInterests();let i=r.length;for(;i--;)this.removeObserver(r[i],t);delete this.mediatorMap[e],t.onRemove()}}hasMediator(e){return null!=this.mediatorMap[e]}initializeView(){}},jr=Gr;jr.viewMap={};var $r=class{constructor(e){$r.controllerMap[e]?J.error(Kr.ERROR_KEY_EXISTS.replace("$ACTOR_NAME$","Controller")):(this.multiCoreKey=e,$r.controllerMap[this.multiCoreKey]=this,this.commandMap={},this.view=null,this.initializeController())}static getInstance(e){return e?(this.controllerMap[e]||(this.controllerMap[e]=new $r(e)),this.controllerMap[e]):null}static removeController(e){this.controllerMap[e]&&this.controllerMap[e].destroy(),delete this.controllerMap[e]}destroy(){for(const e in this.commandMap)this.removeCommand(e);this.commandMap=null,this.view=null}initializeController(){this.view=jr.getInstance(this.multiCoreKey)}executeCommand(e){const t=this.commandMap[e.name];if(!t)return;const r=new t;r.initializeNotifier(this.multiCoreKey),r.execute(e)}registerCommand(e,t){this.commandMap[e]||this.view.registerObserver(e,new zr(this.executeCommand,this)),this.commandMap[e]=t}hasCommand(e){return!!this.commandMap[e]}removeCommand(e){this.hasCommand(e)&&(this.view.removeObserver(e,this),this.commandMap[e]=null)}},Yr=$r;Yr.controllerMap={};var Qr=class{constructor(e){this.proxyMap=null,Qr.modelMap[e]?J.error(Kr.ERROR_KEY_EXISTS.replace("$ACTOR_NAME$","Model")):(this.multiCoreKey=e,Qr.modelMap[e]=this,this.proxyMap={},this.initializeModel())}static getInstance(e){return e?(null==this.modelMap[e]&&(this.modelMap[e]=new Qr(e)),this.modelMap[e]):null}static removeModel(e){this.modelMap[e]&&this.modelMap[e].destroy(),delete this.modelMap[e]}destroy(){for(const e in this.proxyMap)this.removeProxy(e);this.proxyMap=null}initializeModel(){}registerProxy(e){this.proxyMap[e.name]=e,e.initializeNotifier(this.multiCoreKey),e.onRegister()}retrieveProxy(e){return this.proxyMap[e]||null}hasProxy(e){return null!=this.proxyMap[e]}removeProxy(e){const t=this.proxyMap[e];t&&(t.onRemove(),this.proxyMap[e]=null)}},Xr=Qr;Xr.modelMap={};var Jr=class{constructor(e,t,r){this.pName=e,this.pBody=t,this.pType=r}get name(){return this.pName}get body(){return this.pBody}get type(){return this.pType||null}toString(){const e=`\nBody: ${null==this.pBody?"null":JSON.stringify(this.body)}`,t=`\nType: ${null==this.pType?"null":this.type}`;return`Notification Name: ${this.name+e+t}`}},Zr=class{constructor(e,t){this.model=null,this.view=null,this.controller=null,this.serviceContainer=null,this.initialized=!1,this.multiCoreKey=e,this.initializeFacade(),this.registerCommands(t)}static removeCore(e){this.facadeMap[e]&&(Xr.removeModel(e),jr.removeView(e),Yr.removeController(e),Wr.removeServiceContainer(e),this.facadeMap[e].destroy(),delete this.facadeMap[e])}static hasCore(e){return null!=Zr.facadeMap[e]}static getInstance(e){if(!e)throw new Error(Kr.ERROR_NO_KEY);return this.facadeMap[e]}static createFacade(e,t){if(!e)throw new Error(Kr.ERROR_NO_KEY);if(this.facadeMap[e]){const t=new Error(`Not creating facade - key "${e}" already exists!`);throw t.key=e,t}return this.facadeMap[e]=new Zr(e,t),this.facadeMap[e]}destroy(){this.model=null,this.view=null,this.controller=null,this.serviceContainer=null}get key(){return this.multiCoreKey}get appId(){return this.multiCoreKey}get logger(){return this.retrieveService("Logging").logger}log(e,...t){this.logger.log(e,...t)}registerCommand(e,t){this.controller.registerCommand(e,t)}removeCommand(e){this.controller.removeCommand(e)}hasCommand(e){return this.controller.hasCommand(e)}registerProxy(e){this.model.registerProxy(e)}retrieveProxy(e){return this.model?this.model.retrieveProxy(e):null}removeProxy(e){this.model&&this.model.removeProxy(e)}hasProxy(e){return this.model.hasProxy(e)}registerMediator(e){this.view.registerMediator(e)}retrieveMediator(e){return this.view?this.view.retrieveMediator(e):null}removeMediator(e){this.view&&this.view.removeMediator(e)}hasMediator(e){return this.view.hasMediator(e)}registerService(e){this.serviceContainer.registerService(e)}retrieveService(e){return this.serviceContainer?this.serviceContainer.retrieveService(e):null}removeService(e){this.model&&this.serviceContainer.removeService(e)}hasService(e){return this.serviceContainer.hasService(e)}registerGlobalServices(e){for(const t in e)this.registerService(e[t])}sendNotification(e,t,r){let i;i="string"==typeof t?new Jr(e,{},t):new Jr(e,t,r),this.notifyObservers(i)}notifyObservers(e){null!=this.view&&this.view.notifyObservers(e)}registerCommands(e){if(e)for(const t in e)e[t]&&this.registerCommand(t,e[t])}initializeServiceContainer(){this.serviceContainer=Wr.getInstance(this.multiCoreKey)}initializeController(){this.controller=Yr.getInstance(this.multiCoreKey)}initializeModel(){this.model=Xr.getInstance(this.multiCoreKey)}initializeView(){this.view=jr.getInstance(this.multiCoreKey)}initializeFacade(){if(this.initialized)throw new Error("Unexpected Condition: Facade already initialized");this.initializeModel(),this.initializeController(),this.initializeView(),this.initializeServiceContainer(),this.initialized=!0}},ei=Zr;ei.facadeMap={};var ti=class{constructor(e){this.pName=e}get name(){return this.pName}destroy(){}onRegister(e){this.facadeKey=e}getLogger(){return this.getService("Logging").logger}getService(e){return ei.getInstance(this.facadeKey).retrieveService(e)}getModel(e){return this.getModelCollection().getModel(e)}getModelCollection(){var e;return null==(e=ei.getInstance(this.facadeKey))?void 0:e.retrieveProxy("ModelCollectionProxy")}},ri=class extends ti{constructor(){super("AutoplayCapabilities"),this.testDom=null,this.checkCompleted=!1,this.testVideoSrc=ue.blankDataUrl,this.isMobile=null,this.info={supportsUnmutedAutoplay:null,supportsMutedAutoplay:null},Fe.supportsUnrestrictedAutoplay&&(this.setInfo(!0,!0),this.checkCompleted=!0)}static getInstance(){return this.instance||(this.instance=new ri),this.instance}get autoplayInfo(){return this.info}destroy(){clearTimeout(this.timeout),super.destroy()}detectCapabilities(e){return this.detecting?this.detecting:(e&&(this.testVideoSrc=e),this.detecting=new Promise((e=>{this.checkCompleted?e(this.info):(this.createTestDom(),this.internalCallback=()=>e(this.info),this.checkUnmutedAutoplay())})))}finishCheck(e,t){this.setInfo(e,t),this.checkCompleted=!0,this.internalCallback(),this.timeout=setTimeout((()=>this.cleanUp()),100)}setInfo(e,t){this.info.supportsUnmutedAutoplay=e,this.info.supportsMutedAutoplay=t}cleanUp(){this.testDom&&this.testDom.parentNode.removeChild(this.testDom),this.testDom=null}checkUnmutedAutoplay(){const e=this.createVideoElement(!1);if(!e)return void this.finishCheck(!0,!0);e.load();const t=e.play();void 0===t?this.isMobile?this.detectMobileCapabilities():this.finishCheck(!0,!0):t.then((()=>{this.finishCheck(!0,!0)})).catch((e=>{this.checkMutedAutoplay()}))}checkMutedAutoplay(){if(this.isEarlySafari11())return void this.finishCheck(!1,!1);const e=this.createVideoElement(!0);e.load(),e.play().then((()=>{this.finishCheck(!1,!0)})).catch((t=>{if(e.error&&this.testVideoSrc!==ue.blankDataUrl)return this.testVideoSrc=ue.blankDataUrl,void this.checkUnmutedAutoplay();this.finishCheck(!1,!1)}))}isEarlySafari11(){const e="Safari"===Fe.browser&&"Desktop"===Fe.device,t=e?Fe.browserVersionInfo.majorVersion:null,r=e?Fe.browserVersionInfo.minorVersion:null,i=11===t&&0===r,n=Fe.browserVersionInfo.versionString,a=n?n.split("."):null;return i&&(!a[2]||parseInt(a[2])<3)}detectMobileCapabilities(){const e=this.isAutoplayEligibleAndroid()||this.isAutoplayEligibleIos();this.finishCheck(!1,e)}isAutoplayEligibleAndroid(){return"Android"===Fe.os&&"Chrome"===Fe.browser&&this.isChromeAutoplayEligible()}isAutoplayEligibleIos(){const e="iOS"===Fe.os&&Fe.browserVersionInfo.majorVersion>=10,t=e&&"Safari"===Fe.browser,r=e&&!t&&("Chrome-iOS"===Fe.browser||"Chrome"===Fe.browser)&&this.isChromeAutoplayEligible();return t||r}isChromeAutoplayEligible(){return Fe.browserVersionInfo.majorVersion>=54}createVideoElement(e){const t=this.document;if(!t)return null;const r=t.createElement("video");return e&&(r.muted=!0,r.setAttribute("muted","muted"),r.setAttribute("playsinline","playsinline")),r.volume=.005,r.style.width="100%",r.style.height="100%",r.src=this.testVideoSrc,this.testDom.appendChild(r),r}createTestDom(){const e=this.document;if(!this.document)return null;const t=e.createElement("div"),r=t.style,i="-1000px";return r.position="absolute",r.top=i,r.left=i,r.width="400px",r.height="225px",e.body.appendChild(t),this.testDom=t,t}get document(){return Fe.document||null}},ii=class{constructor(e={}){this.sessionId=null,this.contentId=null,this.ad={adapter:null,showPrerollOnNonZeroStart:!1,suppressAdUi:!1,viewabilityTracking:{partner:null,viewGuid:null,pageType:null},csai:null,ssai:null},this.location={mediaUrl:null,textTrackUrl:null,thumbnailTrackUrl:null,posterImageUrl:null,drm:{playready:{url:null,header:null,priority:null,audioRobustness:null,videoRobustness:null},widevine:{url:null,header:null,priority:null,audioRobustness:null,videoRobustness:null},fairplay:{appCertUrl:null,licenseUrl:null,header:null},aes:{header:null,provider:null}}},this.playback={id3OwnerIds:null,startTime:NaN,preloadContent:!1,enableAdvancedCodecs:!1,liveEdgeSyncFragmentCount:3,abr:{maxBitrate:NaN,minBitrate:NaN,startBitrate:NaN,capQualityToScreenSize:!0}},this.metadata={},this.tracking={},this.cmcd={enabled:!0,sessionId:null,contentId:null,useHeaders:!1},this.overrides={},Ie(this,e)}static validate(e){if(x(e))throw new Error(ue.messages.RESOURCE_MISSING);const t=[];if(Object.keys(ni).forEach((r=>{r in e||t.push(r)})),t.length)throw new Error(`One or more configuration properties not found: ${t.join(", ")}`)}},ni=new ii,ai=class{constructor(){this.multiCoreKey=null}destroy(){}onRemove(){this.multiCoreKey=null}get facade(){return ei.getInstance(this.multiCoreKey)}sendNotification(e,t,r){const i=this.facade;i&&i.sendNotification(e,t,r)}initializeNotifier(e){this.multiCoreKey=e}},si=class extends ai{constructor(e,t){super(),this.proxyName=null,this.pData=null,this.proxyName=e,this.pData=t||{}}get name(){return this.proxyName}get data(){return this.pData}onRegister(){}onRemove(){this.pData=null,super.onRemove()}},oi=class extends si{constructor(e){super("HookProxy",null),this.aviaHookManager=null,this.pHookManager=null,this.pHookManager=new le(de),this.aviaHookManager=e}onRemove(){var e;null==(e=this.pHookManager)||e.destroy(),this.aviaHookManager=null,this.pHookManager=null,super.onRemove()}hasHook(e){return this.pHookManager.hasHook(e)||this.aviaHookManager.hasHook(e)}registerHook(e,t){this.pHookManager.registerHook(e,t)}removeHook(e,t){this.pHookManager.removeHook(e,t)}applyHook(e,t){return E(this,null,(function*(){var r;const i=yield null==(r=this.aviaHookManager)?void 0:r.applyHook(e,t);return this.pHookManager.applyHook(e,i)}))}applyHookSync(e,t){var r;const i=null==(r=this.aviaHookManager)?void 0:r.applyHookSync(e,t);return this.pHookManager.applyHookSync(e,i)}},li=class extends ti{constructor(e,t){super(e),this.pLogger=t}destroy(){this.pLogger.destroy(),this.pLogger=null}get logger(){return this.pLogger}},di=class extends Y{constructor(e){super(e||{}),this.pAppId=e.id,this.pFacade=ei.createFacade(this.pAppId,e.commandMap||null);const{logger:t}=e;this.pFacade.registerService(new li("Logging",t)),Ce(k).forEach((e=>t.on(e,(e=>this.sendEvent(e.type,e.detail)))))}destroy(){this.mdlCollProxy=null,this.pFacade=null,super.destroy(),ei.removeCore(this.pAppId)}get appId(){return this.pAppId}sendNotification(e,t,r){this.pFacade.sendNotification(e,t,r)}registerGlobalServices(e){const t=this.pFacade;for(const r in e)t.registerService(e[r])}get facade(){return this.pFacade}get modelCollectionProxy(){return this.mdlCollProxy||(this.mdlCollProxy=this.facade.retrieveProxy("ModelCollectionProxy")),this.mdlCollProxy}get appMediator(){return this.pFacade.retrieveMediator("AppMediator")}};function ci(){return function(e,t,r){L(e.apiMethods)||(e.apiMethods={}),e.apiMethods[t]=r.value}}function ui(e=!1){return function(t,r,i){L(t.apiAccessors)||(t.apiAccessors={});const n={get:i.get,set:e?void 0:i.set||void 0};t.apiAccessors[r]=n}}function hi(e,t){for(const r in t.apiMethods)e[r]=function(...e){var i,n;return(null==(n=null==(i=null==t?void 0:t.apiMethods)?void 0:i[r])?void 0:n.apply(t,e))||null};for(const r in t.apiAccessors){const i=t.apiAccessors[r],n={};i.get&&(n.get=()=>t[r]),i.set&&(n.set=e=>{t[r]=e}),Object.defineProperty(e,r,n)}return e}var pi=class extends ai{constructor(){super()}get system(){return Fe}getModel(e){return this.getModelCollection().getModel(e)}getProxy(e){return this.facade?this.facade.retrieveProxy(e):null}getService(e){return this.facade?this.facade.retrieveService(e):null}getModelCollection(){return this.facade?this.facade.retrieveProxy("ModelCollectionProxy"):null}},mi=class extends pi{constructor(){super()}get logger(){return this.facade.logger}log(e,...t){this.logger.log(e,...t)}},gi=class extends mi{execute(e){const t=this.facade.retrieveMediator("PresentationMediator"),r=this.facade.retrieveProxy("ContentPlaybackStateProxy"),i=t.adapter,n=e.body.value;if(r.isAbrSwitchingAvailable)switch(e.name){case"switchBitrate":const e=ze(r.qualityInfo.qualities,n);this.switchToIndex(e,r,i);break;case"switchQualityCategory":r.userQualityCategory=n,this.switchQualityCategory(r,n,i);break;case"autoQualitySwitching":i.setAutoQualitySwitching(n),r.qualitySwitchingMode=this.getAbrMode(n);break;case"minBitrate":i.setMinBitrate(n);break;case"maxBitrate":i.setMaxBitrate(n)}else r.qualitySwitchingMode="unavailable"}switchToIndex(e,t,r){const i=t.minIndex,n=t.maxIndex;ke(e,i,n)?(r.setAutoQualitySwitching(!1),t.qualitySwitchingMode=this.getAbrMode(!1),r.setQuality(t.qualityInfo.qualities[e])):this.logger.log("warn",e>=n?ue.messages.ABR_MANUAL_SWITCHING_REACHED_UPPER_BOUNDS:ue.messages.ABR_MANUAL_SWITCHING_REACHED_LOWER_BOUNDS)}switchQualityCategory(e,t,r){const i=e.qualityInfo.qualities,{minBitrate:n,maxBitrate:a,minIndex:s,maxIndex:o}=function(e,t){let r=1/0,i=0,n=1/0,a=0;return e.forEach((e=>{e.category.indexOf(t)>=0&&(i=Math.max(i,e.index),r=Math.min(r,e.index),a=Math.max(a,e.bitrate),n=Math.min(n,e.bitrate))})),{maxIndex:i,minIndex:r,minBitrate:n,maxBitrate:a}}(i,t);s===o?this.switchToIndex(s,e,r):(r.setMinBitrate(n),r.setMaxBitrate(a))}getAbrMode(e){return e?"auto":"manual"}},Ai=class extends ai{constructor(){super(),this.subCommands=null,this.subCommands=[],this.initializeMacroCommand()}addSubCommand(e){this.subCommands.push(e)}execute(e){let t,r;for(;this.subCommands.length>0;)t=this.subCommands.shift(),r=new t,r.initializeNotifier(this.multiCoreKey),r.execute(e)}},yi=class extends si{constructor(e,t){super(e,{activeState:"inactive",idleDelay:t.idleDelay}),this.mouseDown=!1,this.mouseOver=!1,this.idleEvents=["mousemove","mousedown","keypress","DOMMouseScroll","mousewheel","touchmove","touchstart","MSPointerMove","MSPointerDown","pointermove","pointerdown"],this.container=t.container,this.document=t.document}onRegister(){this.onMouseDown=this.onMouseDown.bind(this),this.onMouseUp=this.onMouseUp.bind(this),this.onMouseEnter=this.onMouseEnter.bind(this),this.onMouseLeave=this.onMouseLeave.bind(this),this.onKeyDown=this.onKeyDown.bind(this),this.reset=this.reset.bind(this),this.idle=this.idle.bind(this),this.container.addEventListener("mouseenter",this.onMouseEnter),this.container.addEventListener("mouseleave",this.onMouseLeave),this.container.addEventListener("mousedown",this.onMouseDown),this.document.addEventListener("mouseup",this.onMouseUp),this.document.addEventListener("keydown",this.onKeyDown)}onRemove(){this.container.removeEventListener("mouseenter",this.onMouseEnter),this.container.removeEventListener("mouseleave",this.onMouseLeave),this.container.removeEventListener("mousedown",this.onMouseDown),this.document.removeEventListener("mouseup",this.onMouseUp),this.document.removeEventListener("keydown",this.onKeyDown),this.stop(),this.container=null,this.document=null,super.onRemove()}applyListeners(e=!0){const t=e?"add":"remove";this.idleEvents.forEach((e=>this.container[`${t}EventListener`](e,this.reset,{passive:!0})))}start(){this.stop(),this.applyListeners(),this.timeout=setTimeout(this.idle,this.idleDelay)}stop(){clearTimeout(this.timeout),this.applyListeners(!1)}idle(){this.activeState=this.mouseOver?"idle":"inactive"}reset(){this.activeState="active",this.start()}onMouseEnter(){this.reset(),this.mouseOver=!0,this.activeState="active",this.start()}onMouseLeave(){this.reset(),this.mouseOver=!1,this.activeState="inactive"}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown&&(this.mouseDown=!1,this.start())}onKeyDown(e){const{key:t,keyCode:r}=e;"Tab"!==t&&9!==r||setTimeout((()=>{const e=this.document.activeElement,t=this.container===e||this.container.contains(e);t&&this.stop(),this.activeState=t?"active":"inactive"}),0)}set activeState(e){this.mouseDown&&(e="active"),e!==this.data.activeState&&(this.data.activeState=e,this.sendNotification("activestatechange",{activeState:e}))}get activeState(){return this.data.activeState}get idleDelay(){return this.data.idleDelay}},fi={position:"absolute",width:"100%",height:"100%",padding:"0",margin:"0",overflow:"hidden"};function vi(){const e=document.createElement("video");return e.style.height="100%",e.style.width="100%",e.style.backgroundColor="#000",e.dataset.elementId=V(),e}function Ti(){const e=Ei("adContainer",fi);return e.dataset.elementId=V(),e}function Ei(e,t){const r=document.createElement("div");return r.setAttribute("data-role",e),Object.assign(r.style,t),r}function bi(){const e=Ei("adClickEl",{display:"none",padding:"4px 8px",fontSize:"12px",background:"#dedede",lineHeight:"14px",color:"#000",position:"absolute",right:"2px",top:"2px",textAlign:"center"});return e.innerHTML="Learn More",e}var ki=class extends mi{execute(e){const t=e.body.playerOptions.container,r=this.system,i=this.getModel("PlayerOptions");if(r.isWebMaf||!r.global||!r.document||!t)return;const n="string"==typeof t?r.document.querySelector(t):t;let a=[];i.useNativeControls&&(a=["ccContainer"]);const s=function(e,t,r){const i={main:e,video:null},n=e,a=n.style;a.position=a.position||"relative",a.padding=a.padding||"0",a.margin=a.margin||"0",a.width=a.width||"100%",a.height=a.height||"100%",a.backgroundColor=a.backgroundColor||"#000",a.overflow=a.overflow||"hidden",n.classList.add("avia-container");const s=document.createElement("style");n.parentElement.insertAdjacentElement("beforebegin",s),s.innerText=":root{--avia-timed-text-offset: 60px;}.avia-container.avia-cc-offset video::-webkit-media-text-track-container{bottom: var(--avia-timed-text-offset);height: auto;}";let o,l=n.hasChildNodes()?n.firstChild:null;if(["adContainer","ccContainer","videoContainer"].forEach((e=>{t.includes(e)||(o="adContainer"===e?Ti():Ei(e,fi),i[e]=o,l?n.insertBefore(o,l):n.appendChild(o),l=o)})),!0===r.reuseVideoElement){const e=vi();i.videoContainer.appendChild(e),i.video=e}return i.adClickEl=bi(),n.appendChild(i.adClickEl),{main:i.main,video:i.video,videoContainer:i.videoContainer,ccContainer:i.ccContainer,adContainer:i.adContainer,adClickEl:i.adClickEl,style:s}}(n,a,i),o=this.facade.retrieveProxy("PlayerDomProxy");o.setModel(s),o.showAdContainer(!1),i.useNativeControls&&o.setVideoAttribute("controls",""),!1!==i.playsInline&&o.setVideoAttribute("playsinline",""),o.setVideoAttribute("data-player-id",this.facade.appId),this.facade.registerProxy(new yi("ActivityProxy",{container:n,document:r.document,idleDelay:i.idleDelay})),this.log("info","Player DOM created.")}},Si="webkitneedkey",Pi=class extends jt{constructor(e,t={}){super(e,t,!0),this.onAddAudioEvent=e=>{this.audioTracks=[],this.audioTrack=null,pt(this.domAudioTracks,((e,t)=>{const{kind:r}=e,i={index:t,id:t.toString(),type:"alternative"===r||"description"===r?"description":"main",codec:"",language:e.language,label:e.label};this.audioTracks.push(i),e.enabled&&(this.audioTrack=i)})),this.delegate.audioTracksChange(this.audioTracks),this.audioTrack&&this.delegate.audioTrackChange(this.audioTrack)},this.onChangeAudioEvent=e=>{const t=Array.from(this.domAudioTracks).find((e=>e.enabled));this.audioTrack=this.audioTracks.find((e=>e.id===t.id)),this.delegate.audioTrackChange(this.audioTrack)},this.onFairPlayError=e=>{this.delegate.error(e)};const{drm:r}=this.context.resource.location;(null==r?void 0:r.fairplay)&&(this.fairplay=new class{constructor(e,t,r,i,n){this.appCertLoaded=!1,this.webKitNeedKeyCalled=!1,this.webkitNeedKeyHandler=e=>this.onWebkitNeedKey(e),this.onError=n,this.drmInfo=t,this.video=e,this.video.addEventListener(Si,this.webkitNeedKeyHandler),this.logger=r,this.delegate=i}initialize(){return E(this,null,(function*(){const e=yield this.delegate.applyHook("request",{url:this.drmInfo.fairplay.appCertUrl,headers:{}}),t=yield dt(Ie({responseType:"arraybuffer"},e));this.appCertData=new Uint8Array(t),this.appCertLoaded=!0,this.webKitNeedKeyCalled&&this.initializeFairplayCDM()}))}destroy(){this.appCertData=null,this.initData=null,this.onError=null,this.drmInfo=null,this.logger=null,this.video.removeEventListener(Si,this.webkitNeedKeyHandler),this.video=null}onWebkitNeedKey(e){this.initData=e.initData,this.webKitNeedKeyCalled=!0,this.appCertLoaded&&this.initializeFairplayCDM()}onLicenseRequestReady(e,t){const r=this.getDrmVendor(e),i=t.target,n={spc:ht(t.message),contentId:i.contentId},a="irdeto"===r||"unknown"===r?"arraybuffer":"text",s={"Content-Type":"application/x-www-form-urlencoded"},{header:o}=this.drmInfo.fairplay;x(o)||Object.assign(s,o),this.delegate.applyHook("request",{url:e,method:"POST",responseType:a,headers:s,data:n}).then((e=>{const t=we(e),r=e.headers["Content-Type"];return"application/x-www-form-urlencoded"===r?t.data="spc="+encodeURIComponent(e.data.spc)+"&"+e.data.contentId:"application/json"===r&&(t.data=JSON.stringify(e.data)),dt(t).then((e=>{const t="string"==typeof e?ut(e):new Uint8Array(e);i.update(t)})).catch((e=>{this.throwFatalError("3301",ue.messages.FAIRPLAY_LICENSE_ERROR)}))}))}onWebkitKeyAdded(e){this.logger.log("info",ue.messages.WEBKIT_KEY_ADDED_SUCCESS)}onWebkitError(e){this.throwFatalError("3301",`${ue.messages.FAIRPLAY_LICENSE_ERROR}`)}initializeFairplayCDM(){const e=this.getLicenseServerUrl(this.initData),t=this.getId(e,this.initData),r=this.video,i=Fe.global,n=ue.messages;if(!t)return void this.throwFatalError("3300",n.FAIRPLAY_NO_CONTENT_ID);if(!r.webkitKeys){const e="com.apple.fps.1_0";if(!i.WebKitMediaKeys.isTypeSupported(e,"video/mp4"))return void this.throwFatalError("3300",n.FAIRPLAY_WEBKIT_ERROR);try{r.webkitSetMediaKeys(new i.WebKitMediaKeys(e))}catch(e){return void this.throwFatalError("3300",e.message)}}const a=this.concatInitDataIdAndCertificate(this.initData,t,this.appCertData),s=r.webkitKeys.createSession("video/mp4",a);s?(s.contentId=t,s.addEventListener("webkitkeymessage",this.onLicenseRequestReady.bind(this,e),!1),s.addEventListener("webkitkeyadded",this.onWebkitKeyAdded.bind(this),!1),s.addEventListener("webkitkeyerror",this.onWebkitError.bind(this),!1)):this.throwFatalError("3300",n.FAIRPLAY_WEBKIT_ERROR)}concatInitDataIdAndCertificate(e,t,r){"string"==typeof t&&(t=yt(t));let i=0;const n=new ArrayBuffer(e.byteLength+4+t.byteLength+4+r.byteLength),a=new DataView(n);new Uint8Array(n,i,e.byteLength).set(e),i+=e.byteLength,a.setUint32(i,t.byteLength,!0),i+=4;const s=new Uint16Array(n,i,t.length);return s.set(t),i+=s.byteLength,a.setUint32(i,r.byteLength,!0),i+=4,new Uint8Array(n,i,r.byteLength).set(r),new Uint8Array(n,0,n.byteLength)}getLicenseServerUrl(e){let t=null;return t=x(this.drmInfo.fairplay.licenseUrl)?"https://"+String.fromCharCode.apply(null,new Uint16Array(e.buffer)).split("://")[1]:this.drmInfo.fairplay.licenseUrl,t}extractContentId(e){return At(e).split("skd://")[1]}getId(e,t){const r=rt.decode(e);return r.ContentId||r.contentId||r.assetId||this.extractContentId(t)}getDrmVendor(e){let t="unknown";return-1!==e.indexOf("irdeto")?t="irdeto":-1!==e.indexOf("drmtoday")&&(t="drmtoday"),t}throwFatalError(e,t){this.logger.log("error",e,t),this.onError({code:e,message:t,fatal:!0})}}(this.video,r,this.logger,this.delegate,this.onFairPlayError),this.fairplay.initialize(),this.delegate.drmKeySystemCreated("com.apple.fps.1_0"));const i=this.domAudioTracks;i&&(this.addAudioDebounced=Gt(this.onAddAudioEvent,100),this.changeAudioDebounced=Gt(this.onChangeAudioEvent,100),i.addEventListener("addtrack",this.addAudioDebounced),i.addEventListener("change",this.changeAudioDebounced))}static get ID(){return dr}static get config(){return{id:Pi.ID,role:["playback"],factory:(e,t={})=>new Pi(e,t),isSupported:e=>{var t;const r=Ze(e.resource);return""!==(null==(t=e.video)?void 0:t.canPlayType(r))}}}get domAudioTracks(){return this.video.audioTracks}getId(){return Pi.ID}destroy(){const e=this.video,t=this.domAudioTracks;return super.destroy().then((()=>{t&&(this.addAudioDebounced.cancel(),this.changeAudioDebounced.cancel(),t.removeEventListener("addtrack",this.addAudioDebounced),t.removeEventListener("change",this.changeAudioDebounced)),this.fairplay&&(this.fairplay.destroy(),this.fairplay=null),e.removeAttribute("src"),e.load()}))}load(){var e;this.suppressErrors=!0,super.load();const{resource:t}=this.context;let r=t.location.mediaUrl;const i=(null==(e=t.overrides)?void 0:e.mimeType)||Je(r),{cmcd:n}=t;n.enabled&&(r=St(r,{ot:"m",sf:(e=>{switch(e){case"application/vnd.apple.mpegurl":case"application/x-mpegURL":return"h";case"application/dash+xml":return"d";default:return"o"}})(i),su:!0,sid:n.sessionId,cid:n.contentId,pr:this.video.playbackRate,v:1})),this.video.src=r;const{system:a}=this.context;return Ae(this.video,"loadedmetadata").then((()=>{a.isIos&&this.video.load();const e=t.playback.startTime;if(Ut(e))return Ae(this.video,"canplaythrough").then((()=>this.seek(e)))})).then((()=>(this.suppressErrors=!1,{manifest:{mimeType:i},fragment:{mimeType:void 0}}))).catch((()=>{throw this.createVideoElementError()}))}setAudioTrack(e){pt(this.domAudioTracks,((t,r)=>{t.enabled=e.index===r})),this.textTrackSurface.forcedLanguage=e.language}setQuality(e){this.logger.log("info",ue.messages.MANUAL_ABR_SWITCHING_UNAVAILABLE)}setAutoQualitySwitching(e){this.logger.log("info",ue.messages.MANUAL_ABR_SWITCHING_UNAVAILABLE)}setMinBitrate(e){this.logger.log("info",ue.messages.MANUAL_ABR_SWITCHING_UNAVAILABLE)}setMaxBitrate(e){this.logger.log("info",ue.messages.MANUAL_ABR_SWITCHING_UNAVAILABLE)}},Ci=class extends si{constructor(e){super("AdapterProxy",e),this.adapterMap={},this.defaultAdapters={playback:Pi.config}}onRemove(){this.adapterMap=null,super.onRemove()}registerAdapter(e){const{id:t}=e;this.adapterMap[t]=e}retrieveAdapter(e){return this.adapterMap[e]}removeAdapter(e){delete this.adapterMap[e]}getAdaptersByRole(e){const t=Ce(this.adapterMap).filter((t=>t.role.includes(e))),r=this.defaultAdapters[e];return r&&t.push(r),t}createContext(e,t){const r=this.facade.retrieveMediator("PluginMediator").createPluginServices(),{dom:i,system:n}=r,a=this.facade.retrieveProxy("ModelCollectionProxy").getModel("PresentationState"),s=this.facade.retrieveProxy("TextTrackProxy"),o=this.facade.retrieveProxy("PerformanceProxy");return Object.assign(r,{resource:e,video:n.isWebMaf?n.webMafPlayer:i.video,container:i.main,autoplay:a.isAutoplay,muted:a.isMuteAtPlayStart,performanceSettings:o,textTrackSettings:s,getDelegate:t})}createAdapter(e,t,r){return E(this,null,(function*(){var i;const n=this.createContext(t,r),a=this.getAdaptersByRole(e),s=(null==(i=n.resource[e])?void 0:i.adapter)||{},{id:o,options:l={}}=s,d=o?a.filter((e=>e.id===o)):a;for(const e of d){const t=Ie({},e.options,l,s[e.id]);if(!o&&!(yield e.isSupported(n,t)))continue;const r=yield e.factory(n,t);if(r)return this.facade.log("info",`${e.id} adapter created`),r}let c=`Could not find adapter for role: ${e}`;throw o&&(c+=`, with id: ${o}`),new se("5000",c)}))}},xi=class extends si{constructor(e,t){super(e,{}),this.pLocalizationData=[],this.pLocale={},this.pLanguage=t,this.registerLocalizationData(xi.LocalizationData)}static load(e){return null==this.pExternalData[e]&&(this.pExternalData[e]=dt({url:e,responseType:"json"})),this.pExternalData[e]}onRemove(){this.pLocale=null,this.pLocalizationData=null,this.pLanguageTag=null,this.pLanguage=null}getApi(){return hi({},this)}get defaultLanguage(){return navigator&&navigator.language?navigator.language:"en"}get language(){return this.pLanguage||this.defaultLanguage}get languageTag(){return this.pLanguageTag}changeLanguage(e=this.defaultLanguage){this.pLanguage=e,this.pLanguageTag=Ct(this.language);const t=new RegExp(`^${this.pLanguageTag.language}`,"i"),r=([e,t])=>xi.load(t).then((t=>[e,t])).catch((r=>(this.facade.log("error",`Could not load locale file ${t}`,r),[e,{}]))),i=this.pLocalizationData.map((e=>{const i=xe(e).filter((e=>t.test(e[0]))).map((e=>"string"==typeof e[1]?r(e):e));return Promise.all(i)}));return Promise.all(i).then((e=>{const t=Ie(...e.map((e=>Me(e))));return this.pLocale=t}))}registerLocalizationData(e){x(e)||this.pLocalizationData.push(e)}localize(e,t){return H(this.lookup(e),t)}lookup(e,t=this.language){const r=t=>(this.pLocale[t]||{})[e];return r(t)||r(this.pLanguageTag.language)||e}},Mi=xi;Mi.pExternalData={},Mi.LocalizationData={en:{"media-player":"Media Player","learn-more":"Learn More"},es:{"media-player":"Reproductor multimedia","learn-more":"Aprende más"}},T([ui(!0)],Mi.prototype,"defaultLanguage",1),T([ui(!0)],Mi.prototype,"language",1),T([ci()],Mi.prototype,"languageTag",1),T([ci()],Mi.prototype,"changeLanguage",1),T([ci()],Mi.prototype,"registerLocalizationData",1),T([ci()],Mi.prototype,"localize",1);var wi=class extends si{constructor(){super(...arguments),this.resettables=["ContentPlaybackState"]}onRemove(){this.resettables=null;const e=this.facade.retrieveProxy("PlayerDomProxy");e&&e.removeDom(),super.onRemove()}get collection(){return this.data}getModel(e){return this.data.getModel(e)}reset(){const e=this.resettables;let t=e.length;for(;t--;)this.getModel(e[t]).reset();const r=this.getModel("PresentationState");r.isAutoplay=!0,r.isCurrentVideoAd=!1,r.started=!1,r.streamDuration=NaN,r.streamTime=NaN}},Ri=class extends ai{constructor(e,t){super(),this.pViewControl=null,this.mediatorName=e,t&&(this.viewControl=t)}get name(){return this.mediatorName}set viewControl(e){this.pViewControl=e}get viewControl(){return this.pViewControl}get system(){return Fe}getService(e){return this.facade?this.facade.retrieveService(e):null}getModel(e){return this.getModelCollection().getModel(e)}getProxy(e){return this.facade?this.facade.retrieveProxy(e):null}getModelCollection(){return this.facade?this.facade.retrieveProxy("ModelCollectionProxy"):null}listNotificationInterests(){return[]}onRegister(){}onRemove(){this.pViewControl=null,super.onRemove()}},Ii=class extends Ri{get logger(){return this.facade.logger}log(e,...t){this.logger.log(e,...t)}},Ni=class extends Ii{constructor(e){super(e),this.timer=new Hr(Ni.INTERVAL),this.timer.on(Hr.TIC_EVENT,(e=>this.onTic(e)))}killTimer(){var e;null==(e=this.timer)||e.stop()}listNotificationInterests(){return["resourcestart"]}handleNotification(e){var t;switch(e.name){case"resourcestart":null==(t=this.timer)||t.start()}}onRegister(){super.onRegister()}onRemove(){this.timer.destroy(),this.timer=null,super.onRemove()}onTic(e){this.facade.sendNotification("timerTic",e.detail,"internal")}},Li=Ni;Li.INTERVAL=100;var _i=class extends si{onRegister(){const e=this.facade.retrieveProxy("ModelCollectionProxy").getModel("PlayerOptions");this.pOverrides=e.overrides,this.pMode="auto"===e.performanceMode?this.calculatePerformanceMode():e.performanceMode}calculatePerformanceMode(){switch(!0){case Fe.isTv:case Fe.isEmbedded:return"tv";case Fe.isMobile:return"mobile";default:return"desktop"}}get mode(){return this.pMode}get forwardBufferLength(){switch(this.pMode){case"mobile":case"tv":return 20;case"low":return 10;default:return}}get backBufferLength(){switch(this.pMode){case"mobile":case"tv":return 30;case"low":return 12;default:return 60}}get topQualityForwardBufferLength(){switch(this.pMode){case"mobile":case"tv":return 60;case"low":return 30;default:return}}get bufferingSampleRate(){var e;const t=null==(e=this.pOverrides)?void 0:e.bufferingSampleRate;if(t)return t;switch(this.pMode){case"tv":case"low":return 300;default:return Li.INTERVAL}}},Oi=class extends si{constructor(){super(...arguments),this.controlVisCssClass="cvui-ctrlbar-vis"}setModel(e){for(const t in e)this.model[t]=e[t]}removeDom(){var e;const t=this.getVideo();t&&(t.player=null,t.avia=null);const r=this.getMain(),i=r.childNodes;let n=i.length;for(;n--;)r.removeChild(i[n]);const a=this.getElement("style");null==(e=null==a?void 0:a.parentElement)||e.removeChild(a)}setControlVisibility(e){const t=this.getMain();if(!t)return;const r=e?"add":"remove";t.classList[r](this.controlVisCssClass)}getElement(e){return this.model[e]||null}getSafeZIndex(){const e=this.getElement("adContainer");return e?Number(e.style.zIndex)+10:10}getVideo(){return this.getElement("video")}getTextTrackContainer(){return this.getElement("ccContainer")}setVideoVolume(e){const t=this.getVideo();t&&this.getVideoVolume()!==e&&(t.volume=e)}getVideoVolume(){const e=this.getVideo();return e?e.volume:null}getMain(){return this.getElement("main")}showAdClickElement(e){const t=this.getElement("adClickEl");if(t){const r=this.facade.retrieveProxy("LocalizationProxy").localize("learn-more");r&&(t.innerHTML=r),t.style.display=!1!==e?"block":"none"}}getDimensions(){const e=this.getPresentationRect();return e?{width:e.width,height:e.height}:null}showContainer(e,t){const r=this.getElement(e);r&&(r.style.display=t?"inline-block":"none")}showAdContainer(e){this.showContainer("adContainer",e)}getPresentationRect(){const e=this.getMain();return e&&e.getBoundingClientRect()||null}muteVideo(e){const t=this.getVideo(),r="muted";t&&(t.muted=e,e&&t.setAttribute(r,r),!e&&t.removeAttribute(r))}primeVideo(e=ue.blankDataUrl){return Promise.resolve().then((()=>{const t=this.getVideo();if(t)return t.src=e,t.load(),t.play().catch((e=>{if(t.error&&t.src!==ue.blankDataUrl)return this.primeVideo(ue.blankDataUrl)}))}))}setVideoAttribute(e,t){const r=this.getVideo();null==r||r.setAttribute(e,t)}removeVideoAttribute(e){const t=this.getVideo();null==t||t.removeAttribute(e)}recreateVideo(){const e=vi(),t=this.getElement("videoContainer"),r=this.getElement("video"),i=this.facade.retrieveProxy("ModelCollectionProxy").getModel("PresentationState");let n;if(r){r.player=null,r.avia=null;const i=["src","data-element-id"];n=r.volume,Array.from(r.attributes).filter((e=>!i.includes(e.name))).forEach((t=>e.setAttribute(t.name,t.value))),t.replaceChild(e,r),this.sendNotification("videoelementremoved",{video:r})}else n=i.volume,t.appendChild(e);i.volume=n,e.volume=n,this.setModel({video:e}),this.recreateAdElements();const a=this.facade.retrieveMediator("AppMediator");e.player=a.getAppApi(),e.avia=Fe.appNamespace,this.sendNotification("videoelementadded",{video:e})}recreateAdElements(){const e=Ti(),t=bi(),r=this.getMain(),i=this.getElement("adContainer"),n=this.getElement("adClickEl");r.replaceChild(e,i),r.replaceChild(t,n),this.setModel({adContainer:e,adClickEl:t})}get model(){return this.data}},Di=class extends si{constructor(e,t={}){super(e,{native:!1!==t.native,mode:"disabled",language:t.language})}set mode(e){this.data.mode=e}get mode(){return this.data.mode}set enabled(e){this.mode=e?this.enabledMode:"disabled"}get enabled(){return"disabled"!==this.data.mode}get enabledMode(){return this.data.native?"showing":"hidden"}get native(){return this.data.native}set language(e){this.data.language=e}get language(){return this.data.language}},Vi=class{constructor(){}static checkType(e,t,r){return"string"==typeof t&&(t=[t]),!(!r||null!==e)||t.some((t=>typeof e===t))}static notEmpty(e){return!x(e)}static isArray(e){return Array.isArray(e)}static validNumber(e,t){return"number"!=typeof e?t:e}static isTypedArray(e,t){if(this.isArray(e)&&this.notEmpty(e)){let r=e.length;for(;r--;)if(typeof e[r]!==t)return!1;return!0}return!1}static isType(e,t){return e instanceof t}static isPositiveNumber(e){return"number"==typeof e&&e>=0}},Ui={content_playback_state_config:{qualities:{type:"object",defaultValue:null},qualityInfo:{type:"object",defaultValue:null},audioTracks:{type:"object",defaultValue:null},textTracks:{type:"object",defaultValue:null},streamType:{type:"string",defaultValue:"VOD"},liveStreamInfo:{type:"object",defaultValue:null},bufferLength:{type:"number",defaultValue:0},cdn:{type:"string",defaultValue:null,validator:Vi.notEmpty},drmType:{type:"string",defaultValue:null,validator:Vi.notEmpty},contentSegment:{type:"number",defaultValue:NaN},maxBandwidth:{type:"number",defaultValue:NaN},time:{type:"number",defaultValue:0},state:{type:"string",defaultValue:"idle"},duration:{type:"number",defaultValue:NaN},bitrate:{type:"number",defaultValue:NaN},started:{type:"boolean",defaultValue:!1},averageDroppedFps:{type:"number",defaultValue:NaN},framerate:{type:"number",defaultValue:NaN}},player_dom_config:{main:{type:"object",defaultValue:null},video:{type:"object",defaultValue:null},videoContainer:{type:"object",defaultValue:null},ccContainer:{type:"object",defaultValue:null},adContainer:{type:"object",defaultValue:null},panelContainer:{type:"object",defaultValue:null},adClickEl:{type:"object",defaultValue:null}},player_options_config:{container:{type:["object","string"],defaultValue:null},plugins:{type:"object",defaultValue:null},autoplay:{type:"string",defaultValue:"none"},id:{type:"string",defaultValue:null},networkErrorRecovery:{type:"object",defaultValue:null},networkTimeout:{type:"number",defaultValue:at.TIMEOUT},performanceMode:{type:"string",defaultValue:"auto"},renderTextTrackNatively:{type:"boolean",defaultValue:!0},useNativeFullscreen:{type:"boolean",defaultValue:!0},playsInline:{type:"boolean",defaultValue:!0},useNativeControls:{type:"boolean",defaultValue:!1},overrides:{type:"object",defaultValue:{}},logLevel:{type:"string",defaultValue:"off"},keyboardScope:{type:"string",defaultValue:"player"},language:{type:"string",defaultValue:null},audioLanguage:{type:"string",defaultValue:null},textLanguage:{type:"string",defaultValue:null},localizationLanguage:{type:"string",defaultValue:null},localization:{type:"object",defaultValue:null},idleDelay:{type:"number",defaultValue:3e3},enableOm:{type:"boolean",defaultValue:!1},enableMoat:{type:"boolean",defaultValue:!1},reuseVideoElement:{type:"boolean",defaultValue:!1}},presentation_state_config:{streamTime:{type:"number",defaultValue:0,setterTransformer:e=>Vi.isPositiveNumber(e)?e:0},streamDuration:{type:"number",defaultValue:NaN,setterTransformer:e=>Vi.isPositiveNumber(e)?e:NaN},isAutoplay:{type:"boolean",defaultValue:!1},isCurrentVideoAd:{type:"boolean",defaultValue:!1},isFullscreen:{type:"boolean",defaultValue:!1},isMuted:{type:"boolean",defaultValue:!1},isMuteAtPlayStart:{type:"boolean",defaultValue:!1},started:{type:"boolean",defaultValue:!1},userHasUnmuted:{type:"boolean",defaultValue:!1},volume:{type:"number",defaultValue:1,setterTransformer:e=>class{constructor(){}static clampValue(e,t,r){return"number"!=typeof e?null:Math.max(t,Math.min(e,r))}static lowerCase(e){return"string"==typeof e?e.toLowerCase():e}static strToNum(e){if("number"==typeof e)return e;if("string"==typeof e){const t=parseFloat(e);return isNaN(t)?e:t}return e}}.clampValue(e,0,1)},usesSsai:{type:"boolean",defaultValue:!1},streamId:{type:"string",defaultValue:null},suspended:{type:"boolean",defaultValue:!1}}},Bi=class{constructor(e){this.pData={},this.defaultValues={},class{constructor(){}static generateModel(e,t,r,i){for(const n in t)this.createProperty(n,t[n],e,r,i)}static createProperty(e,t,r,i,n){const a=t.validator,s=t.type,o=t.defaultValue,l=!1!==t.enumerable,d=this.getTransformer(t,"setter",r),c=this.getTransformer(t,"getter",r);!1===t.writable?(Object.defineProperty(r,e,{enumerable:l,value:o,writable:!1}),i[e]=o):(Object.defineProperty(r,e,{enumerable:l,set:function(t){const r=d(t);!a||a(r)?Vi.checkType(r,s,null==o)?i[e]=r:J.warn(`Invalid type supplied for property ${e}`):J.warn(`Invalid value '${r}' for property ${e}`)},get:function(){return c(i[e])}}),i[e]=o),n[e]=o}static getTransformer(e,t,r){const i=e[t+"Transformer"];return i&&"function"==typeof i?i.bind(r):this.blankTransformer}static blankTransformer(e){return e}}.generateModel(this,e,this.pData,this.defaultValues)}get data(){return Object.assign({},this.pData)}reset(){for(const e in this.defaultValues)this.pData[e]=this.defaultValues[e]}},Fi=class{constructor(e){this.model=new Bi(e)}static get modelName(){return"ContentPlaybackState"}get data(){return this.model.data}reset(){this.model.reset()}set qualities(e){this.model.qualities=e}get qualities(){return this.model.qualities}set qualityInfo(e){this.model.qualityInfo=e}get qualityInfo(){return this.model.qualityInfo}set audioTracks(e){this.model.audioTracks=e}get audioTracks(){return this.model.audioTracks}set textTracks(e){this.model.textTracks=e}get textTracks(){return this.model.textTracks}set streamType(e){this.model.streamType=e}get streamType(){return this.model.streamType}set liveStreamInfo(e){this.model.liveStreamInfo=e}get liveStreamInfo(){return this.model.liveStreamInfo}set bufferLength(e){this.model.bufferLength=e}get bufferLength(){return this.model.bufferLength}set cdn(e){this.model.cdn=e}get cdn(){return this.model.cdn}set drmType(e){this.model.drmType=e}get drmType(){return this.model.drmType}set contentSegment(e){this.model.contentSegment=e}get contentSegment(){return this.model.contentSegment}set maxBandwidth(e){this.model.maxBandwidth=e}get maxBandwidth(){return this.model.maxBandwidth}set time(e){this.model.time=e}get time(){return this.model.time}set state(e){this.model.state=e}get state(){return this.model.state}set duration(e){this.model.duration=e}get duration(){return this.model.duration}set bitrate(e){this.model.bitrate=e}get bitrate(){return this.model.bitrate}set started(e){this.model.started=e}get started(){return this.model.started}set averageDroppedFps(e){this.model.averageDroppedFps=e}get averageDroppedFps(){return this.model.averageDroppedFps}set framerate(e){this.model.framerate=e}get framerate(){return this.model.framerate}},Hi=class{constructor(e){this.model=new Bi(e)}static get modelName(){return"PlayerDom"}get data(){return this.model.data}reset(){this.model.reset()}set main(e){this.model.main=e}get main(){return this.model.main}set video(e){this.model.video=e}get video(){return this.model.video}set videoContainer(e){this.model.videoContainer=e}get videoContainer(){return this.model.videoContainer}set ccContainer(e){this.model.ccContainer=e}get ccContainer(){return this.model.ccContainer}set adContainer(e){this.model.adContainer=e}get adContainer(){return this.model.adContainer}set panelContainer(e){this.model.panelContainer=e}get panelContainer(){return this.model.panelContainer}set adClickEl(e){this.model.adClickEl=e}get adClickEl(){return this.model.adClickEl}set style(e){this.model.style=e}get style(){return this.model.style}},Ki=class{constructor(e){this.model=new Bi(e)}static get modelName(){return"PlayerOptions"}get data(){return this.model.data}reset(){this.model.reset()}set container(e){this.model.container=e}get container(){return this.model.container}set plugins(e){this.model.plugins=e}get plugins(){return this.model.plugins}set autoplay(e){this.model.autoplay=e}get autoplay(){return this.model.autoplay}set id(e){this.model.id=e}get id(){return this.model.id}set networkErrorRecovery(e){this.model.networkErrorRecovery=e}get networkErrorRecovery(){return this.model.networkErrorRecovery}set networkTimeout(e){this.model.networkTimeout=e}get networkTimeout(){return this.model.networkTimeout}set performanceMode(e){this.model.performanceMode=e}get performanceMode(){return this.model.performanceMode}set renderTextTrackNatively(e){this.model.renderTextTrackNatively=e}get renderTextTrackNatively(){return this.model.renderTextTrackNatively}set useNativeFullscreen(e){this.model.useNativeFullscreen=e}get useNativeFullscreen(){return this.model.useNativeFullscreen}set keyboardScope(e){this.model.keyboardScope=e}get keyboardScope(){return this.model.keyboardScope}set playsInline(e){this.model.playsInline=e}get playsInline(){return this.model.playsInline}set useNativeControls(e){this.model.useNativeControls=e}get useNativeControls(){return this.model.useNativeControls}set overrides(e){this.model.overrides=e}get overrides(){return this.model.overrides}set logLevel(e){this.model.logLevel=e}get logLevel(){return this.model.logLevel}set language(e){this.model.language=e}get language(){return this.model.language}set audioLanguage(e){this.model.audioLanguage=e}get audioLanguage(){return this.model.audioLanguage}set textLanguage(e){this.model.textLanguage=e}get textLanguage(){return this.model.textLanguage}set localizationLanguage(e){this.model.localizationLanguage=e}get localizationLanguage(){return this.model.localizationLanguage}set localization(e){this.model.localization=e}get localization(){return this.model.localization}set idleDelay(e){this.model.idleDelay=e}get idleDelay(){return this.model.idleDelay}set enableOm(e){this.model.enableOm=e}get enableOm(){return this.model.enableOm}set enableMoat(e){this.model.enableMoat=e}get enableMoat(){return this.model.enableMoat}set reuseVideoElement(e){this.model.reuseVideoElement=e}get reuseVideoElement(){return this.model.reuseVideoElement}},qi=class{constructor(e){this.model=new Bi(e)}static get modelName(){return"PresentationState"}get data(){return this.model.data}reset(){this.model.reset()}set streamTime(e){this.model.streamTime=e}get streamTime(){return this.model.streamTime}set streamDuration(e){this.model.streamDuration=e}get streamDuration(){return this.model.streamDuration}set isAutoplay(e){this.model.isAutoplay=e}get isAutoplay(){return this.model.isAutoplay}set isCurrentVideoAd(e){this.model.isCurrentVideoAd=e}get isCurrentVideoAd(){return this.model.isCurrentVideoAd}set isFullscreen(e){this.model.isFullscreen=e}get isFullscreen(){return this.model.isFullscreen}set isMuted(e){this.model.isMuted=e}get isMuted(){return this.model.isMuted}set isMuteAtPlayStart(e){this.model.isMuteAtPlayStart=e}get isMuteAtPlayStart(){return this.model.isMuteAtPlayStart}set started(e){this.model.started=e}get started(){return this.model.started}set userHasUnmuted(e){this.model.userHasUnmuted=e}get userHasUnmuted(){return this.model.userHasUnmuted}set volume(e){this.model.volume=e}get volume(){return this.model.volume}set usesSsai(e){this.model.usesSsai=e}get usesSsai(){return this.model.usesSsai}set streamId(e){this.model.streamId=e}get streamId(){return this.model.streamId}set suspended(e){this.model.suspended=e}get suspended(){return this.model.suspended}},Wi=class extends mi{execute(e){const t=this.system,r=new class{constructor(){this.mdlCollection={},this.createModels()}destroy(){for(const e in this.mdlCollection)delete this.mdlCollection[e];this.mdlCollection=null}getModel(e){return this.mdlCollection[e]}get ContentPlaybackState(){return this.mdlCollection.ContentPlaybackState}get PlayerDom(){return this.mdlCollection.PlayerDom}get PlayerOptions(){return this.mdlCollection.PlayerOptions}get PresentationState(){return this.mdlCollection.PresentationState}createModels(){const e=[Fi,Hi,Ki,qi];let t=e.length;for(;t--;){const r=e[t],i=r.modelName,n=Ui[this.classToCfgName(i)];this.mdlCollection[i]=new r(n)}}classToCfgName(e){return e.replace(/(?:^|\.?)([A-Z])/g,(function(e,t){return"_"+t.toLowerCase()})).replace(/^_/,"")+"_config"}},i=new wi("ModelCollectionProxy",r),n=e.body.playerOptions;this.facade.registerProxy(i),this.setPlayerOptions(i,n),this.facade.registerProxy(new _i("PerformanceProxy"));const a=new Mi("LocalizationProxy",n.localizationLanguage);this.facade.registerProxy(a),this.facade.registerProxy(new Di("TextTrackProxy",{native:n.renderTextTrackNatively,language:n.textLanguage})),!t.isWebMaf&&this.createDomProxy(i),this.facade.registerProxy(new Ci),this.log("debug","Model prepared")}setPlayerOptions(e,t){const r=e.getModel("PlayerOptions");for(const e in t)!R(r[e])&&(r[e]=t[e])}createDomProxy(e){const t=e.getModel("PlayerDom"),r=new Oi("PlayerDomProxy",t);this.facade.registerProxy(r)}},zi=class extends Ii{constructor(){super(...arguments),this.plugins={},this.pendingLoads=null,this.services=null}onRemove(){Object.keys(this.plugins).forEach((e=>{try{this.killPlugin(e)}catch(t){this.logger.warn(`Error destroying plugin: ${e}`,t)}})),this.plugins=null,this.pendingLoads=null,this.services=null,super.onRemove()}removePlugin(e){this.killPlugin(e)}getPlugin(e){return this.plugins[e]||null}loadPlugin(e){return this.createPlugin(e)}listNotificationInterests(){return["loadPlugins","adbreakstart","contentstart","removePlugin"]}handleNotification(e){switch(e.name){case"loadPlugins":this.loadPlugins(e.body);break;case"removePlugin":this.removePlugin(e.body.name);break;case"adbreakstart":case"contentstart":this.loadPendingPlugins()}}createPluginServices(){const e=this.facade.retrieveMediator("AppMediator");return new class{constructor(e){this.event={dispatchPluginEvent:e=>{this.dispatch(e)}},this.util={queryStrFromObj:(e,t)=>rt.encode(e)},this.playerApi=null,this.sys=null,this.bi=null,this.domProxy=null,this.playerOpts=null,this.loc=null,this.log=null,this.playerApi=e.player,this.sys=e.system,this.bi=e.buildInfo,this.domProxy=e.domProxy,this.playerOpts=e.playerOptions,this.loc=e.localization,this.dispatch=e.dispatch,this.log=e.logger}get player(){return this.playerApi}get logger(){return this.log}get system(){return this.sys}get appNamespace(){return this.sys.appNamespace}get avia(){return this.sys.appNamespace}get playerOptions(){return this.playerOpts}get buildInfo(){return this.bi}get localization(){return this.loc}get dom(){var e,t,r,i,n,a;const s=()=>{var e;return null==(e=this.domProxy)?void 0:e.getVideo()};return{main:null==(e=this.domProxy)?void 0:e.getMain(),get video(){return s()},videoContainer:null==(t=this.domProxy)?void 0:t.getElement("videoContainer"),ccContainer:null==(r=this.domProxy)?void 0:r.getElement("ccContainer"),adContainer:null==(i=this.domProxy)?void 0:i.getElement("adContainer"),adClickEl:null==(n=this.domProxy)?void 0:n.getElement("adClickEl"),style:null==(a=this.domProxy)?void 0:a.getElement("style")}}}({player:e.getAppApi(),buildInfo:Yt,system:this.system,domProxy:this.facade.retrieveProxy("PlayerDomProxy"),localization:this.facade.retrieveProxy("LocalizationProxy").getApi(),playerOptions:this.playerOptions,dispatch:t=>{e.dispatchPluginEvent(t)},logger:this.logger})}get playerOptions(){return this.getModel("PlayerOptions").data}initPluginServices(){this.services||(this.services=this.createPluginServices())}createPlugins(e,t){return Promise.all(e.map((e=>this.createPlugin(e)))).then((()=>null==t?void 0:t()))}createPlugin(e){return E(this,null,(function*(){var t;const{factory:r,options:i}=e;if(!M(r))throw new Error("Invalid plugin factory");const n=yield r(this.services,i);if(!n)return;const a=null==(t=n.getId)?void 0:t.call(n);if(!a)throw new Error("Invalid plugin ID");return this.plugins[a]=n,this.log("info",`Created plugin '${a}'`),n}))}killPlugin(e){const t=this.plugins[e];t&&(M(t.destroy)&&t.destroy(),delete this.plugins[e])}loadPendingPlugins(){this.pendingLoads&&(this.createPlugins(this.pendingLoads),this.pendingLoads=null)}loadPlugins(e){const t=e.plugins||this.playerOptions.plugins,r=!this.getModel("PresentationState").started,i=e.callback;if(!(null==t?void 0:t.length))return void(null==i||i());this.initPluginServices();const n=t.filter((e=>"low"===e.priority)),a=t.filter((e=>"low"!==e.priority));r&&(this.pendingLoads=n);const s=r?a:n.concat(a);this.createPlugins(s,i)}},Gi=class extends mi{execute(e){this.facade.registerMediator(new zi("PluginMediator")),this.log("debug","Plugins Prepared")}},ji=class extends mi{execute(e){this.facade.registerMediator(new Li("TimerMediator")),this.log("debug","Timer mediator registered")}},$i=[{action:"enterFullScreen",primaryKey:"f",keyCode:70},{action:"increaseVolume",primaryKey:"ArrowUp",keyCode:38},{action:"increaseVolume",primaryKey:null,keyCode:175},{action:"increaseVolume",primaryKey:null,keyCode:183},{action:"decreaseVolume",primaryKey:"ArrowDown",keyCode:40},{action:"decreaseVolume",primaryKey:null,keyCode:174},{action:"decreaseVolume",primaryKey:null,keyCode:182},{action:"seekBack",primaryKey:"ArrowLeft",keyCode:37},{action:"seekForward",primaryKey:"ArrowRight",keyCode:39},{action:"togglePlay",primaryKey:" ",keyCode:32},{action:"togglePlay",primaryKey:null,keyCode:179},{action:"toggleMute",primaryKey:"m",keyCode:77},{action:"toggleMute",primaryKey:"-",keyCode:109},{action:"toggleMute",primaryKey:null,keyCode:173},{action:"toggleTextTrack",primaryKey:"c",keyCode:67},{action:"stop",primaryKey:null,keyCode:178},{action:"playListNext",primaryKey:null,keyCode:176},{action:"playListPrev",primaryKey:null,keyCode:177}],Yi=class extends Ii{constructor(){super(...arguments),this.defs=[],this.scope=null,this.keyDownHandler=null,this._disabled=!1}onRemove(){this.scope=null,super.onRemove()}get disabled(){return"none"===this.scope||this._disabled}getEventTarget(){switch(this.scope){case"player":return this.getPlayerContainer();case"document":return window.document;default:return null}}setScope(e){null===this.scope&&(this.scope=e,this.activateScope(!0))}registerCommandDef(e){this.hasScope&&this.defs.push(e)}disable(){this.hasScope&&!this._disabled&&(this.scopeActive&&this.activateScope(!1),this._disabled=!0)}enable(){this.hasScope?(this._disabled=!1,!this.scopeActive&&this.activateScope(!0)):this.logger.warn("Attempted to enable key command mediator that has scope of NONE.")}validatePrimaryKey(e,t){const r=t.key,i=w(r)&&r.toLowerCase(),n=t.keyCode;return!(!r&&!n)&&(e.primaryKey===r||e.primaryKey===i||e.keyCode===n)}getCommand(e,t=!0){let r,i,n=this.defs.length,a=null;for(;n--;)if(i=this.defs[n],this.validatePrimaryKey(i,e)&&(r=!t||this.hasRequiredModifiers(i,e),r)){a=i;break}return a}hasRequiredModifiers(e,t){const r=!!((e.requireCtrl?1:0)^(t.ctrlKey?1:0)),i=!!((e.requireShift?1:0)^(t.shiftKey?1:0)),n=!!((e.requireMeta?1:0)^(t.metaKey?1:0));return!r&&!i&&!n}activateScope(e){if(!this.hasScope||this._disabled)return;const t=this.getEventTarget();t&&t[e?"addEventListener":"removeEventListener"]("keydown",this.keyDownHandler),this.scopeActive=e}getPlayerContainer(){var e;const t=null==(e=this.facade)?void 0:e.retrieveProxy("PlayerDomProxy");return null==t?void 0:t.getMain()}get hasScope(){return"none"!==this.scope}handleNotification(e){}onRegister(){super.onRegister(),this.keyDownHandler=e=>this.hKeyDown(e)}},Qi=class extends Yi{constructor(){super(...arguments),this.vpi=null,this.seekEnabled=!1,this.VOLUME_INCREMENT=.05,this.SEEK_FACTOR_DISCRETE=.05}onRemove(){clearTimeout(this.timeout),this.vpi=null,super.onRemove()}hKeyDown(e){this.processKeyEvent(e)}get player(){if(!this.vpi){const e=this.facade.retrieveMediator("AppMediator");this.vpi=e.getAppApi()}return this.vpi}stopEvent(e){e.stopImmediatePropagation(),e.preventDefault()}processKeyEvent(e){if(e.ctrlKey||e.shiftKey||e.metaKey||"Meta"===e.key||"Shift"===e.key||"Control"===e.key)return null;const t=this.getCommand(e,!1);t&&(this.doAction(t),this.stopEvent(e))}doAction(e){const t=e.action;let r,i,n;switch(t){case"increaseVolume":case"decreaseVolume":n="decreaseVolume"===t?-1:1,r=this.player.volume,i=be(r+this.VOLUME_INCREMENT*n,0,1),this.player.muted&&i>0&&(this.player.muted=!1),this.player.volume=i,this.notify({action:t,value:this.player.volume});break;case"seekBack":case"seekForward":if(!this.seekEnabled)return;const e=this.player.contentDuration;if(n="seekBack"===t?-1:1,r=this.player.contentTime,!e||isNaN(e)||1===n&&"DVR"===this.player.streamType&&this.player.isPlayingLive)return;i=be(r+this.SEEK_FACTOR_DISCRETE*n*e,0,e),this.notify({action:t,position:i,duration:e}),this.player.seek(i);break;case"enterFullScreen":this.player.enterFullscreen();break;case"togglePlay":"LIVE"!==this.player.streamType&&this.player.togglePlayPause();break;case"toggleMute":this.player.muted=!this.player.muted,this.notify({action:t,muted:this.player.muted});break;case"toggleTextTrack":this.player.textTrackEnabled=!this.player.textTrackEnabled;break;case"playListNext":case"playListPrev":n="playListPrev"===t?-1:1,this.notify({action:t});break;case"stop":"LIVE"===this.player.streamType?this.player.stop():this.player.pause()}}notify(e){this.sendNotification("hotkeyaction",e,"internal")}handleNotification(e){switch(e.name){case"adbreakstart":this.seekEnabled=!1;break;case"contentcomplete":this.seekEnabled=!1,this.disable();break;case"contentstart":case"contentsegmentstart":this.seekEnabled="LIVE"!==this.player.streamType}}listNotificationInterests(){const e=ar;return[e.AD_BREAK_START,e.CONTENT_START,e.CONTENT_SEGMENT_START,e.CONTENT_COMPLETE]}onRegister(){super.onRegister(),this.enable(),$i.forEach((e=>this.registerCommandDef(e)))}},Xi=class extends Ii{constructor(e,t){super(e),this.app=t}primeVideoElement(){var e;const t=this.facade.retrieveProxy("PlayerDomProxy"),r=this.getModel("PlayerOptions");return t.primeVideo(null==(e=r.overrides)?void 0:e.blankVideoUrl)}offsetTimedText(e){this.facade.retrieveMediator("PresentationMediator").offsetTimedText(e)}setFullscreenElement(e){this.facade.retrieveMediator("FullscreenMediator").fullscreenElement=e}getFullscreenElement(){return this.facade.retrieveMediator("FullscreenMediator").fullscreenElement}getSessionTime(){const e=this.facade.retrieveMediator("PresentationMediator");return(null==e?void 0:e.getSessionTime())||null}onRemove(){this.app=null,super.onRemove()}getAppApi(){return this.app.getApi()}getConfigAsJson(e=2){const t=this.getProxy("ModelCollectionProxy").getModel("PlayerOptions").data;return JSON.stringify({resource:this.getCurrentResource(),playerOptions:t,buildInfo:Yt},((e,t)=>t instanceof HTMLElement?void 0:t),e)}validateSeek(e,t){if(isNaN(e))return this.log("warn",`Invalid seek() time [${e}] supplied`),null;const r=this.getModel("PresentationState"),i=this.getProxy("ContentPlaybackStateProxy"),n=i&&"LIVE"===i.model.streamType;return!r||!i||r.isCurrentVideoAd||n?(this.log("warn","seek() may not be called in the current context"),null):be(e,0,t)}isPlaybackSuspended(){return this.getModel("PresentationState").suspended}getContainerRect(){const e=this.getProxy("PlayerDomProxy");return e?e.getPresentationRect():null}getCurrentResource(){const e=this.getProxy("ResourceProxy");return(null==e?void 0:e.resource)||null}killCurrentResource(){const e=this.getProxy("ResourceProxy");if(!e)return Promise.resolve();const t=e.resource,r=this.getProxy("ContentPlaybackStateProxy"),i="LIVE"===r.model.streamType||"DVR"===r.model.streamType,n=this.facade.retrieveMediator("PresentationMediator");return this.log("info","Killing current resource"),n?n.close().then((()=>{i&&this.sendNotification("livepresentationstopped",{resource:t})})).catch((e=>{J.error(e)})):Promise.resolve()}skipAd(){this.facade.retrieveMediator("PresentationMediator").skipAd()}getPlugin(e){const t=this.facade.retrieveMediator("PluginMediator");return t?t.getPlugin(e):null}dispatchPluginEvent(e){this.app.sendEvent("pluginevent",e)}getMuteState(){const e=this.getModel("PresentationState");return e?e.isMuted:null}getVolume(){const e=this.getModel("PresentationState");return e?e.volume:NaN}getDimensions(){const e=this.getProxy("PlayerDomProxy");return e?e.getDimensions():null}getAdBreakTimes(){const e=this.facade.retrieveMediator("PresentationMediator");return e?e.getAdBreakTimes():null}grabFrame(){const e=this.getProxy("PlayerDomProxy"),t=null==e?void 0:e.getVideo();if(!t)return null;const r=document.createElement("canvas"),i=r.getContext("2d"),n=r.width=t.videoWidth,a=r.height=t.videoHeight;i.drawImage(t,0,0,n,a);const s=r.toDataURL(),o=document.createElement("img");return o.setAttribute("src",s),o}getKeyEventTarget(){return this.facade.retrieveMediator("KeyCommandMediator").getEventTarget()}disableKeyCommands(e=!0){var t;const r=null==(t=this.facade)?void 0:t.retrieveMediator("KeyCommandMediator");e?null==r||r.disable():null==r||r.enable()}listNotificationInterests(){return Ce(ar)}sendErrorEvent(e,t){this.app.sendEvent(e,t)}handleNotification(e){this.app.sendEvent(e.name,e.body)}onRegister(){super.onRegister()}},Ji=v(b(),1),Zi=class extends Ii{constructor(e,t){super(e,t),this.isFullscreen=!1,this.fsElement=null,this.enabled=!1,this.pIsAndroidFirefox=null,this.fsApiSupported=!0,this.fsMgr=null,this.useCustomFullscreen=!0,this.metadataLoadedDelayHandle=null,this.iosPropNames={ENTER_EVENT:"webkitbeginfullscreen",EXIT_EVENT:"webkitendfullscreen",ENTER_METHOD:"webkitEnterFullscreen",EXIT_METHOD:"webkitExitFullscreen",SUPPORTED:"webkitSupportsFullscreen"},this.fsMgr=Ji.default,this.changeHandler=e=>this.hChange(e)}set fullscreenElement(e){if(!(e instanceof HTMLElement))return;const t=this.system;t.isIos||t.isAndroid||(this.fsElement=e)}get fullscreenElement(){return this.fsElement}onRemove(){clearTimeout(this.metadataLoadedDelayHandle),!this.fsApiSupported&&this.fsElement&&(this.fsElement.removeEventListener(this.iosPropNames.ENTER_EVENT,this.changeHandler),this.fsElement.removeEventListener(this.iosPropNames.EXIT_EVENT,this.changeHandler)),this.fsMgr&&M(this.fsMgr.off)&&this.fsMgr.off("change",this.changeHandler),this.fsElement=null,this.fsMgr=null,super.onRemove()}enter(){if(this.enabled)return this.useCustomFullscreen?(this.isFullscreen=!0,void this.sendFullscreenNotification()):void(this.fsApiSupported?this.fsMgr.request(this.fsElement):this.enterFsIos())}exit(){if(this.enabled)return this.useCustomFullscreen?(this.isFullscreen=!1,void this.sendFullscreenNotification()):void(this.fsApiSupported?this.fsMgr.exit():this.exitFsIos())}isFullScreenPermitted(){return this.enabled}isFullScreen(){return this.isFullscreen}get isAndroidFirefox(){if(null==this.pIsAndroidFirefox){const e=this.system;this.pIsAndroidFirefox="Android"===e.os&&"Firefox"===e.browser}return this.pIsAndroidFirefox}handleNotification(e){const t=e.name;"videoelementadded"!==t?"streammetadata"!==t?this.enabled&&("enterFullscreenRequest"===t?this.enter():this.exit()):this.metadataLoadedDelayHandle=setTimeout((()=>this.handleMetadataLoaded()),20):this.onRegister()}listNotificationInterests(){return["videoelementadded","streammetadata","enterFullscreenRequest","exitFullscreenRequest"]}handleMetadataLoaded(){this.enabled=this.enabled||this.webkitIosEnabled(),this.enabled&&this.sendNotification("fullscreenAvailable",null)}hChange(e){this.isFullscreen=this.fsApiSupported?Ji.default.isFullscreen:this.checkWebkitIosState(e),this.isAndroidFirefox&&(this.isFullscreen&&this.fsElement.setAttribute("controls",""),!this.isFullscreen&&this.fsElement.removeAttribute("controls")),this.sendFullscreenNotification()}sendFullscreenNotification(){this.sendNotification("fullscreenChange",{isFullscreen:this.isFullscreen},"internal")}enterFsIos(){this.fsElement[this.iosPropNames.ENTER_METHOD]()}exitFsIos(){this.fsElement[this.iosPropNames.EXIT_METHOD]()}webkitIosEnabled(){return this.system.isIos&&this.fsElement[this.iosPropNames.SUPPORTED]}checkWebkitIosState(e){return e.type===this.iosPropNames.ENTER_EVENT}onRegister(){if(this.useCustomFullscreen=!this.getModel("PlayerOptions").useNativeFullscreen,this.useCustomFullscreen)return void(this.enabled=!0);const e=this.facade.retrieveProxy("PlayerDomProxy");this.fsMgr.isEnabled?this.fsElement=e.getMain():(this.fsApiSupported=!1,this.fsElement=e.getVideo()),this.fsApiSupported&&this.fsElement&&this.fsMgr.isEnabled?(this.enabled=!0,this.fsMgr.on("change",this.changeHandler)):this.fsElement&&!this.fsApiSupported&&(this.fsElement.addEventListener(this.iosPropNames.ENTER_EVENT,this.changeHandler),this.fsElement.addEventListener(this.iosPropNames.EXIT_EVENT,this.changeHandler))}},en=class extends mi{execute(e){const t=this.facade,r=e.body.app;t.registerMediator(new Xi("AppMediator",r));const i=this.system;if(!i.global||i.isWebMaf)return void this.log("info","Skipping view creation");i.isTv||t.registerMediator(new Zi("FullscreenMediator"));const n=new Qi("KeyCommandMediator");t.registerMediator(n),n.setScope(this.getScope(i,e.body.playerOptions)),this.log("debug","View prepared")}getScope(e,t){return!e.document||e.isTv||e.isWebMaf?"none":t.keyboardScope||"player"}},tn=class extends mi{execute(e){if(!this.facade.retrieveMediator("AppMediator"))return;const t=e.name,r=e.body,i=r.error||r;this.setDetails(t,i),i.fatal?this.logger.error(i.message):this.logger.warn(i.message),this.sendNotification("error",{error:i})}setDetails(e,t){let r=null,i=null;switch(e){case"resourceerror":r="Resource";break;case"videostarterror":r="Video start";break;case"videoplaybackerror":r="Playback";break;case"aderror":r="Ad";break;case"adstalled":r="Ad",i="Stalled ad detected"}i&&(t.message=i),r&&(t.category=r)}};function rn(e){return`${e.id}:${e.name}`}var nn=class extends mi{execute(e){var t;const r=this.facade.retrieveMediator("PresentationMediator"),i=this.facade.retrieveProxy("ResourceProxy"),n=null==i?void 0:i.resource,a=null==(t=this.contentPlaybackStateProxy)?void 0:t.model;if(a&&n)switch(e.name){case"play":const t=!!r,i=t&&this.getModel("PresentationState").started;t&&"external"===e.type&&!i?this.invokePlayOnUserGesture(r):i&&(null==r||r.play());break;case"pause":null==r||r.pause();break;case"seek":const n=a.liveStreamInfo;let s=e.body.value;if(!this.isVod()&&n){const t=Math.max(e.body.value,n.liveEdgeOffset);s=Math.min(t,n.relativeDuration-n.liveEdgeOffset)}r.seek(s);break;case"switchAudioTrack":r.adapter.setAudioTrack(e.body.value);break;case"switchTextTrack":const o=e.body.value;if(o){this.facade.retrieveProxy("TextTrackProxy").language=o.language;const e=this.contentPlaybackStateProxy.getTextTrackById(o.id);r.adapter.setTextTrack(e)}break;case"switchTextMode":const l=e.body.value,d=this.facade.retrieveProxy("TextTrackProxy");d.enabled=l,(null==r?void 0:r.adapter)&&r.adapter.setTextTrackMode(d.mode);break;case"mutechange":r.mute(e.body.muted);break;case"volumechange":const c=e.body.volume;!isNaN(c)&&r.setVolume(c)}else this.log("debug","play() can not be invoked in this context.")}get contentPlaybackStateProxy(){return this.facade.retrieveProxy("ContentPlaybackStateProxy")}isVod(){const e=this.contentPlaybackStateProxy.model.streamType;return"LIVE"!==e&&"DVR"!==e}shouldSkipPriming(){const e=this.facade.retrieveProxy("PlayerDomProxy"),t=this.getModel("PlayerOptions").overrides,r=this.system;return!e||r.supportsUnrestrictedAutoplay||!0===(null==t?void 0:t.skipPriming)}invokePlayOnUserGesture(e){const t=this.facade.retrieveProxy("PlayerDomProxy"),r=this.getModel("PlayerOptions").overrides,i=this.system;e.beforePlayOnUserGesture(),this.shouldSkipPriming()?e&&e.playOnUserGesture():t.primeVideo(null==r?void 0:r.blankVideoUrl).then((()=>{if("iPhone"===i.device){const r="timeupdate",i=t.getVideo(),n=t=>{i.removeEventListener(r,n),setTimeout((()=>e.playOnUserGesture()),200)};i.addEventListener(r,n)}else e.playOnUserGesture()})).catch((e=>{this.log("error",`ERROR - PlaybackCommand: Priming FAILED.  ${e.message}`),this.facade.sendNotification("autoplayblocked",e,"internal")}))}},an=class extends si{constructor(){super(...arguments),this.isReady=!1,this.pUserQualityCategory=null}onRegister(){super.onRegister();const e=this.facade.retrieveProxy("ModelCollectionProxy");this.contentPlaybackState=e.getModel(Fi.modelName),this.contentPlaybackState.qualityInfo={mode:"auto",quality:null,qualities:[]},this.contentPlaybackState.textTracks={track:null,tracks:[]},this.contentPlaybackState.audioTracks={track:null,tracks:[]},this.isReady=!0}onRemove(){this.contentPlaybackState=null,this.thumbnailTrack=null,super.onRemove()}processQualityProfile(e){e=Re(e.map((e=>function(e){const t=[`${String((r=e.height,r>=He?"UHD 8K":r>=Ke?"UHD 4K":r>=qe?"UHD":r>=We?"HD":"SD"))}`,`${e.height}p`,`${Math.round(e.bitrate/1e3)} kbps`];var r;return y(A({},e),{category:t})}(e)))),this.contentPlaybackState.qualities=e,this.contentPlaybackState.qualityInfo.qualities=e.filter((e=>e.enabled)),"manual"!==this.qualitySwitchingMode&&(this.qualitySwitchingMode=e.length?"auto":"unavailable")}addTextTracks(e){this.contentPlaybackState.textTracks.tracks=e}getTextTrackById(e){return this.contentPlaybackState.textTracks.tracks.find((t=>t.id===e))}getThumbnail(e){var t;return null==(t=this.thumbnailTrack)?void 0:t.getCueAt(e)}get textTrackInfo(){return this.contentPlaybackState.textTracks}set textTrack(e){this.contentPlaybackState.textTracks.track=e}get textTrack(){return this.contentPlaybackState.textTracks.track}get isAbrSwitchingAvailable(){return!!this.qualities&&this.qualities.length>1}set userQualityCategory(e){this.pUserQualityCategory=e}get userQualityCategory(){return this.pUserQualityCategory}set qualitySwitchingMode(e){this.contentPlaybackState.qualityInfo.mode=e}get qualitySwitchingMode(){return this.contentPlaybackState.qualityInfo.mode}set qualities(e){this.contentPlaybackState.qualities=e}get qualities(){return this.contentPlaybackState.qualities}set maxBandwidth(e){this.contentPlaybackState.maxBandwidth=isNaN(this.contentPlaybackState.maxBandwidth)?e:Math.max(e,this.contentPlaybackState.maxBandwidth)}get model(){return this.contentPlaybackState}get minIndex(){return 0}get maxIndex(){const e=this.contentPlaybackState.qualityInfo.qualities;return(null==e?void 0:e.length)?this.contentPlaybackState.qualityInfo.qualities.length-1:0}get minBitrate(){return this.contentPlaybackState.qualityInfo.qualities[this.minIndex].bitrate}get maxBitrate(){return this.contentPlaybackState.qualityInfo.qualities[this.maxIndex].bitrate}get qualityInfo(){return this.contentPlaybackState.qualityInfo}set quality(e){this.contentPlaybackState.qualityInfo.quality=e}get audioTrackInfo(){return this.contentPlaybackState.audioTracks}},sn=class extends si{mock(e){this.pResource=e}onRemove(){this.pResource=null,super.onRemove()}onRegister(){super.onRegister(),this.pResource=this.data}get resource(){return this.pResource}get location(){return this.pResource.location}get playback(){return this.pResource.playback}get metadata(){return this.pResource.metadata}get ad(){return this.pResource.ad}get adTrackingSettings(){return this.pResource.ad.viewabilityTracking}get hasValidMediaUrl(){return!x(this.location.mediaUrl)}},on=class extends Ii{constructor(){super(...arguments),this.loaded=!1,this.startedPlaying=!1,this.preloadContent=!0,this.minDvrDuration=1800,this.adapterTask=Promise.resolve(),this.seeking_=!1,this.paused_=!1,this.previousPlaybackState={state:null,overrides:{},buffer:NaN},this.contentIsBuffering=!1,this.endFreezeTimeoutHandle=null,this.timedTextOffset=0,this.isMonitoringCueEvents=!1,this.shouldSendTextTrackAvailable=!1,this.onLoadError=e=>{const{message:t,cause:r}=e;this.sendErrorNotification(t,r||e)},this.qualityChange=e=>{var t,r;if(!e)return void this.logger.warn("Invalid quality change");const{contentPlaybackStateProxy:i}=this;(null==(t=i.qualities)?void 0:t.length)?(e=i.qualities.find((t=>t.index===e.index)),(null==(r=i.qualityInfo.quality)?void 0:r.bitrate)!==e.bitrate&&(i.quality=e,i.model.bitrate=e.bitrate,this.respondToQualityChange(e))):this.logger.warn("Invalid qualities list. Make sure qualitiesChange is called before qualityChange")},this.qualitiesChange=e=>{const{contentPlaybackStateProxy:t}=this,{model:r}=t,i=JSON.stringify(r.qualities||[]);this.contentPlaybackStateProxy.processQualityProfile(e),t.isAbrSwitchingAvailable||this.logger.log("info",ue.messages.ABR_UNAVAILABLE),r.qualityInfo&&JSON.stringify(r.qualities)!==i&&(this.log("info","Quality Info: ",r.qualityInfo),this.notify("qualitieschange",{qualities:r.qualities}),this.notify("qualityinfochange",{qualityInfo:r.qualityInfo}))},this.error=e=>{e.fatal&&(this.adapterTask=Promise.resolve()),this.respondToError(e)},this.audioTrackChange=e=>{e=we(e,!0),this.contentPlaybackStateProxy.audioTrackInfo.track=e,this.notify("audiotrackchange",{audioTrack:e})},this.audioTracksChange=e=>{e=we(e,!0),this.contentPlaybackStateProxy.audioTrackInfo.tracks=e,this.notify("audiotrackschange",{audioTracks:this.contentPlaybackStateProxy.audioTrackInfo.tracks}),this.notify("audiotrackinfochange",{audioTrackInfo:this.contentPlaybackStateProxy.audioTrackInfo})},this.cdnChange=e=>{const{contentPlaybackStateProxy:t}=this;e!==t.model.cdn&&(t.model.cdn=e,this.notify("cdnchange",{cdn:e}))},this.drmKeySystemCreated=e=>{this.contentPlaybackStateProxy.model.drmType=e,this.notify("drmkeysystemcreated",{keysystem:e})},this.timeUpdate=()=>{clearTimeout(this.endFreezeTimeoutHandle);const e=this.pAdapter.getCurrentTime(),t=this.presoModel.streamDuration;this.updateLiveStreamInfo(),!this.pAdapter.getIsLiveStream()&&!isNaN(t)&&t-e<=.15&&this.protectAgainstEndFreeze(250),this.respondToVideoTimeUpdate(e)},this.playing=()=>{this.paused_=!1,this.updateLiveStreamInfo(),this.respondToVideoPlaying()},this.paused=()=>{this.paused_=!0,this.respondToVideoPaused()},this.seeking=()=>{this.seeking_||(this.seeking_=!0,this.respondToVideoSeeking(),this.respondToWaiting("seeking",!0))},this.seeked=()=>{this.seeking_=!1,this.respondToVideoSeeked(),this.respondToWaiting("seeking",!1)},this.ended=()=>{clearTimeout(this.endFreezeTimeoutHandle),this.respondToVideoEnd()},this.durationChange=()=>{const e=this.pAdapter.getDuration();e>0&&this.respondToDurationChange(e)},this.volumeChange=(e,t)=>{e!==this.presoModel.volume&&this.notify("volumechange",{volume:e}),null!=t&&t!==this.presoModel.isMuted&&this.notify("mutechange",{muted:t})},this.metadataCuepoint=e=>{this.respondToId3Data(Rt(e))},this.textCuepoints=(e,t=!1)=>{(this.textTrackProxy.enabled||t)&&(this.isMonitoringCueEvents&&e.forEach((e=>this.respondToTtCue(e))),this.notify("textcuepoint",{activeCues:e,forced:t}))},this.textTrackDisplayModeChange=e=>{const t="disabled"!==e;this.textTrackProxy.mode=e,this.notify("texttrackenabledchange",{textTrackEnabled:t}),this.respondToTextTrackModeChange(t)},this.textTracksChange=e=>{e=we(e,!0),this.contentPlaybackStateProxy.addTextTracks(e),this.notify("texttrackschange",{textTracks:e}),this.shouldSendTextTrackAvailable=!0,this.respondToTextTrackInfoChange()},this.textTrackChange=e=>{e=we(e,!0),this.contentPlaybackStateProxy.textTrack=e,this.notify("texttrackchange",{textTrack:e}),this.respondToTextTrackInfoChange()}}get adapter(){return this.pAdapter}get timedTextContainer(){if(!this.timedTextContainer_){const e=this.facade.retrieveProxy("PlayerDomProxy");this.timedTextContainer_=e.getElement("ccContainer")}return this.timedTextContainer_}onRemove(){clearTimeout(this.endFreezeTimeoutHandle),this.pAdapter=null,this.contentPlaybackStateProxy=null,this.resourceProxy=null,this.textTrackProxy=null,this.presoModel=null,this.playerOptions=null,super.onRemove()}setVolume(e){this.presoModel.volume=e}load(){return this.loadVideo().catch((e=>{const t=e.type?e.data||e.detail:null,r=t?t.error||t:e;throw new te("videostarterror",r)}))}play(){return this.playVideo()}pause(){this.pauseVideo()}suspend(){this.pAdapter.suspend()}resume(){this.pAdapter.resume()}offsetTimedText(e){const t=e>0;if(this.timedTextOffset=e,this.playerOptions.renderTextTrackNatively&&"Firefox"===this.system.browser)this.monitorTtCues(t);else if(!1===this.playerOptions.renderTextTrackNatively&&this.timedTextContainer)this.timedTextContainer.style.bottom=`${e}px`;else{const r=this.facade.retrieveProxy("PlayerDomProxy").getMain();null==document||document.documentElement.style.setProperty("--avia-timed-text-offset",`${e}px`),null==r||r.classList[t?"add":"remove"]("avia-cc-offset")}}loadVideo(){return this.pendingLoad?this.pendingLoad:this.loaded?Promise.resolve():(this.respondToWaiting("loading",!0),this.logger.time("resource-load"),this.pendingLoad=this.pAdapter.load().then((e=>{this.loaded=!0,this.respondToWaiting("loading",!1),this.pendingLoad=null;const t=this.resourceProxy.resource;this.notify("streammetadata",{streamMetadata:e});const r=t.location.thumbnailTrackUrl;!this.contentPlaybackStateProxy.thumbnailTrack&&r&&Pr.create(r).then((e=>{this.contentPlaybackStateProxy.thumbnailTrack=e,this.notify("thumbnailtrackavailable",{thumbnailTrack:e})})).catch((e=>this.log("warn","Could not load thumbnail track"))),this.logger.timeEnd("resource-load")})))}playVideo(){return this.logger.time("resource-playback"),this.pAdapter.play().then((()=>{this.startedPlaying=!0,this.logger.timeEnd("resource-playback")})).catch((e=>{0===e.code?this.sendNotification("autoplayblocked",e):this.logger.warn(`Video element play() error: ${e}`)}))}pauseVideo(){var e;null==(e=this.pAdapter)||e.pause()}muteVideo(e){e||this.presoModel.userHasUnmuted||(this.presoModel.userHasUnmuted=!0),this.presoModel.isMuted=e}seekVideo(e){return this.pAdapter.seek(e)}checkVideoBuffering(e){const t=Math.max(Math.floor(this.bufferingSampleRate/Li.INTERVAL),1);if(isFinite(t)&&e%t)return;let r=!1;if(!this.paused_){const e=this.previousPlaybackState.buffer+.001,t=this.video.currentTime;this.previousPlaybackState.buffer=t,r=t<e&&!this.seeking_}this.contentIsBuffering!==r&&(this.contentIsBuffering=r,this.notify("resourcebuffering",{buffering:r}),this.respondToWaiting("buffering",r))}get video(){return this.viewControl}notify(e,t){this.sendNotification(e,t,"internal")}respondToIsPlayingLiveChange(e){this.notify("contentisplayinglive",{isLive:e})}respondToStreamTypeChange(e){if(this.streamType===e)return;const t=this.contentPlaybackStateProxy.model;this.streamType=e,t.streamType=e,this.notify("streamtypechange",{streamType:e})}respondToWaiting(e,t){this.previousPlaybackState.overrides[e]=t;const r=!this.previousPlaybackState.state||Ce(this.previousPlaybackState.overrides).includes(!0);this.respondToPlaybackStateChange(r?"waiting":this.previousPlaybackState.state)}respondToPlaybackStateChange(e){const t=this.contentPlaybackStateProxy.model,r="waiting"!==e;if(t.state!==e){if("idle"!==e&&r&&(this.previousPlaybackState.state=e),this.seeking_&&r)return;t.state=e,this.notify("playbackstatechange",{playbackState:e})}}monitorTtCues(e){const t=Array.from(this.video.textTracks).find((e=>Nt(e.kind)&&"showing"===e.mode)),r=null==t?void 0:t.activeCues;if(this.isMonitoringCueEvents=e,r)for(let e=0,t=r.length||0;e<t;e++)this.respondToTtCue(r[e])}respondToTtCue(e){e.line=this.isMonitoringCueEvents?.21875*this.timedTextOffset:"auto"}handleNotification(e){switch(e.name){case"timerTic":this.respondToBufferingStatusCheck(e.body.count),this.checkSize();break;case"fullscreenChange":const t=e.body;this.presoModel.isFullscreen=t.isFullscreen,this.respondToFullscreenChange(t.isFullscreen);break;case"autoQualitySwitching":const{model:r}=this.contentPlaybackStateProxy;this.notify("qualityinfochange",{qualityInfo:r.qualityInfo})}}listNotificationInterests(){return["timerTic","fullscreenChange"]}onRegister(){super.onRegister(),this.contentPlaybackStateProxy=this.facade.retrieveProxy("ContentPlaybackStateProxy"),this.resourceProxy=this.facade.retrieveProxy("ResourceProxy"),this.performanceProxy=this.facade.retrieveProxy("PerformanceProxy"),this.textTrackProxy=this.facade.retrieveProxy("TextTrackProxy"),this.presoModel=this.getModel("PresentationState"),this.playerOptions=this.getModel("PlayerOptions");const e=this.resourceProxy.resource.overrides;I(null==e?void 0:e.minDvrDuration)&&(this.minDvrDuration=e.minDvrDuration),this.presoModel.isMuteAtPlayStart&&!this.presoModel.userHasUnmuted&&(this.muteVideo(!0),this.presoModel.isMuted=!0),this.bufferingSampleRate=this.performanceProxy.bufferingSampleRate}prepareForPlayback(e=!1){if(this.initializing)return;const t={system:this.system,playerOptions:this.playerOptions,resource:this.resourceProxy.resource,performanceSettings:this.performanceProxy,textTrackSettings:this.textTrackProxy,video:this.viewControl,logger:this.logger};this.adapterTask=this.initializeAdapter(t,e).catch(this.onLoadError)}sendErrorNotification(e,t){this.notify(e,t)}createAdapter(e){return E(this,null,(function*(){const t=this.facade.retrieveProxy("AdapterProxy");return yield t.createAdapter("playback",e.resource,(()=>this))}))}initializeAdapter(e,t){return E(this,null,(function*(){try{if(this.logger.time("playback-adapter-creation"),this.initializing=!0,this.closing)return;try{if(this.pAdapter=yield this.createAdapter(e),this.closing)return}catch(t){const r=Ze(e.resource);throw r&&(t.message+=`. Attempting to play a stream of type ${r}`),new te("resourceerror",t)}this.logger.timeEnd("playback-adapter-creation"),this.preloadContent&&(yield this.load());try{if(this.closing)return;if(!this.presoModel.isAutoplay&&!t)return;yield this.play()}catch(e){throw new te("videoplaybackerror",e)}}finally{this.initializing=!1}}))}respondToTextTrackInfoChange(){const{textTrackInfo:e}=this.contentPlaybackStateProxy;this.notify("texttrackinfochange",{textTrackInfo:this.contentPlaybackStateProxy.textTrackInfo}),this.shouldSendTextTrackAvailable&&e.track&&e.tracks.length&&(this.notify("texttrackavailable"),this.shouldSendTextTrackAvailable=!1)}protectAgainstEndFreeze(e){clearTimeout(this.endFreezeTimeoutHandle),this.endFreezeTimeoutHandle=setTimeout((()=>{this.respondToVideoEnd()}),e)}calculateStreamType(){if(this.pAdapter.getIsLiveStream()){const e=this.pAdapter.getLiveStreamInfo().dvrWindowSize;return e<this.minDvrDuration||isNaN(e)?"LIVE":"DVR"}return"VOD"}updateLiveStreamInfo(){if(!this.pAdapter.getIsLiveStream())return void this.respondToStreamTypeChange("VOD");const e=this.contentPlaybackStateProxy.model,t=this.pAdapter.getLiveStreamInfo();e.liveStreamInfo=t;const r=this.calculateStreamType();this.respondToStreamTypeChange(r);const i="LIVE"===r||t.isPlayingLive;this.isPlayingLive!==i&&(this.isPlayingLive=i,this.respondToIsPlayingLiveChange(i)),"DVR"===e.streamType&&this.respondToDurationChange(t.relativeDuration)}hasHook(e){return this.getProxy("HookProxy").hasHook(e)}applyHook(e,t){return this.getProxy("HookProxy").applyHook(e,t).catch((e=>{throw this.error(e),e}))}applyHookSync(e,t){try{return this.getProxy("HookProxy").applyHookSync(e,t)}catch(e){throw this.error(e),e}}},ln=class extends on{constructor(){super(...arguments),this.contentDurationReleased=!1,this.resumeTimeMaxProximityToAdBreak=5,this.isClickToPlay=!1,this.fullscreenRestrictedDuringAdPlay=!1,this._hasContent=!0,this.contentComplete=!1,this.timeSpent={startTime:null,lastTime:0,sessionTime:0,playbackTime:0,elapsedTime:0}}onRemove(){super.onRemove()}start(){const e=this.resourceProxy.location.mediaUrl;this._hasContent=w(e)&&!x(e)}get hasContent(){return this._hasContent}startSession(){this.updateTimeSpent()}close(){var e;if(this.closing)return this.closing;const t=null==(e=this.contentPlaybackStateProxy)?void 0:e.model,r=(null==t?void 0:t.time)||0,i=(null==t?void 0:t.duration)||0,n=this.isAdPlaying(),a=this.resourceProxy.resource;return this.respondToPlaybackStateChange("stopped"),this.contentPlaybackStateProxy.isReady=!1,this.closing=this.adapterTask.then((()=>{this.startedPlaying&&this.pause(),this.log("info","Closing Presentation"),this.closeAds()})).then((()=>this.adapter?this.adapter.destroy():null)).then((()=>{const e=!n&&this.hasContent&&!this.isContentComplete(),t=n;this.notify("resourceend",{resource:a,contentTime:r,contentDuration:i,contentInterrupted:e,adInterrupted:t,interrupted:e||t})})).catch((e=>{throw J.error(e),e})).then((()=>{this.closing=null}))}getPlayerVersionInfo(){return`${Yt.playerName}_${Yt.playerVersion}`}startContentSegment(){}closeAds(){}beforePlayOnUserGesture(){}playOnUserGesture(){this.notify("videoLoadStart"),this.prepareForPlayback(!0)}mute(e){this.muteVideo(e)}play(){return this.contentComplete&&(this.contentComplete=!1),super.play()}seek(e){return this.contentComplete&&(this.contentComplete=!1),this.seekVideo(e)}setVolume(e){this.domProxy&&this.domProxy.setVideoVolume(e),super.setVolume(e)}getAdBreakTimes(){return[]}getSessionTime(){return null==this.timeSpent.startTime?null:this.updateTimeSpent().sessionTime}releaseContentDuration(e){this.contentDurationReleased=!0,this.notify("contentdurationavailable",{contentDuration:e})}updateTimeSpent(){const e=performance.now();if(null==this.timeSpent.startTime){this.timeSpent.startTime=e;const t="first-frame",r={id:this.facade.appId,name:t,startTime:e};this.sendNotification("metric",{metric:new $t(t,r,"mark")}),this.sendNotification("playbackstarted")}null==this.timeSpent.lastTime&&(this.timeSpent.lastTime=e);const t=e-this.timeSpent.startTime;return this.timeSpent.elapsedTime=t,this.timeSpent.sessionTime=t/1e3,"paused"!==this.contentPlaybackStateProxy.model.state&&(this.timeSpent.playbackTime+=(e-this.timeSpent.lastTime)/1e3,this.timeSpent.lastTime=e),this.timeSpent}adjustStartTimeForAdBreakProximity(e,t){for(let r=0,i=t.length;r<i;r++){const i=t[r].startTime-e;if(i>=0&&i<this.resumeTimeMaxProximityToAdBreak)return e-this.resumeTimeMaxProximityToAdBreak}return e}get domProxy(){return this.facade.retrieveProxy("PlayerDomProxy")}muteVideo(e){super.muteVideo(e),this.domProxy&&this.domProxy.muteVideo(e)}respondToPlaybackStateChange(e){super.respondToPlaybackStateChange(e),this.timeSpent.lastTime=null}respondToFullscreenChange(e){this.checkSize(),this.notify("fullscreenchange",{fullscreen:e})}respondToVideoPaused(){this.respondToPlaybackStateChange("paused")}respondToVideoPlaying(){this.presoModel.started||(this.presoModel.started=!0),this.respondToPlaybackStateChange("playing")}respondToVideoSeeking(){this.notify("seekstart")}respondToVideoSeeked(){this.notify("seekcomplete")}respondToQualityChange(e=null){this.notify("qualitychange",{quality:e})}respondToError(e){e.message||(e.message=ue.messages.UNSPECIFIED_ERROR),e.code||(e.code="3400");const t=this.startedPlaying||!e.category?"videoplaybackerror":"playererror";this.sendErrorNotification(t,e)}respondToVideoEnd(){this.notify("resourceComplete")}respondToBufferingStatusCheck(e){const t=this.presoModel.streamTime;!isNaN(t)&&t>0&&this.checkVideoBuffering(e)}respondToId3Data(e){this.notify("metadatacuepoint",{cue:e})}respondToVideoTimeUpdate(e){const t=this.contentPlaybackStateProxy.model,{duration:r,liveStreamInfo:i,streamType:n,time:a}=t;this.updateTimeSpent();const s={contentTime:a,contentDuration:r,streamTime:e,streamDuration:this.presoModel.streamDuration,sessionTime:this.timeSpent.sessionTime,playbackTime:this.timeSpent.playbackTime};if("VOD"!==n){const{relativeTime:e,relativeDuration:r}=i;s.contentTime=e,s.contentDuration=r,s.elapsedTimeMs=this.timeSpent.elapsedTime,t.time=e,t.duration=r}this.notify("contentprogress",s)}respondToSizeChange(){this.adapter&&this.adapter.resize()}respondToDurationChange(e){}respondToTextTrackModeChange(e){}checkSize(){if(!this.domProxy)return;const e=this.domProxy.getPresentationRect();e.width===this.currentRect.width&&e.height===this.currentRect.height||(this.currentRect=e,this.respondToSizeChange(),this.notify("presentationsizechange",{width:this.currentRect.width,height:this.currentRect.height}))}setForClickToPlay(){if(this.getModel("PlayerOptions").useNativeControls){const e=this.domProxy.getMain(),t=()=>{e.removeEventListener("click",t),this.notify("playOnUSerGesture")};e.addEventListener("click",t)}}isContentComplete(){if(this.contentComplete)return!0;const e=this.contentPlaybackStateProxy.model;return"LIVE"!==e.streamType&&"DVR"!==e.streamType&&!(isNaN(e.time)||e.time<e.duration)}isAdPlaying(){return this.presoModel.isCurrentVideoAd}handleNotification(e){super.handleNotification(e)}listNotificationInterests(){return super.listNotificationInterests().concat([])}onRegister(){super.onRegister();const e=this.playerOptions.overrides;e.resumeTimeMaxProximityToAdBreak&&(this.resumeTimeMaxProximityToAdBreak=e.resumeTimeMaxProximityToAdBreak),this.isClickToPlay=!this.presoModel.isAutoplay;const t=this.system;this.fullscreenRestrictedDuringAdPlay=t.isIos||t.isAndroid,this.domProxy&&(this.currentRect=this.domProxy.getPresentationRect())}},dn=class extends ln{constructor(e,t){super(e,t),this.pAdAdapter=null,this.adAdapterStarted=!1,this.contentSegmentStarted=!1,this.contentStartReleased=!1,this.contentCompleteReleased=!1,this.fatalContentErrorReceived=!1,this.presoComplete=!1,this.hasMidRolls=!1,this.pendingSeekTime=null,this.currentAd=null,this.currentBreak=null,this.pointerLocked=!1,this.isPreloading=!1,this.cancelPointerLock=()=>{var e;document.removeEventListener("mousemove",this.cancelPointerLock),null==(e=document.exitPointerLock)||e.call(document),this.pointerLocked=!1},this.setPointerState=()=>E(this,null,(function*(){var e;if(!this.pointerLocked||this.isFullScreenAd()){if(!this.pointerLocked&&this.isFullScreenAd()){const t=null==(e=this.domProxy)?void 0:e.getMain();if(!t||!t.requestPointerLock)return;try{this.pointerLocked=!0,yield t.requestPointerLock(),this.cancelTimeout=setTimeout((()=>null==document?void 0:document.addEventListener("mousemove",this.cancelPointerLock)),100)}catch(e){this.pointerLocked=!1,this.logger.warn(e)}}}else this.cancelPointerLock()})),this.hMovement=e=>{this.presoModel.isFullscreen&&this.pointerLockDebouncer()},this.preloadContent=!1}set adAdapter(e){this.pAdAdapter=e}get adAdapter(){return this.pAdAdapter}get adInProgress(){return this.presoModel.isCurrentVideoAd}onRemove(){var e,t;null==(t=null==(e=this.pAdAdapter)?void 0:e.destroy)||t.call(e),this.pAdAdapter=null,this.cancelPointerLock(),this.pointerLockDebouncer.cancel(),clearTimeout(this.cancelTimeout),this.monitorActivity(!1),super.onRemove()}closeAds(){var e,t;null==(e=this.domProxy)||e.showAdContainer(!1),null==(t=this.adAdapter)||t.destroy(),this.pAdAdapter=null}beforePlayOnUserGesture(){var e;null==(e=this.adAdapter)||e.playClicked()}playOnUserGesture(){this.hasContent?super.playOnUserGesture():this.play()}start(){var e,t,r;const i=this.resourceProxy.playback.startTime,n=this.resourceProxy.ad.showPrerollOnNonZeroStart,a=!isNaN(i)&&i>0;if(super.start(),this.mute(this.presoModel.isMuted),a&&n&&(this.pendingSeekTime=i),this.isClickToPlay)this.setForClickToPlay();else{const i=this.resourceProxy.resource;(null==(t=null==(e=i.ad)?void 0:e.csai)?void 0:t.adCallUrl)&&!(null==(r=i.location)?void 0:r.mediaUrl)?this.play():(this.notify("videoLoadStart"),this.prepareForPlayback())}}getAdBreakTimes(){var e;const t=[];return null==(e=this.breakSchedule)||e.forEach((e=>{t.push(A({start:e.startTime,streamTimeStart:e.streamStartTime,end:e.endTime,streamTimeEnd:e.streamStartTime+e.duration,played:e.hasPlayed},e))})),t}getDelegate(){return hi({},this)}play(){var e;return this.presoModel.started?this.adInProgress&&(null==(e=this.adAdapter)?void 0:e.resume)?Promise.resolve(this.adAdapter.resume()):this.playVideo():(this.presoModel.started=!0,this.adAdapterStarted=!0,Promise.resolve(this.adAdapter.start()))}pause(){var e;this.adInProgress&&(null==(e=this.adAdapter)?void 0:e.pause)?this.adAdapter.pause():this.pauseVideo()}mute(e){var t;null==(t=this.adAdapter)||t.setMuteState(e),super.mute(e)}setVolume(e){var t;null==(t=this.adAdapter)||t.setVolume(e),super.setVolume(e)}seek(e){const t=this.streamTimeForContentTime(e),r=this.getPermittedSeekTime(e);return this.hasMidRolls&&this.adAdapter&&r!==t&&(this.pendingSeekTime=t,this.notify("seekredirectstart",{requestedSeekTime:e,actualSeekTime:this.contentTimeForStreamTime(r)})),this.contentComplete&&!this.contentSegmentStarted&&(this.contentSegmentStarted=!0),super.seek(r)}skipAd(){var e;null==(e=this.adAdapter)||e.skipAd()}pauseContent(){var e;this.pauseVideo(),null==(e=this.domProxy)||e.showAdContainer(!0)}resumeContent(){var e,t;if(this.currentAd=null,this.currentBreak=null,null==(e=this.domProxy)||e.showAdClickElement(!1),null==(t=this.domProxy)||t.showAdContainer(!1),!this.fatalContentErrorReceived)if(this.hasContent&&!this.contentComplete)if(this.contentStartReleased)this.resumeContentPlayComplete();else{const e=this.resourceProxy.playback.startTime;if(!isNaN(e)&&e>0){const t=this.getAdBreakTimes(),r=this.adjustStartTimeForAdBreakProximity(e,t);this.resourceProxy.playback.startTime=r}this.load().then((()=>{this.resumeContentPlayComplete()})).catch(this.onLoadError)}else super.respondToVideoEnd()}streamIdAvailable(e){this.notify("streamidavailable",{streamId:e})}applyHook(e,t){return super.applyHook(e,t)}adSkippableStateChanged(){this.notify("adskippablestatechange")}adSegmentStarted(){this.endContentSegment(),this.presoModel.isCurrentVideoAd=!0,this.notify("adsegmentstart")}adSegmentReentered(){this.notify("adsegmentreentered")}adSegmentEnded(){this.contentSegmentStarted=!1,this.presoModel&&(this.presoModel.isCurrentVideoAd=!1),this.notify("adsegmentend")}adBreaksAvailable(e){this.hasMidRolls=e.some((e=>"MID"===e.type)),this.breakSchedule=e;const t=e.map((e=>e.startTime));this.notify("adcuepointsavailable",{cuepoints:t,adBreaks:e})}seekToStreamTime(e){this.seekVideo(e)}adBreakStart(){var e;this.endContentSegment(),this.updateSize(),null==(e=this.domProxy)||e.showAdContainer(!0),this.presoModel.isCurrentVideoAd=!0,null===this.timeSpent.startTime&&this.startSession(),this.notify("adbreakstart")}adBreakMetadata(e){this.currentBreak=e,this.notify("adbreakmetadata",{adBreakInfo:e})}adLoaded(){}adStart(e){this.currentAd=e,this.respondToPlaybackStateChange("playing"),this.notify("adstart",{adInfo:e})}adProgress(e,t){this.notify("adprogress",{currentTime:e,duration:t,streamTime:this.presoModel.streamTime,streamDuration:this.presoModel.streamDuration}),this.checkPreload(e,t)}adFirstQuartile(){this.notify("adfirstquartile")}adMidpoint(){this.notify("admidpoint")}adThirdQuartile(){this.notify("adthirdquartile")}adComplete(){this.currentAd=null,this.notify("adcomplete")}adBreakComplete(){var e,t;if(this.currentBreak=null,this.currentAd=null,this.isPreloading=!1,null==(e=this.domProxy)||e.showAdContainer(!1),null==(t=this.domProxy)||t.showAdClickElement(!1),this.presoModel.isCurrentVideoAd=!1,this.notify("adbreakcomplete"),this.pendingSeekTime&&this.contentStartReleased){const e=this.pendingSeekTime;this.pendingSeekTime=null,this.contentPlaybackStateProxy.model.started&&this.notify("seekredirectcomplete"),this.seekVideo(e)}}adClicked(){var e,t;"playing"===(null==(t=null==(e=this.contentPlaybackStateProxy)?void 0:e.model)?void 0:t.state)&&this.pause(),this.notify("ad-click")}adError(e){this.currentAd=null,e.message||(e.message=ue.messages.UNSPECIFIED_ERROR),this.notify("aderror",e)}adPaused(){this.respondToPlaybackStateChange("paused"),this.notify("adpaused")}adResumed(){this.notify("resourcebuffering",{buffering:!1}),this.respondToPlaybackStateChange("playing"),this.notify("adplaying")}adStalled(e){this.logger.dir("warn",e,"Stalled Ad Info"),this.notify("adstalled",new se("4000","Stalled ad detected",e,!1,"Ad"))}adBreakDiscarded(){this.notify("adbreakdiscarded")}adSkipped(){this.notify("adskipped")}allAdsComplete(){}adBuffering(e){}displayAdClickElement(e){var t;null==(t=this.domProxy)||t.showAdClickElement(e)}resumeContentPlayComplete(){return E(this,null,(function*(){this.pendingSeekTime&&this.contentStartReleased&&(this.notify("seekredirectcomplete"),yield this.seekVideo(this.pendingSeekTime).catch((e=>{this.log("warn","APM#resumeContentPlayComplete; A seek() call failed."),this.logger.dir("debug",e,"Error")})),this.pendingSeekTime=null),this.play()}))}isFullScreenAd(){return this.presoModel.isFullscreen&&this.adInProgress}monitorActivity(e=!1){var t,r;if(!Fe.isDesktop)return;const i=e?"addEventListener":"removeEventListener";null==(r=null==(t=this.domProxy)?void 0:t.getMain())||r[i]("mousemove",this.hMovement)}handleNotification(e){var t;const{name:r,body:i}=e;let n=!1;switch(r){case"fullscreenchange":this.adAdapter.setFullscreenState(i.fullscreen),n=!0;break;case"qualitychange":const e=(null==(t=i.quality)?void 0:t.bitrate)?Math.round(.001*i.quality.bitrate):-1;this.adAdapter.setContentBitrate(e)}super.handleNotification(e),n&&this.monitorActivity(i.fullscreen)}updateSize(){var e,t;const r=null==(e=this.domProxy)?void 0:e.getPresentationRect();r&&(null==(t=this.adAdapter)||t.updateSize(r))}respondToSizeChange(){this.updateSize(),super.respondToSizeChange()}respondToId3Data(e){e.info&&(e.msg=e.info),this.adAdapter.handleTimedMetadata(e),super.respondToId3Data(e)}respondToVideoPaused(){super.respondToVideoPaused(),this.adInProgress?this.notify("adpaused"):(this.respondToPlaybackStateChange("paused"),this.notify("contentpaused"))}respondToPlaybackStateChange(e){this.isPreloading&&"waiting"===e||super.respondToPlaybackStateChange(e)}respondToVideoPlaying(){super.respondToVideoPlaying(),this.adAdapterStarted||(this.adAdapterStarted=!0,this.adAdapter.start()),this.contentPlaybackStateProxy.model.time>.5&&!this.adInProgress&&this.contentSegmentStarted?(this.respondToPlaybackStateChange("playing"),this.notify("contentplaying")):this.adInProgress&&this.notify("adplaying")}respondToVideoTimeUpdate(e){var t,r,i;const n=this.contentPlaybackStateProxy.model;this.presoModel.streamTime=e,null==(t=this.adAdapter)||t.setStreamTime(e),n.time=this.contentTimeForStreamTime(e),this.adInProgress||(e>.75&&!this.contentSegmentStarted&&(n.started=!0,null==(r=this.domProxy)||r.showAdClickElement(!1),null==(i=this.domProxy)||i.showAdContainer(!1),!this.contentStartReleased&&this.signalContentStart(),this.contentSegmentStarted=!0,this.hasMidRolls||"LIVE"===n.streamType||"DVR"===n.streamType?this.notify("contentsegmentstart"):this.notify("contentplaying")),this.contentSegmentStarted&&super.respondToVideoTimeUpdate(e),"LIVE"!==n.streamType&&n.time>=n.duration&&!this.contentCompleteReleased&&this.signalContentComplete())}endContentSegment(){if(this.contentSegmentStarted){const e=this.contentPlaybackStateProxy.model;this.contentSegmentStarted=!1,(this.hasMidRolls||"LIVE"===e.streamType||"DVR"===e.streamType)&&this.notify("contentsegmentend")}}respondToVideoEnd(){var e;this.contentComplete=!0,this.contentCompleteReleased||this.signalContentComplete(),null==(e=this.adAdapter)||e.contentComplete(),this.breakSchedule.find((e=>"POST"===e.type))||(this.presoComplete=!0,super.respondToVideoEnd())}respondToDurationChange(e){if(e&&!isNaN(e)&&e>0){this.adAdapter.setStreamDuration(e),this.presoModel.streamDuration=e;const t=this.contentTimeForStreamTime(e);this.contentPlaybackStateProxy.model.duration=t,this.contentDurationReleased||this.releaseContentDuration(e)}}respondToError(e){this.fatalContentErrorReceived=e.fatal,super.respondToError(e)}isContentComplete(){return this.presoComplete}startContentSegment(){var e;this.contentSegmentStarted=!0,this.contentPlaybackStateProxy.model.started=!0,null==(e=this.domProxy)||e.showAdContainer(!1),this.contentStartReleased||this.signalContentStart(),this.notify("contentsegmentstart")}checkPreload(e,t){var r,i,n,a,s,o;if(!this.isPreloading&&!0===(null==(a=null==(n=null==(i=null==(r=this.resourceProxy)?void 0:r.resource)?void 0:i.ad)?void 0:n.csai)?void 0:a.preloadContentAtEndOfPreRoll)&&(null==(s=this.currentAd)?void 0:s.adPosition)===(null==(o=this.currentBreak)?void 0:o.adTotal)&&!this.system.isIos){const r=be(Math.ceil(t/4),2,10);Math.round(e)>=r&&(this.isPreloading=!0,this.load().catch(this.onLoadError))}}signalContentStart(){this.contentStartReleased=!0,this.notify("contentstart")}signalContentComplete(){this.contentSegmentStarted&&this.endContentSegment(),this.contentCompleteReleased=!0,this.notify("contentcomplete")}contentTimeForStreamTime(e){var t;return(null==(t=this.adAdapter)?void 0:t.contentTimeForStreamTime)?this.adAdapter.contentTimeForStreamTime(e):e}streamTimeForContentTime(e){var t;return(null==(t=this.adAdapter)?void 0:t.streamTimeForContentTime)?this.adAdapter.streamTimeForContentTime(e):e}getPermittedSeekTime(e){var t;return(null==(t=this.adAdapter)?void 0:t.getPermittedSeekTime)?this.adAdapter.getPermittedSeekTime(e):e}listNotificationInterests(){return super.listNotificationInterests().concat(["fullscreenchange","qualitychange"])}onRegister(){var e,t;super.onRegister();const{idleDelay:r}=this.facade.retrieveProxy("ActivityProxy");this.pointerLockDebouncer=Gt(this.setPointerState,r),null==(e=this.domProxy)||e.showAdContainer(!1),null==(t=this.domProxy)||t.showAdClickElement(!1)}};T([ci()],dn.prototype,"pauseContent",1),T([ci()],dn.prototype,"resumeContent",1),T([ci()],dn.prototype,"streamIdAvailable",1),T([ci()],dn.prototype,"applyHook",1),T([ci()],dn.prototype,"adSkippableStateChanged",1),T([ci()],dn.prototype,"adSegmentStarted",1),T([ci()],dn.prototype,"adSegmentReentered",1),T([ci()],dn.prototype,"adSegmentEnded",1),T([ci()],dn.prototype,"adBreaksAvailable",1),T([ci()],dn.prototype,"seekToStreamTime",1),T([ci()],dn.prototype,"adBreakStart",1),T([ci()],dn.prototype,"adBreakMetadata",1),T([ci()],dn.prototype,"adLoaded",1),T([ci()],dn.prototype,"adStart",1),T([ci()],dn.prototype,"adProgress",1),T([ci()],dn.prototype,"adFirstQuartile",1),T([ci()],dn.prototype,"adMidpoint",1),T([ci()],dn.prototype,"adThirdQuartile",1),T([ci()],dn.prototype,"adComplete",1),T([ci()],dn.prototype,"adBreakComplete",1),T([ci()],dn.prototype,"adClicked",1),T([ci()],dn.prototype,"adError",1),T([ci()],dn.prototype,"adPaused",1),T([ci()],dn.prototype,"adResumed",1),T([ci()],dn.prototype,"adStalled",1),T([ci()],dn.prototype,"adBreakDiscarded",1),T([ci()],dn.prototype,"adSkipped",1),T([ci()],dn.prototype,"allAdsComplete",1),T([ci()],dn.prototype,"adBuffering",1),T([ci()],dn.prototype,"displayAdClickElement",1);var cn=class extends ln{start(){this.isClickToPlay?this.setForClickToPlay():this.notify("videoLoadStart")}respondToVideoPlaying(){let e=!1;this.contentPlaybackStateProxy.model.started=!0,this.presoModel.started||(e=!0),super.respondToVideoPlaying(),e&&this.notify("contentstart"),this.notify("contentplaying")}respondToVideoTimeUpdate(e){if(this.contentComplete)return;const t=this.contentPlaybackStateProxy.model;this.presoModel.streamTime=e,t.time=e,this.presoModel.started&&super.respondToVideoTimeUpdate(e)}respondToVideoPaused(){super.respondToVideoPaused(),this.notify("contentpaused")}respondToIsPlayingLiveChange(e){super.respondToIsPlayingLiveChange(e)}respondToVideoEnd(){this.contentComplete=!0,this.notify("contentcomplete"),super.respondToVideoEnd()}respondToDurationChange(e){this.presoModel.streamDuration=e,this.contentPlaybackStateProxy.model.duration=e,this.contentDurationReleased||this.releaseContentDuration(e)}onRegister(){super.onRegister(),this.domProxy&&this.domProxy.showAdContainer(!1),!this.isClickToPlay&&this.prepareForPlayback()}},un=class extends mi{execute(e){var t,r;const{facade:i}=this;switch(e.name){case"resourceComplete":if(!1===(null==(t=this.getModel("PlayerOptions").overrides)?void 0:t.closeOnEnded))return;const n=i.retrieveMediator("PresentationMediator");return void(null==n||n.close());case"resourceend":i.retrieveMediator("TimerMediator").killTimer(),this.sendNotification("killResourcePresentation",null,"internal");break;case"resourcebuffering":const a=i.retrieveProxy("PlayerDomProxy"),s=null==a?void 0:a.getMain();null==s||s.setAttribute("aria-busy",e.body.buffering.toString());break;case"adbreakstart":const o=i.retrieveMediator("PresentationMediator");null==(r=null==o?void 0:o.adapter)||r.clearText()}}},hn={default:null,bootApp:class extends Ai{initializeMacroCommand(){this.addSubCommand(Wi),this.addSubCommand(ki),this.addSubCommand(ji),this.addSubCommand(en),this.addSubCommand(Gi)}},ready:class extends mi{execute(e){const t=this.facade.retrieveProxy("PlayerDomProxy");if(t){const r=t.getMain();r.setAttribute("role","region");const i=r.getAttribute("tabindex")||"0";r.setAttribute("tabindex",i);const n=t.getVideo();n&&!n.player&&(n.player=e.body,n.avia=Fe.appNamespace)}}},mutechange:nn,volumechange:nn,resourceend:un,resourcebuffering:un,adbreakstart:un,metric:class extends mi{execute(e){const{type:t,value:r}=e.body.metric;switch(t){case"mark":try{performance.mark(rn(r),{startTime:r.startTime})}catch(e){this.logger.warn(e)}break;case"measure":try{const e=rn(r);performance.measure(e,e+":start",e+":end")}catch(e){this.logger.warn(e)}}}},resourceComplete:un,playOnUSerGesture:nn,play:nn,pause:nn,seek:nn,switchAudioTrack:nn,switchTextTrack:nn,switchTextMode:nn,suspendPlayback:class extends mi{execute(e){const t=this.getModel("PresentationState");this.facade.retrieveMediator("PresentationMediator").suspend(),t.suspended=!0;const r=this.getProxy("ContentPlaybackStateProxy");this.sendNotification("playbacksuspended",{contentTime:r.model.time})}},resumePlayback:class extends mi{execute(e){const t=this.getModel("PresentationState"),r=this.facade.retrieveMediator("PresentationMediator");t.suspended=!1,r.resume();const i=this.getProxy("ContentPlaybackStateProxy");this.sendNotification("playbackresumed",{contentTime:i.model.time})}},switchBitrate:gi,switchQualityCategory:gi,autoQualitySwitching:gi,minBitrate:gi,maxBitrate:gi,prepResourceCollection:class extends mi{execute(e){e.body.resource?this.getProxy("HookProxy").applyHook("attachresource",new ii(e.body.resource)).then((e=>{try{ii.validate(e)}catch(e){this.invalidResource(e.message)}e.sessionId||(e.sessionId=U()),e.cmcd.sessionId||(e.cmcd.sessionId=e.sessionId),e.contentId&&!e.cmcd.contentId&&(e.cmcd.contentId=e.contentId),this.facade.sendNotification("playResource",e,"internal")})).catch((e=>{this.facade.sendNotification("resourceerror",e.cause||e,"internal")})):this.invalidResource(ue.messages.RESOURCE_MISSING)}invalidResource(e){this.facade.sendNotification("resourceerror",{message:`${ue.messages.INVALID_RESOURCE}: ${e}`,code:"1000",fatal:!0},"internal")}},startPresentation:class extends mi{execute(e){const t=this.facade.retrieveMediator("PresentationMediator"),r=this.facade.retrieveProxy("ResourceProxy");this.sendNotification("resourcestart",{resource:r.resource}),t.start()}},playResource:class extends mi{execute(e){var t;const r=this.system,i=e.body;if(!(null==(t=r.global)?void 0:t.document))return void this.sendNotification("videostarterror",{error:ue.messages.ENVIRONMENT_NOT_SUPPORTED,fatal:!0});const n=this.getModel("PresentationState"),a=this.getModel("PlayerOptions");this.facade.registerProxy(new an("ContentPlaybackStateProxy")),this.checkAutoplay(a).then((e=>{this.processAutoplaySupport(e,n,a),this.createPresentation(i,n,a)}))}createPresentation(e,t,r){return E(this,null,(function*(){const i=yield this.getPresentationMediator(e,t,r);i&&(this.facade.registerMediator(i),this.sendNotification("startPresentation"))}))}getPresentationMediator(e,t,r){return E(this,null,(function*(){var i,n,a;const s=this.facade.retrieveProxy("PlayerDomProxy"),o=this.getVideo(s,r),l="PresentationMediator",d=(null==(i=null==e?void 0:e.ad)?void 0:i.csai)||(null==(n=null==e?void 0:e.ad)?void 0:n.ssai);let c=null;if(null===o)return this.sendNotification("resourceerror",{code:"9999",message:ue.messages.VIDEO_PLAYBACK_UNAVAILABLE,fatal:!0}),c;if((d||t.isAutoplay||r.playsInline)&&(null==s||s.setVideoAttribute("playsinline","")),d)try{this.logger.time("ad-adapter-creation");const t=new dn(l,o),r=t.getDelegate(),i=this.facade.retrieveProxy("AdapterProxy"),n=yield i.createAdapter("ad",e,(()=>r));t.adAdapter=n,this.logger.timeEnd("ad-adapter-creation"),this.logger.time("ad-resource-creation");const s=yield null==(a=n.getResource)?void 0:a.call(n);this.logger.timeEnd("ad-resource-creation"),s&&(e=s),c=t}catch(e){this.sendNotification("aderror",{code:e.code||"4400",message:e.message,cause:e,fatal:!0})}else c=new cn(l,o);return this.createResourceProxy(e),c}))}createResourceProxy(e){const t=new sn("ResourceProxy",e);this.facade.registerProxy(t)}getVideo(e,t){const r=this.system;return r.isWebMaf?r.webMafPlayer:e?(!0!==t.reuseVideoElement&&e.recreateVideo(),e.getVideo()):null}processAutoplaySupport(e,t,r){if(t.isAutoplay)return;const i=r.autoplay,n=e.supportsMutedAutoplay,a=e.supportsUnmutedAutoplay;(("attemptMuted"===i||"attemptUnmutedThenMuted"===i)&&!n||"attemptUnmuted"===i&&!a)&&this.sendNotification("autoplayblocked",new Error("Autoplay capability conflict."),"internal"),t.isMuteAtPlayStart="attemptMuted"===i&&n||"attemptUnmutedThenMuted"===i&&!a&&n,t.isAutoplay=this.shouldAutoplay(i,e)}shouldAutoplay(e,t){if(x(e)||"none"===e)return!1;const r=t.supportsMutedAutoplay,i=t.supportsUnmutedAutoplay,n="attemptUnmuted"===e&&i;return"attemptMuted"===e&&r||n||!n&&"attemptUnmutedThenMuted"===e&&r}checkAutoplay(e){var t;return this.getService("AutoplayCapabilities").detectCapabilities(null==(t=e.overrides)?void 0:t.blankVideoUrl)}},killResourcePresentation:class extends mi{execute(e){this.facade.removeMediator("PresentationMediator"),this.facade.removeProxy("ResourceProxy"),this.facade.removeProxy("ContentPlaybackStateProxy"),this.facade.retrieveProxy("ModelCollectionProxy").reset()}},changeLanguage:class extends mi{execute(e){const{name:t,body:r}=e;switch(t){case"changeLanguage":const e=this.facade.retrieveProxy("LocalizationProxy"),{language:t}=r;e.changeLanguage(t).then((r=>{const i=this.facade.retrieveProxy("PlayerDomProxy");if(i){const t=i.getMain();t.setAttribute("aria-label",e.localize("media-player")),t.setAttribute("lang",e.language)}this.sendNotification("languagechange",{language:t}),this.sendNotification("localizationChange",{localeData:r})}))}}},playererror:tn,videostarterror:tn,videoplaybackerror:tn,resourceerror:tn,aderror:tn,adstalled:tn},pn=class extends di{constructor(e){super(Object.assign({commandMap:hn,id:e.playerOptions.id||null},e)),this.pIsReady=!1,this.seekTime=NaN,this.api=hi({},this),this.target=this.api,this.logger=e.logger,this.init(e)}initialize(){const e=this.modelCollectionProxy.getModel("PlayerOptions"),t=e.plugins||[],r=this.getApi(),i={name:"changeLanguage",body:{language:e.language},type:"internal"};return r.registerPlugins(t).then((()=>(this.localization.registerLocalizationData(e.localization),this.sendAsyncNotification(i,["languagechange"])))).then((()=>(this.pIsReady=!0,this.sendNotification("ready",r),r))).catch((e=>{throw this.logger.error(e),e}))}destroy(){var e;null==(e=this.appMediator)||e.disableKeyCommands();const t=super.destroy.bind(this),r=this.logger;return this.killCurrentResource().then((()=>{this.apiAccessors=null,this.apiMethods=null,t()})).catch((e=>{throw r.error(e),e}))}getApi(){return this.api}killCurrentResource(){return this.appMediator.killCurrentResource()}hasListenerFor(e){if(!w(e))throw this.invalidArgException("hasListenerFor(type)",e);return super.hasListenerFor(e)}on(e,t){if(!w(e)||"function"!=typeof t)throw this.invalidArgException("on(type, func)",e,t);super.on(e,t)}once(e,t){if(!w(e)||"function"!=typeof t)throw this.invalidArgException("on(type, func)",e,t);super.once(e,t)}off(e,t){if(!w(e))throw this.invalidArgException("on(type, func)",e,t);super.off(e,t)}get isReady(){return this.pIsReady}get id(){return this.appId}get dimensions(){return this.appMediator.getDimensions()||null}get video(){var e;return null==(e=this.dom)?void 0:e.getVideo()}get isAutoplay(){return this.presentationState.isAutoplay}get isFullscreen(){return this.presentationState.isFullscreen}get isAd(){return this.presentationState.isCurrentVideoAd}get muted(){return this.appMediator.getMuteState()}set muted(e){if("boolean"!=typeof e)throw this.invalidArgException("player.muted = boolean",e);this.muted!==e&&this.transmitExtRequest("mutechange",{muted:e})}get volume(){return this.appMediator.getVolume()}set volume(e){if(!I(e)||!ke(e,0,1))throw this.invalidArgException("player.volume = number [0,1]",e);this.volume!==e&&this.transmitExtRequest("volumechange",{volume:e})}get language(){return this.localization.language}set language(e){if(or.language(),!w(e))throw this.invalidArgException("player.language = string",e);this.transmitExtRequest("changeLanguage",{language:e})}get contentTime(){return isNaN(this.seekTime)?this.contentPlaybackStateProxy?this.contentPlaybackStateProxy.model.time:0:this.seekTime}get sessionTime(){const e=this.appMediator.getSessionTime();return null==e?0:e}get contentDuration(){return this.contentPlaybackStateProxy?this.contentPlaybackStateProxy.model.duration:NaN}get streamTime(){return this.presentationState.streamTime}get streamDuration(){return this.presentationState.streamDuration}get playbackState(){var e;return(null==(e=this.contentPlaybackStateProxy)?void 0:e.model.state)||"idle"}get autoQualitySwitching(){var e;return"auto"===(null==(e=this.contentPlaybackStateProxy)?void 0:e.qualitySwitchingMode)||!1}set autoQualitySwitching(e){if(!N(e))throw this.invalidArgException("player.autoQualitySwitching = boolean",e);this.contentPlaybackStateReady?this.transmitExtRequest("autoQualitySwitching",{value:e}):this.log(ue.messages.CONTENT_PLAYBACK_SETTING_IGNORED)}get quality(){var e,t;return(null==(t=null==(e=this.contentPlaybackStateProxy)?void 0:e.qualityInfo)?void 0:t.quality)||null}get qualities(){var e;return(null==(e=this.contentPlaybackStateProxy)?void 0:e.qualities)||[]}get qualityInfo(){return or.qualityInfo(),this.contentPlaybackStateProxy?this.contentPlaybackStateProxy.qualityInfo:null}get bitrate(){var e;const t=(null==(e=this.qualityInfo)?void 0:e.quality)||{bitrate:NaN};return null!=t.bitrate?t.bitrate:NaN}set bitrate(e){if(!I(e))throw this.invalidArgException("player.bitrate = number",e);this.contentPlaybackStateReady?this.transmitExtRequest("switchBitrate",{value:e}):this.log(ue.messages.CONTENT_PLAYBACK_SETTING_IGNORED)}get qualityCategory(){return this.contentPlaybackStateProxy?this.contentPlaybackStateProxy.userQualityCategory:null}set qualityCategory(e){if(!w(e))throw this.invalidArgException("player.qualityCategory = string",e);this.contentPlaybackStateReady?this.transmitExtRequest("switchQualityCategory",{value:e}):this.log(ue.messages.CONTENT_PLAYBACK_SETTING_IGNORED)}get minBitrate(){return this.contentPlaybackStateProxy?this.contentPlaybackStateProxy.minBitrate:NaN}set minBitrate(e){if(!I(e))throw this.invalidArgException("player.minBitrate = number",e);this.contentPlaybackStateReady?this.transmitExtRequest("minBitrate",{value:e}):this.log(ue.messages.CONTENT_PLAYBACK_SETTING_IGNORED)}get maxBitrate(){return this.contentPlaybackStateProxy?this.contentPlaybackStateProxy.maxBitrate:NaN}set maxBitrate(e){if(!I(e))throw this.invalidArgException("player.maxBitrate = number",e);this.contentPlaybackStateReady?this.transmitExtRequest("maxBitrate",{value:e}):this.log(ue.messages.CONTENT_PLAYBACK_SETTING_IGNORED)}get audioTracks(){var e;return(null==(e=this.contentPlaybackStateProxy)?void 0:e.model.audioTracks.tracks)||[]}get audioTrackInfo(){return or.audioTrackInfo(),this.contentPlaybackStateProxy?this.contentPlaybackStateProxy.model.audioTracks:null}get audioTrack(){return this.contentPlaybackStateProxy?this.contentPlaybackStateProxy.model.audioTracks.track:null}set audioTrack(e){if(!e)throw this.invalidArgException("player.audioTrack = AudioTrackInterface",e);this.contentPlaybackStateReady?this.transmitExtRequest("switchAudioTrack",{value:e}):this.log(ue.messages.CONTENT_PLAYBACK_SETTING_IGNORED)}attachResource(e){return this.logger.time("resource-attachment"),this.stop().then((()=>{if(!e||x(e))throw this.invalidArgException("attachResource(resource)",e)})).then((()=>this.sendAsyncNotification({name:"prepResourceCollection",body:{resource:e,start:!0}},["resourcestart"]))).then((()=>(this.logger.timeEnd("resource-attachment"),this.resource))).catch((e=>{throw se.eventToError(e,"Resource")}))}get resource(){return this.appMediator.getCurrentResource()}get textTrackEnabled(){return this.facade.retrieveProxy("TextTrackProxy").enabled}set textTrackEnabled(e){if(!N(e))throw this.invalidArgException("player.textTrackEnabled = boolean",e);this.transmitExtRequest("switchTextMode",{value:e})}get textTrack(){var e;return(null==(e=this.contentPlaybackStateProxy)?void 0:e.textTrackInfo.track)||null}set textTrack(e){if(!e||!e.kind)throw this.invalidArgException("player.textTrack = TextTrackInterface",e);this.contentPlaybackStateReady?this.transmitExtRequest("switchTextTrack",{value:e}):this.log(ue.messages.CONTENT_PLAYBACK_SETTING_IGNORED)}get textTracks(){var e;return(null==(e=this.contentPlaybackStateProxy)?void 0:e.textTrackInfo.tracks)||[]}get textTrackInfo(){return or.textTrackInfo(),this.contentPlaybackStateProxy?this.contentPlaybackStateProxy.textTrackInfo:null}get streamType(){return this.contentPlaybackStateProxy?this.contentPlaybackStateProxy.model.streamType:null}get isPlayingLive(){const e=this.contentPlaybackStateProxy?this.contentPlaybackStateProxy.model.liveStreamInfo:null;return!0===(null==e?void 0:e.isPlayingLive)}get liveStreamUtcStart(){const e=this.contentPlaybackStateProxy?this.contentPlaybackStateProxy.model.liveStreamInfo:null;return e?e.absoluteStart:NaN}get liveStreamUtcTime(){const e=this.contentPlaybackStateProxy?this.contentPlaybackStateProxy.model.liveStreamInfo:null;return e?e.absoluteTime:NaN}get liveStreamUtcDuration(){const e=this.contentPlaybackStateProxy?this.contentPlaybackStateProxy.model.liveStreamInfo:null;return e?e.absoluteDuration:NaN}get isSuspended(){return this.appMediator.isPlaybackSuspended()}get fullscreenElement(){return this.appMediator.getFullscreenElement()}set fullscreenElement(e){var t,r;if(!e||!/element/.test(null==(r=null==(t=e.constructor)?void 0:t.name)?void 0:r.toLowerCase()))throw this.invalidArgException("player.fullscreenElement = HTMLElement",e);this.appMediator.setFullscreenElement(e)}get pausable(){var e;return!1!==(null==(e=this.opts.playerOptions.overrides)?void 0:e.liveStreamPausable)||"LIVE"!==this.streamType}enterFullscreen(){this.transmitExtRequest("enterFullscreenRequest")}exitFullscreen(){this.transmitExtRequest("exitFullscreenRequest")}play(){return this.recordMetric("api","play"),this.appMediator.isPlaybackSuspended()&&this.transmitExtRequest("resumePlayback"),this.sendAsyncNotification({name:"play",type:"external"},["contentplaying","adplaying"])}pause(){if(this.recordMetric("api","pause"),this.pausable){if("paused"===this.playbackState)return Promise.resolve();const e={name:"pause",type:"external"};return this.sendAsyncNotification(e,["contentpaused","adpaused"])}return this.log(ue.messages.PAUSING_LINEAR_LIVE_STREAM_NOT_ALLOWED),this.stop()}togglePlayPause(){return"playing"===this.playbackState?this.pause():this.play()}seek(e){const t=this.appMediator.validateSeek(e,this.contentDuration);return null==t?Promise.reject(this.invalidArgException("seek(position)",e)):(this.recordMetric("api","seek",e),this.seekInternal(t))}jump(e){return this.seek(this.contentTime+e)}getAdBreakTimes(){return this.appMediator.getAdBreakTimes()||[]}grabFrame(){return this.appMediator.grabFrame()}getThumbnail(e){var t;if(!I(e))throw this.invalidArgException("getThumbnail(time)",e);return(null==(t=this.contentPlaybackStateProxy)?void 0:t.getThumbnail(e))||null}getContainerRect(){return this.appMediator.getContainerRect()}registerPlugins(e,t){return Array.isArray(e)?new Promise(((r,i)=>{this.transmitExtRequest("loadPlugins",{plugins:e,callback:()=>{"function"==typeof t&&t(),r()}})})):Promise.reject(this.invalidArgException("registerPlugins(cfgArray, callback?)",e,t))}removePlugin(e){if(!w(e))throw this.invalidArgException("removePlugin(name)",e);this.transmitExtRequest("removePlugin",{name:e})}registerAdapter(e){if(x(e))throw this.invalidArgException("registerAdapter(adapterConfig)",e);return this.adapters.registerAdapter(e)}retrieveAdapter(e){if(!w(e))throw this.invalidArgException("retrieveAdapter(id)",e);return this.adapters.retrieveAdapter(e)}removeAdapter(e){return w(e)||this.invalidArgException("removeAdapter(id)",e),this.adapters.removeAdapter(e)}registerHook(e,t){if(!w(e)||"function"!=typeof t)throw this.invalidArgException("registerHook(type, hook)",e,t);return this.hooks.registerHook(e,t)}removeHook(e,t){if(!w(e)||"function"!=typeof t)throw this.invalidArgException("removeHook(type, hook)",e,t);return this.hooks.removeHook(e,t)}getPlugin(e){if(!w(e))throw this.invalidArgException("getPlugin(name)",e);return this.appMediator.getPlugin(e)}getAdapter(e){const t=this.presentationMediator;if(!w(e))throw this.invalidArgException("getAdapter(role)",e);if(!t)return null;switch(e){case"ad":return t.adAdapter||null;case"playback":return t.adapter||null;default:return null}}stop(){var e;return(null==(e=this.contentPlaybackStateProxy)?void 0:e.model)&&this.presentationMediator?this.appMediator.killCurrentResource():Promise.resolve()}goLive(){const e=this.contentPlaybackStateProxy?this.contentPlaybackStateProxy.model.liveStreamInfo:null;return this.streamType&&"VOD"!==this.streamType&&e?(this.recordMetric("api","go_live"),this.seekInternal(e.relativeDuration-e.liveEdgeOffset)):Promise.reject()}skipAd(){this.appMediator.skipAd()}focus(e){var t;const r=null==(t=this.dom)?void 0:t.getMain();r&&r.focus(e)}blur(){const e=this.dom.getMain();e&&e.blur()}getKeyEventTarget(){return this.appMediator.getKeyEventTarget()}disableKeyCommands(e){this.appMediator.disableKeyCommands(e)}getConfigAsJson(e){return this.appMediator.getConfigAsJson(e)}suspendPlayback(){this.appMediator.isPlaybackSuspended()||this.pause().then((()=>{this.transmitExtRequest("suspendPlayback")}))}resumePlayback(){this.play()}recordMetric(e,t,r){if(!w(e)||!w(t))throw this.invalidArgException("recordMetric(type, key, value?)",e,t,r);this.sendNotification("metric",{metric:new $t(t,r,e)})}offsetTimedText(e){if(!I(e))throw this.invalidArgException("offsetTimedText(pixelOffset)",e);this.appMediator.offsetTimedText(e)}primeVideoElement(){return this.appMediator.primeVideoElement()}selectAudioLanguage(e,t){if(!w(e))throw this.invalidArgException("player.selectAudioLanguage(language)",e);if(this.modelCollectionProxy.getModel("PlayerOptions").audioLanguage=e,!this.contentPlaybackStateReady)return Promise.resolve(null);const r=Ot(this.audioTracks,e).filter((e=>void 0===t||e.type===t))[0]||Dt(this.audioTracks,e);if(!r||r===this.audioTrack)return Promise.resolve(r);const i={name:"switchAudioTrack",body:{value:r},type:"external"};return this.sendAsyncNotification(i,["audiotrackchange"]).then((e=>r))}selectTextLanguage(e,t){if(!w(e))throw this.invalidArgException("player.selectTextLanguage(language)",e);if(this.modelCollectionProxy.getModel("PlayerOptions").textLanguage=e,this.facade.retrieveProxy("TextTrackProxy").language=e,!this.contentPlaybackStateReady)return Promise.resolve(null);const r=Dt(this.textTracks,e);if(!r||r===this.textTrack)return Promise.resolve(r);const i={name:"switchTextTrack",body:{value:r},type:"external"};return this.sendAsyncNotification(i,["texttrackchange"]).then((e=>r))}selectLocalizationLanguage(e){if(!w(e))throw this.invalidArgException("player.selectLocalizationLanguage(language)",e);this.modelCollectionProxy.getModel("PlayerOptions").language=e;const t={name:"changeLanguage",body:{language:e},type:"external"};return this.sendAsyncNotification(t,["languagechange"]).then((e=>e.localeData))}sendEvent(e,t={}){or.checkEventName(e),this.emit(e,t)}get contentPlaybackStateProxy(){return this.facade.retrieveProxy("ContentPlaybackStateProxy")}get contentPlaybackStateReady(){var e;return(null==(e=this.contentPlaybackStateProxy)?void 0:e.isReady)||!1}get localization(){return this.facade.retrieveProxy("LocalizationProxy")}get dom(){return this.facade.retrieveProxy("PlayerDomProxy")}get adapters(){return this.facade.retrieveProxy("AdapterProxy")}get presentationState(){return this.modelCollectionProxy.getModel("PresentationState")}get presentationMediator(){return this.facade.retrieveMediator("PresentationMediator")}get hooks(){return this.facade.retrieveProxy("HookProxy")}transmitExtRequest(e,t){this.sendNotification(e,t,"external")}log(e,t){const r=t||"debug";this.facade.log(r,e)}init(e){const t=new oi(e.hookManager);this.facade.registerProxy(t);const r=this.opts.globalServices;this.facade.log("info",`${Yt.playerName}@${Yt.playerVersion}  ${Yt.buildTime}`),this.registerGlobalServices(r),delete this.opts.globalServices,this.sendNotification("bootApp",{playerOptions:this.opts.playerOptions||null,app:this},"internal"),this.logger.on("logtimeevent",(e=>{const{id:t,label:r,item:i}=e.detail,n=`${r}:start`;this.recordMetric("mark",n,{id:t,name:n,startTime:i.startTime})})),this.logger.on("logtimeendevent",(e=>{const{id:t,label:r,item:i}=e.detail,{startTime:n,duration:a}=i,s=`${r}:end`;this.recordMetric("mark",s,{id:t,name:s,startTime:n+a}),this.recordMetric("measure",r,{id:t,name:r,startTime:n,duration:a})}))}sendAsyncNotification(e,t){const r=ve([{target:this,events:t}],[{target:this,events:["error"]}]);return this.sendNotification(e.name,e.body,e.type),r}invalidArgException(e,...t){const r=null==t?void 0:t.map((e=>void 0===e?"undefined":e)),i=(null==r?void 0:r.toString())||null,n=`${e}; ${ue.messages.API_INVALID_ARG}; supplied arg(s): ${i}`;return this.log(n),new kr(n)}seekInternal(e){if(this.seekTime=e,this.seekPending)return this.seekPending.then((()=>this.seekTime===e?this.seekInternal(this.seekTime):void 0));const t={name:"seek",body:{value:e},type:"external"};return this.seekPending=this.sendAsyncNotification(t,["seekcomplete"]),this.seekPending.then((()=>{e===this.seekTime&&(this.seekTime=NaN),this.seekPending=null})).catch((t=>{throw this.seekPending=null,new se("9999",(null==t?void 0:t.message)||`An error occurred on seek to ${e}`,t||null,!1,"API")})).then((()=>{this.seekPending=null}))}};T([ci()],pn.prototype,"hasListenerFor",1),T([ci()],pn.prototype,"on",1),T([ci()],pn.prototype,"once",1),T([ci()],pn.prototype,"off",1),T([ui()],pn.prototype,"isReady",1),T([ui()],pn.prototype,"id",1),T([ui()],pn.prototype,"dimensions",1),T([ui()],pn.prototype,"video",1),T([ui()],pn.prototype,"isAutoplay",1),T([ui()],pn.prototype,"isFullscreen",1),T([ui()],pn.prototype,"isAd",1),T([ui()],pn.prototype,"muted",1),T([ui()],pn.prototype,"volume",1),T([ui()],pn.prototype,"language",1),T([ui()],pn.prototype,"contentTime",1),T([ui()],pn.prototype,"sessionTime",1),T([ui()],pn.prototype,"contentDuration",1),T([ui()],pn.prototype,"streamTime",1),T([ui()],pn.prototype,"streamDuration",1),T([ui()],pn.prototype,"playbackState",1),T([ui()],pn.prototype,"autoQualitySwitching",1),T([ui()],pn.prototype,"quality",1),T([ui()],pn.prototype,"qualities",1),T([ui()],pn.prototype,"qualityInfo",1),T([ui()],pn.prototype,"bitrate",1),T([ui()],pn.prototype,"qualityCategory",1),T([ui()],pn.prototype,"minBitrate",1),T([ui()],pn.prototype,"maxBitrate",1),T([ui()],pn.prototype,"audioTracks",1),T([ui()],pn.prototype,"audioTrackInfo",1),T([ui()],pn.prototype,"audioTrack",1),T([ci()],pn.prototype,"attachResource",1),T([ui()],pn.prototype,"resource",1),T([ui()],pn.prototype,"textTrackEnabled",1),T([ui()],pn.prototype,"textTrack",1),T([ui()],pn.prototype,"textTracks",1),T([ui()],pn.prototype,"textTrackInfo",1),T([ui()],pn.prototype,"streamType",1),T([ui()],pn.prototype,"isPlayingLive",1),T([ui()],pn.prototype,"liveStreamUtcStart",1),T([ui()],pn.prototype,"liveStreamUtcTime",1),T([ui()],pn.prototype,"liveStreamUtcDuration",1),T([ui()],pn.prototype,"isSuspended",1),T([ui()],pn.prototype,"fullscreenElement",1),T([ui()],pn.prototype,"pausable",1),T([ci()],pn.prototype,"enterFullscreen",1),T([ci()],pn.prototype,"exitFullscreen",1),T([ci()],pn.prototype,"play",1),T([ci()],pn.prototype,"pause",1),T([ci()],pn.prototype,"togglePlayPause",1),T([ci()],pn.prototype,"seek",1),T([ci()],pn.prototype,"jump",1),T([ci()],pn.prototype,"getAdBreakTimes",1),T([ci()],pn.prototype,"grabFrame",1),T([ci()],pn.prototype,"getThumbnail",1),T([ci()],pn.prototype,"getContainerRect",1),T([ci()],pn.prototype,"registerPlugins",1),T([ci()],pn.prototype,"removePlugin",1),T([ci()],pn.prototype,"registerAdapter",1),T([ci()],pn.prototype,"retrieveAdapter",1),T([ci()],pn.prototype,"removeAdapter",1),T([ci()],pn.prototype,"registerHook",1),T([ci()],pn.prototype,"removeHook",1),T([ci()],pn.prototype,"getPlugin",1),T([ci()],pn.prototype,"getAdapter",1),T([ci()],pn.prototype,"stop",1),T([ci()],pn.prototype,"goLive",1),T([ci()],pn.prototype,"skipAd",1),T([ci()],pn.prototype,"focus",1),T([ci()],pn.prototype,"blur",1),T([ci()],pn.prototype,"getKeyEventTarget",1),T([ci()],pn.prototype,"disableKeyCommands",1),T([ci()],pn.prototype,"getConfigAsJson",1),T([ci()],pn.prototype,"suspendPlayback",1),T([ci()],pn.prototype,"resumePlayback",1),T([ci()],pn.prototype,"recordMetric",1),T([ci()],pn.prototype,"offsetTimedText",1),T([ci()],pn.prototype,"primeVideoElement",1),T([ci()],pn.prototype,"selectAudioLanguage",1),T([ci()],pn.prototype,"selectTextLanguage",1),T([ci()],pn.prototype,"selectLocalizationLanguage",1);var mn,gn=!1,An=null,yn=new le({createplayer:{multiple:!0},removeplayer:{multiple:!0},event:{multiple:!0},adbreak:{multiple:!1},ad:{multiple:!1},attachresource:{multiple:!0},request:{multiple:!0},response:{multiple:!0}}),fn={},vn={},Tn={};var En=y(A({},ce),{registerHook:function(e,t){yn.registerHook(e,t)},removeHook:function(e,t){yn.removeHook(e,t)},createVideoPlayer:function(e){const t=performance.now(),r=new class{constructor(e={}){this.plugins=[],this.autoplay="none",this.networkErrorRecovery={},this.networkTimeout=at.TIMEOUT,this.id=V(),this.performanceMode="auto",this.renderTextTrackNatively=!0,this.useNativeFullscreen=!0,this.playsInline=!1,this.useNativeControls=!1,this.overrides={},this.enableOm=!1,this.enableMoat=!1,this.keyboardScope="player",this.logLevel="off",this.language=navigator.language,this.localization={},this.idleDelay=3e3;const t=e,{container:r}=t,i=((e,t)=>{var r={};for(var i in e)p.call(e,i)&&t.indexOf(i)<0&&(r[i]=e[i]);if(null!=e&&u)for(var i of u(e))t.indexOf(i)<0&&m.call(e,i)&&(r[i]=e[i]);return r})(t,["container"]);if(!(Fe.isWebMaf||null!=r&&(r.constructor===HTMLDivElement||"object"==typeof r&&"function"==typeof r.getBoundingClientRect||"string"==typeof r&&null!=document.querySelector(r))))throw new Error("Invalid player configuration: Missing presentation container.");Ie(this,i),this.container=r,null!=this.audioLanguage||(this.audioLanguage=this.language),null!=this.textLanguage||(this.textLanguage=this.language),null!=this.localizationLanguage||(this.localizationLanguage=this.language),null!=this.reuseVideoElement||(this.reuseVideoElement=Fe.isIos)}}(e),{id:i}=r,n=new J({logLevel:r.logLevel,id:i});return vn[i]=function(e){if(mn)return mn;!function(){if(gn)return;gn=!0;const e={"Array.from":()=>Array.from,"Array.prototype.find":()=>Array.prototype.find,"Array.prototype.findIndex":()=>Array.prototype.findIndex,"Array.prototype.includes":()=>Array.prototype.includes,"Object.assign":()=>Object.assign,Promise:()=>"undefined"!=typeof Promise,"String.prototype.includes":()=>String.prototype.includes,"String.prototype.repeat":()=>String.prototype.repeat};Object.keys(e).forEach((t=>{let r=!1;try{r=!!e[t]()}catch(e){r=!1}finally{r||J.warn(`Polyfill warning: ${t} is not defined`)}}))}();const t=ri.getInstance(),r=e.overrides,i=!1!==(null==r?void 0:r.deferAutoplayDetection);return mn=Promise.all([!i&&t.detectCapabilities(null==r?void 0:r.blankVideoUrl)]).then((()=>{An={AutoplayCapabilities:t}}))}(r).then((()=>E(this,null,(function*(){try{const e=yield yn.applyHook("createplayer",r),i=new pn({globalServices:An,playerOptions:e,hookManager:yn,logger:n});return n.time("player-creation",t),i.initialize().then((e=>({api:e,player:i})))}catch(e){throw e.key&&(e.message=`A player with id "${e.key}" a already exists`),e}})))).then((({api:e,player:t})=>(fn[i]=t,delete vn[i],n.timeEnd("player-creation"),e)))},retrieveVideoPlayer:function(e){const t=fn[e];if(t)return Promise.resolve(t);const r=Tn[e];if(r)return r.then((()=>null));return vn[e]||Promise.resolve(null)},removeVideoPlayer:function(e){return Tn[e]||Promise.resolve().then((()=>vn[e]?vn[e]:null)).then((()=>{const t=fn[e];return t?(delete fn[e],Tn[e]=t.destroy().then((()=>{delete Tn[e],J.log(`[Avia] Player with id "${e}" removed.`)}))):Promise.resolve()}))},createResourceConfig:function(e){return new ii(e)},getSystemInfo:function(){return A({},Fe)},getAutoplayCapabilities:function(e){return ri.getInstance().detectCapabilities(e)}});Fe.appNamespace=En},79742:(e,t)=>{"use strict";t.byteLength=function(e){var t=l(e),r=t[0],i=t[1];return 3*(r+i)/4-i},t.toByteArray=function(e){var t,r,a=l(e),s=a[0],o=a[1],d=new n(function(e,t,r){return 3*(t+r)/4-r}(0,s,o)),c=0,u=o>0?s-4:s;for(r=0;r<u;r+=4)t=i[e.charCodeAt(r)]<<18|i[e.charCodeAt(r+1)]<<12|i[e.charCodeAt(r+2)]<<6|i[e.charCodeAt(r+3)],d[c++]=t>>16&255,d[c++]=t>>8&255,d[c++]=255&t;return 2===o&&(t=i[e.charCodeAt(r)]<<2|i[e.charCodeAt(r+1)]>>4,d[c++]=255&t),1===o&&(t=i[e.charCodeAt(r)]<<10|i[e.charCodeAt(r+1)]<<4|i[e.charCodeAt(r+2)]>>2,d[c++]=t>>8&255,d[c++]=255&t),d},t.fromByteArray=function(e){for(var t,i=e.length,n=i%3,a=[],s=16383,o=0,l=i-n;o<l;o+=s)a.push(d(e,o,o+s>l?l:o+s));return 1===n?(t=e[i-1],a.push(r[t>>2]+r[t<<4&63]+"==")):2===n&&(t=(e[i-2]<<8)+e[i-1],a.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"=")),a.join("")};for(var r=[],i=[],n="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,o=a.length;s<o;++s)r[s]=a[s],i[a.charCodeAt(s)]=s;function l(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function d(e,t,i){for(var n,a,s=[],o=t;o<i;o+=3)n=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]),s.push(r[(a=n)>>18&63]+r[a>>12&63]+r[a>>6&63]+r[63&a]);return s.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},68962:(e,t,r)=>{"use strict";r.d(t,{g0:()=>M}),Promise.resolve(!1),Promise.resolve(!0);var i=Promise.resolve();function n(e,t){return e||(e=0),new Promise((function(r){return setTimeout((function(){return r(t)}),e)}))}function a(){return Math.random().toString(36).substring(2)}var s=0,o=0;function l(){var e=(new Date).getTime();return e===s?1e3*e+ ++o:(s=e,o=0,1e3*e)}var d="[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0);const c={create:function(e){var t={messagesCallback:null,bc:new BroadcastChannel(e),subFns:[]};return t.bc.onmessage=function(e){t.messagesCallback&&t.messagesCallback(e.data)},t},close:function(e){e.bc.close(),e.subFns=[]},onMessage:function(e,t){e.messagesCallback=t},postMessage:function(e,t){try{return e.bc.postMessage(t,!1),i}catch(e){return Promise.reject(e)}},canBeUsed:function(){if(d&&"undefined"==typeof window)return!1;if("function"==typeof BroadcastChannel){if(BroadcastChannel._pubkey)throw new Error("BroadcastChannel: Do not overwrite window.BroadcastChannel with this module, this is not a polyfill");return!0}return!1},type:"native",averageResponseTime:function(){return 150},microSeconds:l};var u=r(2151);function h(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=JSON.parse(JSON.stringify(e));return void 0===t.webWorkerSupport&&(t.webWorkerSupport=!0),t.idb||(t.idb={}),t.idb.ttl||(t.idb.ttl=45e3),t.idb.fallbackInterval||(t.idb.fallbackInterval=150),e.idb&&"function"==typeof e.idb.onclose&&(t.idb.onclose=e.idb.onclose),t.localstorage||(t.localstorage={}),t.localstorage.removeTimeout||(t.localstorage.removeTimeout=6e4),e.methods&&(t.methods=e.methods),t.node||(t.node={}),t.node.ttl||(t.node.ttl=12e4),t.node.maxParallelWrites||(t.node.maxParallelWrites=2048),void 0===t.node.useFastPath&&(t.node.useFastPath=!0),t}var p="messages";function m(){if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof window){if(void 0!==window.mozIndexedDB)return window.mozIndexedDB;if(void 0!==window.webkitIndexedDB)return window.webkitIndexedDB;if(void 0!==window.msIndexedDB)return window.msIndexedDB}return!1}function g(e){e.closed||A(e).then((function(){return n(e.options.idb.fallbackInterval)})).then((function(){return g(e)}))}function A(e){return e.closed?i:e.messagesCallback?(t=e.db,r=e.lastCursorId,n=t.transaction(p).objectStore(p),a=[],new Promise((function(e){(function(){try{var e=IDBKeyRange.bound(r+1,1/0);return n.openCursor(e)}catch(e){return n.openCursor()}}()).onsuccess=function(t){var i=t.target.result;i?i.value.id<r+1?i.continue(r+1):(a.push(i.value),i.continue()):e(a)}}))).then((function(t){return t.filter((function(e){return!!e})).map((function(t){return t.id>e.lastCursorId&&(e.lastCursorId=t.id),t})).filter((function(t){return function(e,t){return!(e.uuid===t.uuid||t.eMIs.has(e.id)||e.data.time<t.messagesCallbackTime)}(t,e)})).sort((function(e,t){return e.time-t.time})).forEach((function(t){e.messagesCallback&&(e.eMIs.add(t.id),e.messagesCallback(t.data))})),i})):i;var t,r,n,a}const y={create:function(e,t){return t=h(t),function(e){var t="pubkey.broadcast-channel-0-"+e,r=m().open(t,1);return r.onupgradeneeded=function(e){e.target.result.createObjectStore(p,{keyPath:"id",autoIncrement:!0})},new Promise((function(e,t){r.onerror=function(e){return t(e)},r.onsuccess=function(){e(r.result)}}))}(e).then((function(r){var n={closed:!1,lastCursorId:0,channelName:e,options:t,uuid:a(),eMIs:new u.i(2*t.idb.ttl),writeBlockPromise:i,messagesCallback:null,readQueuePromises:[],db:r};return r.onclose=function(){n.closed=!0,t.idb.onclose&&t.idb.onclose()},g(n),n}))},close:function(e){e.closed=!0,e.db.close()},onMessage:function(e,t,r){e.messagesCallbackTime=r,e.messagesCallback=t,A(e)},postMessage:function(e,t){return e.writeBlockPromise=e.writeBlockPromise.then((function(){return function(e,t,r){var i={uuid:t,time:(new Date).getTime(),data:r},n=e.transaction([p],"readwrite");return new Promise((function(e,t){n.oncomplete=function(){return e()},n.onerror=function(e){return t(e)},n.objectStore(p).add(i)}))}(e.db,e.uuid,t)})).then((function(){var t,r;0===(0,10,Math.floor(11*Math.random()+0))&&(t=e.db,r=e.options.idb.ttl,function(e,t){var r=(new Date).getTime()-t,i=e.transaction(p).objectStore(p),n=[];return new Promise((function(e){i.openCursor().onsuccess=function(t){var i=t.target.result;if(i){var a=i.value;if(!(a.time<r))return void e(n);n.push(a),i.continue()}else e(n)}}))}(t,r).then((function(e){return Promise.all(e.map((function(e){return function(e,t){var r=e.transaction([p],"readwrite").objectStore(p).delete(t);return new Promise((function(e){r.onsuccess=function(){return e()}}))}(t,e.id)})))})))})),e.writeBlockPromise},canBeUsed:function(){return!d&&!!m()},type:"idb",averageResponseTime:function(e){return 2*e.idb.fallbackInterval},microSeconds:l};function f(){var e;if("undefined"==typeof window)return null;try{e=window.localStorage,e=window["ie8-eventlistener/storage"]||window.localStorage}catch(e){}return e}function v(e){return"pubkey.broadcastChannel-"+e}function T(){if(d)return!1;var e=f();if(!e)return!1;try{var t="__broadcastchannel_check";e.setItem(t,"works"),e.removeItem(t)}catch(e){return!1}return!0}const E={create:function(e,t){if(t=h(t),!T())throw new Error("BroadcastChannel: localstorage cannot be used");var r=a(),i=new u.i(t.localstorage.removeTimeout),n={channelName:e,uuid:r,eMIs:i};return n.listener=function(e,t){var a=v(e),s=function(e){var t;e.key===a&&(t=JSON.parse(e.newValue),n.messagesCallback&&t.uuid!==r&&t.token&&!i.has(t.token)&&(t.data.time&&t.data.time<n.messagesCallbackTime||(i.add(t.token),n.messagesCallback(t.data))))};return window.addEventListener("storage",s),s}(e),n},close:function(e){var t;t=e.listener,window.removeEventListener("storage",t)},onMessage:function(e,t,r){e.messagesCallbackTime=r,e.messagesCallback=t},postMessage:function(e,t){return new Promise((function(r){n().then((function(){var i=v(e.channelName),n={token:a(),time:(new Date).getTime(),data:t,uuid:e.uuid},s=JSON.stringify(n);f().setItem(i,s);var o=document.createEvent("Event");o.initEvent("storage",!0,!0),o.key=i,o.newValue=s,window.dispatchEvent(o),r()}))}))},canBeUsed:T,type:"localstorage",averageResponseTime:function(){var e=navigator.userAgent.toLowerCase();return e.includes("safari")&&!e.includes("chrome")?240:120},microSeconds:l};var b=l,k=new Set;const S={create:function(e){var t={name:e,messagesCallback:null};return k.add(t),t},close:function(e){k.delete(e)},onMessage:function(e,t){e.messagesCallback=t},postMessage:function(e,t){return new Promise((function(r){return setTimeout((function(){Array.from(k).filter((function(t){return t.name===e.name})).filter((function(t){return t!==e})).filter((function(e){return!!e.messagesCallback})).forEach((function(e){return e.messagesCallback(t)})),r()}),5)}))},canBeUsed:function(){return!0},type:"simulate",averageResponseTime:function(){return 5},microSeconds:b};var P=[c,y,E],C=new Set,x=0,M=function(e,t){var r,i,n;this.id=x++,C.add(this),this.name=e,this.options=h(t),this.method=function(e){var t=[].concat(e.methods,P).filter(Boolean);if(e.type){if("simulate"===e.type)return S;var r=t.find((function(t){return t.type===e.type}));if(r)return r;throw new Error("method-type "+e.type+" not found")}e.webWorkerSupport||d||(t=t.filter((function(e){return"idb"!==e.type})));var i=t.find((function(e){return e.canBeUsed()}));if(i)return i;throw new Error("No useable method found in "+JSON.stringify(P.map((function(e){return e.type}))))}(this.options),this._iL=!1,this._onML=null,this._addEL={message:[],internal:[]},this._uMP=new Set,this._befC=[],this._prepP=null,(n=i=(r=this).method.create(r.name,r.options))&&"function"==typeof n.then?(r._prepP=i,i.then((function(e){r._state=e}))):r._state=i};function w(e,t,r){var n={time:e.method.microSeconds(),type:t,data:r};return(e._prepP?e._prepP:i).then((function(){var t=e.method.postMessage(e._state,n);return e._uMP.add(t),t.catch().then((function(){return e._uMP.delete(t)})),t}))}function R(e){return e._addEL.message.length>0||e._addEL.internal.length>0}function I(e,t,r){e._addEL[t].push(r),function(e){if(!e._iL&&R(e)){var t=function(t){e._addEL[t.type].forEach((function(e){var r=e.time-1e5;t.time>=r&&e.fn(t.data)}))},r=e.method.microSeconds();e._prepP?e._prepP.then((function(){e._iL=!0,e.method.onMessage(e._state,t,r)})):(e._iL=!0,e.method.onMessage(e._state,t,r))}}(e)}function N(e,t,r){e._addEL[t]=e._addEL[t].filter((function(e){return e!==r})),function(e){if(e._iL&&!R(e)){e._iL=!1;var t=e.method.microSeconds();e.method.onMessage(e._state,null,t)}}(e)}M._pubkey=!0,M.prototype={postMessage:function(e){if(this.closed)throw new Error("BroadcastChannel.postMessage(): Cannot post message after channel has closed");return w(this,"message",e)},postInternal:function(e){return w(this,"internal",e)},set onmessage(e){var t={time:this.method.microSeconds(),fn:e};N(this,"message",this._onML),e&&"function"==typeof e?(this._onML=t,I(this,"message",t)):this._onML=null},addEventListener:function(e,t){I(this,e,{time:this.method.microSeconds(),fn:t})},removeEventListener:function(e,t){N(this,e,this._addEL[e].find((function(e){return e.fn===t})))},close:function(){var e=this;if(!this.closed){C.delete(this),this.closed=!0;var t=this._prepP?this._prepP:i;return this._onML=null,this._addEL.message=[],t.then((function(){return Promise.all(Array.from(e._uMP))})).then((function(){return Promise.all(e._befC.map((function(e){return e()})))})).then((function(){return e.method.close(e._state)}))}},get type(){return this.method.type},get isClosed(){return this.closed}}},48764:(e,t,r)=>{"use strict";var i=r(79742),n=r(80645),a="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.lW=l,t.h2=50;var s=2147483647;function o(e){if(e>s)throw new RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return Object.setPrototypeOf(t,l.prototype),t}function l(e,t,r){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return u(e)}return d(e,t,r)}function d(e,t,r){if("string"==typeof e)return function(e,t){if("string"==typeof t&&""!==t||(t="utf8"),!l.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var r=0|g(e,t),i=o(r),n=i.write(e,t);return n!==r&&(i=i.slice(0,n)),i}(e,t);if(ArrayBuffer.isView(e))return function(e){if(H(e,Uint8Array)){var t=new Uint8Array(e);return p(t.buffer,t.byteOffset,t.byteLength)}return h(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(H(e,ArrayBuffer)||e&&H(e.buffer,ArrayBuffer))return p(e,t,r);if("undefined"!=typeof SharedArrayBuffer&&(H(e,SharedArrayBuffer)||e&&H(e.buffer,SharedArrayBuffer)))return p(e,t,r);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var i=e.valueOf&&e.valueOf();if(null!=i&&i!==e)return l.from(i,t,r);var n=function(e){if(l.isBuffer(e)){var t=0|m(e.length),r=o(t);return 0===r.length||e.copy(r,0,0,t),r}return void 0!==e.length?"number"!=typeof e.length||K(e.length)?o(0):h(e):"Buffer"===e.type&&Array.isArray(e.data)?h(e.data):void 0}(e);if(n)return n;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return l.from(e[Symbol.toPrimitive]("string"),t,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function c(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function u(e){return c(e),o(e<0?0:0|m(e))}function h(e){for(var t=e.length<0?0:0|m(e.length),r=o(t),i=0;i<t;i+=1)r[i]=255&e[i];return r}function p(e,t,r){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw new RangeError('"length" is outside of buffer bounds');var i;return i=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),Object.setPrototypeOf(i,l.prototype),i}function m(e){if(e>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return 0|e}function g(e,t){if(l.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||H(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var r=e.length,i=arguments.length>2&&!0===arguments[2];if(!i&&0===r)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return U(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return B(e).length;default:if(n)return i?-1:U(e).length;t=(""+t).toLowerCase(),n=!0}}function A(e,t,r){var i=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return R(this,t,r);case"utf8":case"utf-8":return C(this,t,r);case"ascii":return M(this,t,r);case"latin1":case"binary":return w(this,t,r);case"base64":return P(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,t,r);default:if(i)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0}}function y(e,t,r){var i=e[t];e[t]=e[r],e[r]=i}function f(e,t,r,i,n){if(0===e.length)return-1;if("string"==typeof r?(i=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),K(r=+r)&&(r=n?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(n)return-1;r=e.length-1}else if(r<0){if(!n)return-1;r=0}if("string"==typeof t&&(t=l.from(t,i)),l.isBuffer(t))return 0===t.length?-1:v(e,t,r,i,n);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?n?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):v(e,[t],r,i,n);throw new TypeError("val must be string, number or Buffer")}function v(e,t,r,i,n){var a,s=1,o=e.length,l=t.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(e.length<2||t.length<2)return-1;s=2,o/=2,l/=2,r/=2}function d(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}if(n){var c=-1;for(a=r;a<o;a++)if(d(e,a)===d(t,-1===c?0:a-c)){if(-1===c&&(c=a),a-c+1===l)return c*s}else-1!==c&&(a-=a-c),c=-1}else for(r+l>o&&(r=o-l),a=r;a>=0;a--){for(var u=!0,h=0;h<l;h++)if(d(e,a+h)!==d(t,h)){u=!1;break}if(u)return a}return-1}function T(e,t,r,i){r=Number(r)||0;var n=e.length-r;i?(i=Number(i))>n&&(i=n):i=n;var a=t.length;i>a/2&&(i=a/2);for(var s=0;s<i;++s){var o=parseInt(t.substr(2*s,2),16);if(K(o))return s;e[r+s]=o}return s}function E(e,t,r,i){return F(U(t,e.length-r),e,r,i)}function b(e,t,r,i){return F(function(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(t),e,r,i)}function k(e,t,r,i){return F(B(t),e,r,i)}function S(e,t,r,i){return F(function(e,t){for(var r,i,n,a=[],s=0;s<e.length&&!((t-=2)<0);++s)i=(r=e.charCodeAt(s))>>8,n=r%256,a.push(n),a.push(i);return a}(t,e.length-r),e,r,i)}function P(e,t,r){return 0===t&&r===e.length?i.fromByteArray(e):i.fromByteArray(e.slice(t,r))}function C(e,t,r){r=Math.min(e.length,r);for(var i=[],n=t;n<r;){var a,s,o,l,d=e[n],c=null,u=d>239?4:d>223?3:d>191?2:1;if(n+u<=r)switch(u){case 1:d<128&&(c=d);break;case 2:128==(192&(a=e[n+1]))&&(l=(31&d)<<6|63&a)>127&&(c=l);break;case 3:a=e[n+1],s=e[n+2],128==(192&a)&&128==(192&s)&&(l=(15&d)<<12|(63&a)<<6|63&s)>2047&&(l<55296||l>57343)&&(c=l);break;case 4:a=e[n+1],s=e[n+2],o=e[n+3],128==(192&a)&&128==(192&s)&&128==(192&o)&&(l=(15&d)<<18|(63&a)<<12|(63&s)<<6|63&o)>65535&&l<1114112&&(c=l)}null===c?(c=65533,u=1):c>65535&&(c-=65536,i.push(c>>>10&1023|55296),c=56320|1023&c),i.push(c),n+=u}return function(e){var t=e.length;if(t<=x)return String.fromCharCode.apply(String,e);for(var r="",i=0;i<t;)r+=String.fromCharCode.apply(String,e.slice(i,i+=x));return r}(i)}l.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),l.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.buffer}}),Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.byteOffset}}),l.poolSize=8192,l.from=function(e,t,r){return d(e,t,r)},Object.setPrototypeOf(l.prototype,Uint8Array.prototype),Object.setPrototypeOf(l,Uint8Array),l.alloc=function(e,t,r){return function(e,t,r){return c(e),e<=0?o(e):void 0!==t?"string"==typeof r?o(e).fill(t,r):o(e).fill(t):o(e)}(e,t,r)},l.allocUnsafe=function(e){return u(e)},l.allocUnsafeSlow=function(e){return u(e)},l.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==l.prototype},l.compare=function(e,t){if(H(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),H(t,Uint8Array)&&(t=l.from(t,t.offset,t.byteLength)),!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var r=e.length,i=t.length,n=0,a=Math.min(r,i);n<a;++n)if(e[n]!==t[n]){r=e[n],i=t[n];break}return r<i?-1:i<r?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var i=l.allocUnsafe(t),n=0;for(r=0;r<e.length;++r){var a=e[r];if(H(a,Uint8Array))n+a.length>i.length?l.from(a).copy(i,n):Uint8Array.prototype.set.call(i,a,n);else{if(!l.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(i,n)}n+=a.length}return i},l.byteLength=g,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)y(this,t,t+1);return this},l.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this},l.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this},l.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?C(this,0,e):A.apply(this,arguments)},l.prototype.toLocaleString=l.prototype.toString,l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){var e="",r=t.h2;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},a&&(l.prototype[a]=l.prototype.inspect),l.prototype.compare=function(e,t,r,i,n){if(H(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),!l.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===i&&(i=0),void 0===n&&(n=this.length),t<0||r>e.length||i<0||n>this.length)throw new RangeError("out of range index");if(i>=n&&t>=r)return 0;if(i>=n)return-1;if(t>=r)return 1;if(this===e)return 0;for(var a=(n>>>=0)-(i>>>=0),s=(r>>>=0)-(t>>>=0),o=Math.min(a,s),d=this.slice(i,n),c=e.slice(t,r),u=0;u<o;++u)if(d[u]!==c[u]){a=d[u],s=c[u];break}return a<s?-1:s<a?1:0},l.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},l.prototype.indexOf=function(e,t,r){return f(this,e,t,r,!0)},l.prototype.lastIndexOf=function(e,t,r){return f(this,e,t,r,!1)},l.prototype.write=function(e,t,r,i){if(void 0===t)i="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)i=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(r)?(r>>>=0,void 0===i&&(i="utf8")):(i=r,r=void 0)}var n=this.length-t;if((void 0===r||r>n)&&(r=n),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var a=!1;;)switch(i){case"hex":return T(this,e,t,r);case"utf8":case"utf-8":return E(this,e,t,r);case"ascii":case"latin1":case"binary":return b(this,e,t,r);case"base64":return k(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,e,t,r);default:if(a)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),a=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var x=4096;function M(e,t,r){var i="";r=Math.min(e.length,r);for(var n=t;n<r;++n)i+=String.fromCharCode(127&e[n]);return i}function w(e,t,r){var i="";r=Math.min(e.length,r);for(var n=t;n<r;++n)i+=String.fromCharCode(e[n]);return i}function R(e,t,r){var i=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>i)&&(r=i);for(var n="",a=t;a<r;++a)n+=q[e[a]];return n}function I(e,t,r){for(var i=e.slice(t,r),n="",a=0;a<i.length-1;a+=2)n+=String.fromCharCode(i[a]+256*i[a+1]);return n}function N(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function L(e,t,r,i,n,a){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>n||t<a)throw new RangeError('"value" argument is out of bounds');if(r+i>e.length)throw new RangeError("Index out of range")}function _(e,t,r,i,n,a){if(r+i>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function O(e,t,r,i,a){return t=+t,r>>>=0,a||_(e,0,r,4),n.write(e,t,r,i,23,4),r+4}function D(e,t,r,i,a){return t=+t,r>>>=0,a||_(e,0,r,8),n.write(e,t,r,i,52,8),r+8}l.prototype.slice=function(e,t){var r=this.length;(e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);var i=this.subarray(e,t);return Object.setPrototypeOf(i,l.prototype),i},l.prototype.readUintLE=l.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||N(e,t,this.length);for(var i=this[e],n=1,a=0;++a<t&&(n*=256);)i+=this[e+a]*n;return i},l.prototype.readUintBE=l.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||N(e,t,this.length);for(var i=this[e+--t],n=1;t>0&&(n*=256);)i+=this[e+--t]*n;return i},l.prototype.readUint8=l.prototype.readUInt8=function(e,t){return e>>>=0,t||N(e,1,this.length),this[e]},l.prototype.readUint16LE=l.prototype.readUInt16LE=function(e,t){return e>>>=0,t||N(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUint16BE=l.prototype.readUInt16BE=function(e,t){return e>>>=0,t||N(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUint32LE=l.prototype.readUInt32LE=function(e,t){return e>>>=0,t||N(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUint32BE=l.prototype.readUInt32BE=function(e,t){return e>>>=0,t||N(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||N(e,t,this.length);for(var i=this[e],n=1,a=0;++a<t&&(n*=256);)i+=this[e+a]*n;return i>=(n*=128)&&(i-=Math.pow(2,8*t)),i},l.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||N(e,t,this.length);for(var i=t,n=1,a=this[e+--i];i>0&&(n*=256);)a+=this[e+--i]*n;return a>=(n*=128)&&(a-=Math.pow(2,8*t)),a},l.prototype.readInt8=function(e,t){return e>>>=0,t||N(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){e>>>=0,t||N(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},l.prototype.readInt16BE=function(e,t){e>>>=0,t||N(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},l.prototype.readInt32LE=function(e,t){return e>>>=0,t||N(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return e>>>=0,t||N(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readFloatLE=function(e,t){return e>>>=0,t||N(e,4,this.length),n.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return e>>>=0,t||N(e,4,this.length),n.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return e>>>=0,t||N(e,8,this.length),n.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return e>>>=0,t||N(e,8,this.length),n.read(this,e,!1,52,8)},l.prototype.writeUintLE=l.prototype.writeUIntLE=function(e,t,r,i){e=+e,t>>>=0,r>>>=0,i||L(this,e,t,r,Math.pow(2,8*r)-1,0);var n=1,a=0;for(this[t]=255&e;++a<r&&(n*=256);)this[t+a]=e/n&255;return t+r},l.prototype.writeUintBE=l.prototype.writeUIntBE=function(e,t,r,i){e=+e,t>>>=0,r>>>=0,i||L(this,e,t,r,Math.pow(2,8*r)-1,0);var n=r-1,a=1;for(this[t+n]=255&e;--n>=0&&(a*=256);)this[t+n]=e/a&255;return t+r},l.prototype.writeUint8=l.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||L(this,e,t,1,255,0),this[t]=255&e,t+1},l.prototype.writeUint16LE=l.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||L(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeUint16BE=l.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||L(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeUint32LE=l.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||L(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},l.prototype.writeUint32BE=l.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||L(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeIntLE=function(e,t,r,i){if(e=+e,t>>>=0,!i){var n=Math.pow(2,8*r-1);L(this,e,t,r,n-1,-n)}var a=0,s=1,o=0;for(this[t]=255&e;++a<r&&(s*=256);)e<0&&0===o&&0!==this[t+a-1]&&(o=1),this[t+a]=(e/s>>0)-o&255;return t+r},l.prototype.writeIntBE=function(e,t,r,i){if(e=+e,t>>>=0,!i){var n=Math.pow(2,8*r-1);L(this,e,t,r,n-1,-n)}var a=r-1,s=1,o=0;for(this[t+a]=255&e;--a>=0&&(s*=256);)e<0&&0===o&&0!==this[t+a+1]&&(o=1),this[t+a]=(e/s>>0)-o&255;return t+r},l.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||L(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||L(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||L(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||L(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},l.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||L(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeFloatLE=function(e,t,r){return O(this,e,t,!0,r)},l.prototype.writeFloatBE=function(e,t,r){return O(this,e,t,!1,r)},l.prototype.writeDoubleLE=function(e,t,r){return D(this,e,t,!0,r)},l.prototype.writeDoubleBE=function(e,t,r){return D(this,e,t,!1,r)},l.prototype.copy=function(e,t,r,i){if(!l.isBuffer(e))throw new TypeError("argument should be a Buffer");if(r||(r=0),i||0===i||(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<r&&(i=r),i===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-r&&(i=e.length-t+r);var n=i-r;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,i):Uint8Array.prototype.set.call(e,this.subarray(r,i),t),n},l.prototype.fill=function(e,t,r,i){if("string"==typeof e){if("string"==typeof t?(i=t,t=0,r=this.length):"string"==typeof r&&(i=r,r=this.length),void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!l.isEncoding(i))throw new TypeError("Unknown encoding: "+i);if(1===e.length){var n=e.charCodeAt(0);("utf8"===i&&n<128||"latin1"===i)&&(e=n)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var a;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(a=t;a<r;++a)this[a]=e;else{var s=l.isBuffer(e)?e:l.from(e,i),o=s.length;if(0===o)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(a=0;a<r-t;++a)this[a+t]=s[a%o]}return this};var V=/[^+/0-9A-Za-z-_]/g;function U(e,t){var r;t=t||1/0;for(var i=e.length,n=null,a=[],s=0;s<i;++s){if((r=e.charCodeAt(s))>55295&&r<57344){if(!n){if(r>56319){(t-=3)>-1&&a.push(239,191,189);continue}if(s+1===i){(t-=3)>-1&&a.push(239,191,189);continue}n=r;continue}if(r<56320){(t-=3)>-1&&a.push(239,191,189),n=r;continue}r=65536+(n-55296<<10|r-56320)}else n&&(t-=3)>-1&&a.push(239,191,189);if(n=null,r<128){if((t-=1)<0)break;a.push(r)}else if(r<2048){if((t-=2)<0)break;a.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;a.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;a.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return a}function B(e){return i.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(V,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function F(e,t,r,i){for(var n=0;n<i&&!(n+r>=t.length||n>=e.length);++n)t[n+r]=e[n];return n}function H(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function K(e){return e!=e}var q=function(){for(var e="0123456789abcdef",t=new Array(256),r=0;r<16;++r)for(var i=16*r,n=0;n<16;++n)t[i+n]=e[r]+e[n];return t}()},10150:(e,t,r)=>{"use strict";function i(e){return"object"==typeof e&&null!=e&&1===e.nodeType}function n(e,t){return(!t||"hidden"!==e)&&"visible"!==e&&"clip"!==e}function a(e,t){if(e.clientHeight<e.scrollHeight||e.clientWidth<e.scrollWidth){var r=getComputedStyle(e,null);return n(r.overflowY,t)||n(r.overflowX,t)||function(e){var t=function(e){if(!e.ownerDocument||!e.ownerDocument.defaultView)return null;try{return e.ownerDocument.defaultView.frameElement}catch(e){return null}}(e);return!!t&&(t.clientHeight<e.scrollHeight||t.clientWidth<e.scrollWidth)}(e)}return!1}function s(e,t,r,i,n,a,s,o){return a<e&&s>t||a>e&&s<t?0:a<=e&&o<=r||s>=t&&o>=r?a-e-i:s>t&&o<r||a<e&&o>r?s-t+n:0}function o(e,t){var r=window,n=t.scrollMode,o=t.block,l=t.inline,d=t.boundary,c=t.skipOverflowHiddenElements,u="function"==typeof d?d:function(e){return e!==d};if(!i(e))throw new TypeError("Invalid target");for(var h=document.scrollingElement||document.documentElement,p=[],m=e;i(m)&&u(m);){if((m=m.parentElement)===h){p.push(m);break}null!=m&&m===document.body&&a(m)&&!a(document.documentElement)||null!=m&&a(m,c)&&p.push(m)}for(var g=r.visualViewport?r.visualViewport.width:innerWidth,A=r.visualViewport?r.visualViewport.height:innerHeight,y=window.scrollX||pageXOffset,f=window.scrollY||pageYOffset,v=e.getBoundingClientRect(),T=v.height,E=v.width,b=v.top,k=v.right,S=v.bottom,P=v.left,C="start"===o||"nearest"===o?b:"end"===o?S:b+T/2,x="center"===l?P+E/2:"end"===l?k:P,M=[],w=0;w<p.length;w++){var R=p[w],I=R.getBoundingClientRect(),N=I.height,L=I.width,_=I.top,O=I.right,D=I.bottom,V=I.left;if("if-needed"===n&&b>=0&&P>=0&&S<=A&&k<=g&&b>=_&&S<=D&&P>=V&&k<=O)return M;var U=getComputedStyle(R),B=parseInt(U.borderLeftWidth,10),F=parseInt(U.borderTopWidth,10),H=parseInt(U.borderRightWidth,10),K=parseInt(U.borderBottomWidth,10),q=0,W=0,z="offsetWidth"in R?R.offsetWidth-R.clientWidth-B-H:0,G="offsetHeight"in R?R.offsetHeight-R.clientHeight-F-K:0;if(h===R)q="start"===o?C:"end"===o?C-A:"nearest"===o?s(f,f+A,A,F,K,f+C,f+C+T,T):C-A/2,W="start"===l?x:"center"===l?x-g/2:"end"===l?x-g:s(y,y+g,g,B,H,y+x,y+x+E,E),q=Math.max(0,q+f),W=Math.max(0,W+y);else{q="start"===o?C-_-F:"end"===o?C-D+K+G:"nearest"===o?s(_,D,N,F,K+G,C,C+T,T):C-(_+N/2)+G/2,W="start"===l?x-V-B:"center"===l?x-(V+L/2)+z/2:"end"===l?x-O+H+z:s(V,O,L,B,H+z,x,x+E,E);var j=R.scrollLeft,$=R.scrollTop;C+=$-(q=Math.max(0,Math.min($+q,R.scrollHeight-N+G))),x+=j-(W=Math.max(0,Math.min(j+W,R.scrollWidth-L+z)))}M.push({el:R,top:q,left:W})}return M}r.d(t,{Z:()=>o})}}]);